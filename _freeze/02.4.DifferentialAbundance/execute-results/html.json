{
  "hash": "a3fd62e09d81b4d1d180f43e71f4e222",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Differential Abundance\"\n---\n\n\n\n## Load libraries and data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ANCOMBC)\nlibrary(tidyverse)\nlibrary(DT)\noptions(DT.options = list(\n  initComplete = JS(\"function(settings, json) {\",\n                    \"$(this.api().table().header()).css({'background-color':\n  '#000', 'color': '#fff'});\",\"}\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#load data\nphyseq_qiime3 <- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rename mangrove system columna\ncolnames(sample_data(physeq_qiime3))[colnames(sample_data(physeq_qiime3)) == \"Mangrove system\"] <- \"Mangrove_system\"\n\n# Convert Mangrove_system to factor\nsample_data(physeq_qiime3)$Mangrove_system <- as.factor(sample_data(physeq_qiime3)$Mangrove_system)\n```\n:::\n\n\n\n## 01. Differential abundance ANCOMBC2\n\n### 01.1 Prepare data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# phyloseq to TreeSummarizedExperiment\ntse <- mia::convertFromPhyloseq(physeq_qiime3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#To manually change the reference level, not alphabetic order\ntse$Mangrove_system = factor(tse$Mangrove_system, levels = c(\"Fossil Lagoon\", \"San Pedro River\", \"Términos Lagoon\", \"Celestún Lagoon\"))\n\n\n#conver to factor using letter levels\ntse$Mangrove_system <- factor(recode\n                              (as.character(tse$Mangrove_system),\n                                    `Fossil Lagoon` = \"FL\",\n                                    `San Pedro River` = \"SPR\",\n                                    `Términos Lagoon` = \"TL\",\n                                    `Celestún Lagoon` = \"CL\",\n                                    .missing = \"unknown\"),\n                             levels = c(\"FL\", \"SPR\", \"TL\", \"CL\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# contrast matrix\ncontrast_matrices <- list(\n  matrix(c(1, -1, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, -1,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, -1, 0,\n           0, 1, 0,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE))\n\n# nodes\nnodes <- list(1, 1, 1, 1)\n```\n:::\n\n\n\n### 01.2 Run ANCOM-BC2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANCOMBC2\noutput <- ancombc2(\n  data = tse,\n  assay_name = \"counts\",\n  tax_level = \"Phylum\",\n  fix_formula = \"Mangrove_system\",\n  rand_formula = NULL,\n  p_adj_method = \"BH\",\n  pseudo_sens = TRUE,\n  prv_cut = 0.10,\n  lib_cut = 1000,\n  s0_perc = 0.05,\n  group = \"Mangrove_system\",\n  struc_zero = TRUE,\n  neg_lb = TRUE,\n  alpha = 0.05,\n  n_cl = 2,\n  verbose = TRUE,\n  global = TRUE,\n  pairwise = TRUE,\n  dunnet = TRUE,\n  trend = TRUE,\n  iter_control = list(tol = 1e-2, max_iter = 20, verbose = TRUE),\n  em_control = list(tol = 1e-5, max_iter = 100),\n  lme_control = lme4::lmerControl(),\n  mdfdr_control = list(fwer_ctrl_method = \"BH\", B = 100),\n  trend_control = list(\n    contrast = contrast_matrices,\n    node = nodes,\n    solver = \"ECOS\",\n    B = 100\n  )\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChecking the input data type ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe input data is of type: TreeSummarizedExperiment\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPASS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChecking the sample metadata ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe specified variables in the formula: Mangrove_system\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe available variables in the sample metadata: SampleID, BioSample, ID, SRA, SampleName, Collection_date, depth, site, elevation, Broad_scale_environmental_context, Local_scale_environmental_context, Environmental_medium, Latitude_and_Longitude, Geographic.Location, Study_zone, Ecological_type, Parametros, Temperatura, Salinidad, pH, Redox.mV, S.2, SO4, season, filter, Mangrove_system, Mangrove_type\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPASS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChecking other arguments ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe number of groups of interest is: 4\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe sample size per group is: FL = 4, SPR = 7, TL = 3, CL = 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Small sample size detected for the following group(s): \nFL, TL\nVariance estimation would be unstable when the sample size is < 5 per group\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPASS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nObtaining initial estimates ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 1, epsilon = 1.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 2, epsilon = 7.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 3, epsilon = 0.92\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 4, epsilon = 0.31\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 5, epsilon = 0.19\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 6, epsilon = 0.13\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 7, epsilon = 0.083\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 8, epsilon = 0.055\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 9, epsilon = 0.036\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 10, epsilon = 0.024\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 11, epsilon = 0.016\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 12, epsilon = 0.011\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nML iteration = 13, epsilon = 0.007\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nEstimating sample-specific biases ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nConducting sensitivity analysis for pseudo-count addition to 0s ...\nFor taxa that are significant but do not pass the sensitivity analysis,\nplease flag them and proceed with caution, as they are likely false positives.\nFor detailed instructions on performing sensitivity analysis,\nplease refer to the package vignette.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nANCOM-BC2 primary results ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nANCOM-BC2 global test ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nANCOM-BC2 multiple pairwise comparisons ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nANCOM-BC2 multiple pairwise comparisons against the reference group ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nANCOM-BC2 pattern analysis ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#See results\nres_pair_Mangrove_system <- output$res_pair\n\nhead(res_pair_Mangrove_system)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             taxon lfc_Mangrove_systemSPR lfc_Mangrove_systemTL\n1  Acidobacteriota               -0.26768                 -3.39\n2 Actinobacteriota               -0.23213                 -3.71\n3  Asgardarchaeota                0.26584                 -3.47\n4     Bacteroidota               -0.48731                 -4.52\n5    Calditrichota               -0.16945                 -2.37\n6 Campilobacterota                0.00556                 -2.60\n  lfc_Mangrove_systemCL lfc_Mangrove_systemTL_Mangrove_systemSPR\n1                -0.490                                    -3.13\n2                -0.626                                    -3.47\n3                -0.589                                    -3.74\n4                -0.942                                    -4.03\n5                -0.264                                    -2.20\n6                -1.794                                    -2.61\n  lfc_Mangrove_systemCL_Mangrove_systemSPR\n1                                  -0.2225\n2                                  -0.3937\n3                                  -0.8550\n4                                  -0.4543\n5                                  -0.0946\n6                                  -1.7995\n  lfc_Mangrove_systemCL_Mangrove_systemTL se_Mangrove_systemSPR\n1                                   2.904                 0.158\n2                                   3.080                 0.133\n3                                   2.882                 0.311\n4                                   3.580                 0.139\n5                                   2.110                 0.223\n6                                   0.806                 0.370\n  se_Mangrove_systemTL se_Mangrove_systemCL\n1                0.268                0.166\n2                0.898                0.195\n3                0.380                0.434\n4                0.921                0.209\n5                0.283                0.245\n6                0.449                0.469\n  se_Mangrove_systemTL_Mangrove_systemSPR\n1                                   0.292\n2                                   0.903\n3                                   0.298\n4                                   0.924\n5                                   0.295\n6                                   0.323\n  se_Mangrove_systemCL_Mangrove_systemSPR\n1                                   0.203\n2                                   0.217\n3                                   0.405\n4                                   0.220\n5                                   0.258\n6                                   0.431\n  se_Mangrove_systemCL_Mangrove_systemTL W_Mangrove_systemSPR\n1                                  0.297               -1.699\n2                                  0.914               -1.743\n3                                  0.435                0.856\n4                                  0.937               -3.500\n5                                  0.311               -0.759\n6                                  0.452                0.015\n  W_Mangrove_systemTL W_Mangrove_systemCL\n1              -12.68               -2.96\n2               -4.13               -3.20\n3               -9.13               -1.36\n4               -4.91               -4.50\n5               -8.39               -1.08\n6               -5.80               -3.82\n  W_Mangrove_systemTL_Mangrove_systemSPR W_Mangrove_systemCL_Mangrove_systemSPR\n1                                 -10.69                                 -1.094\n2                                  -3.85                                 -1.812\n3                                 -12.56                                 -2.112\n4                                  -4.37                                 -2.065\n5                                  -7.48                                 -0.366\n6                                  -8.07                                 -4.179\n  W_Mangrove_systemCL_Mangrove_systemTL p_Mangrove_systemSPR\n1                                  9.78              0.10412\n2                                  3.37              0.09592\n3                                  6.62              0.40222\n4                                  3.82              0.00213\n5                                  6.78              0.45646\n6                                  1.78              0.98818\n  p_Mangrove_systemTL p_Mangrove_systemCL\n1            2.61e-11            0.007550\n2            4.81e-04            0.004254\n3            1.42e-08            0.189976\n4            7.44e-05            0.000196\n5            3.81e-08            0.293187\n6            1.39e-05            0.001144\n  p_Mangrove_systemTL_Mangrove_systemSPR p_Mangrove_systemCL_Mangrove_systemSPR\n1                               5.93e-10                               0.286427\n2                               9.40e-04                               0.084249\n3                               6.07e-11                               0.047481\n4                               2.70e-04                               0.051516\n5                               2.37e-07                               0.717960\n6                               1.47e-07                               0.000509\n  p_Mangrove_systemCL_Mangrove_systemTL q_Mangrove_systemSPR\n1                              2.86e-09              0.13119\n2                              2.91e-03              0.10071\n3                              1.89e-06              0.42233\n4                              9.95e-04              0.00269\n5                              1.06e-06              0.57514\n6                              9.06e-02              1.00000\n  q_Mangrove_systemTL q_Mangrove_systemCL\n1            1.65e-10            0.011892\n2            2.96e-03            0.006700\n3            4.46e-08            0.239369\n4            4.69e-04            0.000567\n5            2.40e-07            0.461769\n6            4.37e-05            0.001801\n  q_Mangrove_systemTL_Mangrove_systemSPR q_Mangrove_systemCL_Mangrove_systemSPR\n1                               1.87e-09                                0.30075\n2                               2.96e-03                                0.10071\n3                               3.82e-10                                0.07478\n4                               5.67e-04                                0.05409\n5                               7.48e-07                                0.75386\n6                               9.26e-07                                0.00107\n  q_Mangrove_systemCL_Mangrove_systemTL diff_Mangrove_systemSPR\n1                              6.01e-09                   FALSE\n2                              6.11e-03                   FALSE\n3                              3.97e-06                   FALSE\n4                              1.57e-03                    TRUE\n5                              2.22e-06                   FALSE\n6                              1.14e-01                   FALSE\n  diff_Mangrove_systemTL diff_Mangrove_systemCL\n1                   TRUE                   TRUE\n2                   TRUE                   TRUE\n3                   TRUE                  FALSE\n4                   TRUE                   TRUE\n5                   TRUE                  FALSE\n6                   TRUE                   TRUE\n  diff_Mangrove_systemTL_Mangrove_systemSPR\n1                                      TRUE\n2                                      TRUE\n3                                      TRUE\n4                                      TRUE\n5                                      TRUE\n6                                      TRUE\n  diff_Mangrove_systemCL_Mangrove_systemSPR\n1                                     FALSE\n2                                     FALSE\n3                                     FALSE\n4                                     FALSE\n5                                     FALSE\n6                                      TRUE\n  diff_Mangrove_systemCL_Mangrove_systemTL passed_ss_Mangrove_systemSPR\n1                                     TRUE                         TRUE\n2                                     TRUE                         TRUE\n3                                     TRUE                         TRUE\n4                                     TRUE                        FALSE\n5                                     TRUE                         TRUE\n6                                    FALSE                         TRUE\n  passed_ss_Mangrove_systemTL passed_ss_Mangrove_systemCL\n1                        TRUE                        TRUE\n2                        TRUE                       FALSE\n3                        TRUE                        TRUE\n4                        TRUE                        TRUE\n5                        TRUE                        TRUE\n6                        TRUE                       FALSE\n  passed_ss_Mangrove_systemTL_Mangrove_systemSPR\n1                                           TRUE\n2                                           TRUE\n3                                           TRUE\n4                                           TRUE\n5                                           TRUE\n6                                           TRUE\n  passed_ss_Mangrove_systemCL_Mangrove_systemSPR\n1                                           TRUE\n2                                           TRUE\n3                                          FALSE\n4                                           TRUE\n5                                           TRUE\n6                                           TRUE\n  passed_ss_Mangrove_systemCL_Mangrove_systemTL\n1                                          TRUE\n2                                          TRUE\n3                                          TRUE\n4                                          TRUE\n5                                          TRUE\n6                                          TRUE\n```\n\n\n:::\n:::\n\n\n\n## 02. Get differential data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create dataframe df_fig_pair1 to log-fold change (LFC) values\ndf_fig_pair1_Mangrove_system <- res_pair_Mangrove_system %>%\n  dplyr::filter(`diff_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemTL` == 1 |\n                `diff_Mangrove_systemCL` == 1 |\n                `diff_Mangrove_systemTL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemTL` == 1) %>%\n  dplyr::mutate(lfc1 = ifelse(`diff_Mangrove_systemSPR` == 1, \n                      round(`lfc_Mangrove_systemSPR`, 2), NA),\n                lfc2 = ifelse(`diff_Mangrove_systemTL` == 1, \n                      round(`lfc_Mangrove_systemTL`, 2), NA),\n                lfc3 = ifelse(`diff_Mangrove_systemCL` == 1, \n                      round(`lfc_Mangrove_systemCL`, 2), NA),\n                lfc4 = ifelse(`diff_Mangrove_systemTL_Mangrove_systemSPR` == 1, \n                      round(`lfc_Mangrove_systemTL_Mangrove_systemSPR`, 2), NA),\n                lfc5 = ifelse(`diff_Mangrove_systemCL_Mangrove_systemSPR` == 1, \n                      round(`lfc_Mangrove_systemCL_Mangrove_systemSPR`, 2), NA),\n                lfc6 = ifelse(`diff_Mangrove_systemCL_Mangrove_systemTL` == 1, \n                      round(`lfc_Mangrove_systemCL_Mangrove_systemTL`, 2), NA),\n                ) %>% tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", \n                          values_to = \"value\") %>% dplyr::arrange(taxon)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create dataframe df_fig_pair2 to significant values\ndf_fig_pair2_Mangrove_system <- res_pair_Mangrove_system %>%\n  dplyr::filter(`diff_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemTL` == 1 |\n                `diff_Mangrove_systemCL` == 1 |\n                `diff_Mangrove_systemTL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemTL` == 1) %>%\n   dplyr::mutate(lfc1 = ifelse(`passed_ss_Mangrove_systemSPR` == 1 & \n                `diff_Mangrove_systemSPR` == 1, \"darkblue\", \"black\"),\n                lfc2 = ifelse(`passed_ss_Mangrove_systemTL` == 1 & \n                `diff_Mangrove_systemTL` == 1, \"darkblue\", \"black\"),\n                lfc3 = ifelse(`passed_ss_Mangrove_systemCL` == 1 &\n                `diff_Mangrove_systemCL` == 1, \"darkblue\", \"black\"),\n                lfc4 = ifelse(`passed_ss_Mangrove_systemTL_Mangrove_systemSPR` == 1 &\n                `diff_Mangrove_systemTL_Mangrove_systemSPR` == 1, \"darkblue\", \"black\"),\n                lfc5 = ifelse(`passed_ss_Mangrove_systemCL_Mangrove_systemSPR` == 1 &\n                `diff_Mangrove_systemCL_Mangrove_systemSPR` == 1, \"darkblue\", \"black\"),\n                lfc6 = ifelse(`passed_ss_Mangrove_systemCL_Mangrove_systemTL` == 1 &\n                `diff_Mangrove_systemCL_Mangrove_systemTL` == 1, \"darkblue\", \"black\")) %>% \n  tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", values_to = \"color\") %>% dplyr::arrange(taxon)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine dataframes df_fig_pair1 and df_fig_pair2\ndf_fig_pair_Mangrove_system <- df_fig_pair1_Mangrove_system %>%\n  dplyr::left_join(df_fig_pair2_Mangrove_system, by = c(\"taxon\", \"group\"))\n\n# Rename groups\ndf_fig_pair_Mangrove_system$group <- recode(df_fig_pair_Mangrove_system$group,\n                                     `lfc1` = \"SPR vs FL\",\n                                     `lfc2` = \"TL vs FL\",\n                                     `lfc3` = \"CL vs FL\",\n                                     `lfc4` = \"TL vs SPR\",\n                                     `lfc5` = \"CL vs SPR\",\n                                     `lfc6` = \"CL vs TL\")\n\ndf_fig_pair_Mangrove_system$group <- factor(df_fig_pair_Mangrove_system$group,\n                                     levels = c(\"SPR vs FL\",\n                                                \"TL vs FL\",\n                                                \"CL vs FL\",\n                                                \"TL vs SPR\",\n                                                \"CL vs SPR\",\n                                                \"CL vs TL\"))\n\n# Filter comparisons without significant values\ndf_fig_pair_Mangrove_system <- df_fig_pair_Mangrove_system %>%\n  group_by(group) %>%\n  filter(any(!is.na(value))) %>%\n  ungroup()\n\n# Calculate limits\nlo <- floor(min(df_fig_pair_Mangrove_system$value, na.rm = TRUE))\nup <- ceiling(max(df_fig_pair_Mangrove_system$value, na.rm = TRUE))\nmid <- (lo + up) / 2\n```\n:::\n\n\n\n## 03. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# heatmap\nheatmap_fig_pair_Mangrove_system <- df_fig_pair_Mangrove_system %>%\n  ggplot(aes(x = group, y = taxon, fill = value)) +\n  geom_tile(color = \"black\") +\n  scale_fill_gradient2(low = \"#37485FFF\", high = \"#907c9BFf\", mid = \"#cad8DCFF\", #a71a50\n                       na.value = \"white\", midpoint = mid, limit = c(lo, up),\n                       name = \"LFC\") +\n  geom_text(aes(label = round(value, 2), color = color), size = 3.5, na.rm = TRUE) +\n  scale_color_identity(guide = FALSE) +\n  labs(x = NULL, y = NULL, title = \"Differential abundance between mangrove system\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, size = 11),\n        axis.text.y = element_text(size = 9, color = \"black\"),\n        axis.text.x = element_text(size = 8.5, angle = 45, \n                                   hjust = 0.8, color = \"black\"))\n\n# show\nprint(heatmap_fig_pair_Mangrove_system)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in\nggplot2 3.3.4.\nℹ Please use \"none\" instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](02.4.DifferentialAbundance_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# DA barplot\nlibrary(paletteer)\nda_barplot <- df_fig_pair_Mangrove_system %>%\n  ggplot(aes(x = taxon, y = value, fill = group, label = round(value, 2))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_paletteer_d(\"ggsci::blue_grey_material\") + #\"rcartocolor::Purp\"\n  # scale_fill_manual(values = c(\"SPR vs FL\" = \"orange\",\n  #                              \"TL vs FL\" = \"#a71b40\",\n  #                              \"CL vs FL\" = \"yellow3\",\n  #                              \"TL vs SPR\" = \"gray50\",\n  #                              \"CL vs SPR\" = \"#af4b91\",\n  #                              \"CL vs TL\" = \"#466eb4\")) +\n  labs(title = \"Differential Abundance by Mangrove system\",\n       x = \"Phylum\",\n       y = \"Log-Fold Change\",\n       fill = \"Comparison\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10),\n        axis.text.y = element_text(size = 8),\n        plot.title = element_text(size = 12),\n        axis.title.x = element_text(size = 9),              \n        axis.title.y = element_text(size = 9),            \n        legend.title = element_text(size = 9))\n\n#show\nda_barplot\n```\n\n::: {.cell-output-display}\n![](02.4.DifferentialAbundance_files/figure-html/da-barplot-1.png){width=672}\n:::\n:::\n\n\n\n## Save rds plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(heatmap_fig_pair_Mangrove_system, \"rds/compare_mangroves/DA_heatmap_surface.rds\")\nsaveRDS(da_barplot, \"rds/compare_mangroves/DA_barplot_surface.rds\")\n```\n:::\n",
    "supporting": [
      "02.4.DifferentialAbundance_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "949e2eb3219bd029ba2ee87341433020",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Core Microbiome\"\n---\n\n\n\n\n\n## Load libraries and prepare data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(UpSetR)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(RColorBrewer)\nlibrary(tibble)\nlibrary(ampvis2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#load data\nphyseq <- readRDS(\"rds/interior_mangroves/phyloseq.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert Location to factor\nsample_data(physeq)$Location <- as.factor(sample_data(physeq)$Location)\n```\n:::\n\n\n\n\n\n## 01. Calculate core\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prevalence threshold\nprevalence_threshold <- 0.8\n\n# Storage ASVs core list\ncore_list <- list()\nlocations <- levels(sample_data(physeq)$Location)\n\n# Calculate core\nfor (loc in locations) {\n  # Filter samples by mangrove system\n  physeq_loc <- prune_samples(sample_data(physeq)$Location == loc, physeq)\n  n_samples_loc <- nsamples(physeq_loc)\n\n  # Extract OTU table\n  otu <- as(otu_table(physeq_loc), \"matrix\")\n\n  # Calc prevalence\n  prevalence <- rowSums(otu > 0) / n_samples_loc\n\n  # Identify ASVs with prevalence >= umbral\n  core_taxa <- names(prevalence)[prevalence >= prevalence_threshold]\n\n  # Guardar en la lista\n  core_list[[loc]] <- core_taxa\n}\n\n# Show ASVs core by mangrove system\nprint(lapply(core_list, length))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`Fossil Lagoon`\n[1] 1043\n\n$`Miguelito Dike`\n[1] 585\n\n$`Reforma Waterfalls`\n[1] 1454\n```\n\n\n:::\n\n```{.r .cell-code}\n# checkpoint,if empty try threshold = 1\nif (all(sapply(core_list, length) == 0)) {\n  cat(\"Try prevalence = 1...\\n\")\n  prevalence_threshold <- 1.0\n  core_list <- list()\n  for (loc in locations) {\n    physeq_loc <- prune_samples(sample_data(physeq)$Location == loc, physeq)\n    n_samples_loc <- nsamples(physeq_loc)\n    otu <- as(otu_table(physeq_loc), \"matrix\")\n    prevalence <- rowSums(otu > 0) / n_samples_loc\n    core_taxa <- names(prevalence)[prevalence >= prevalence_threshold]\n    core_list[[loc]] <- core_taxa\n  }\n  print(lapply(core_list, length))\n}\n```\n:::\n\n\n\n\n\n## 02. Extract core info\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Unique core ASV list\nall_core_asvs <- unique(unlist(core_list))\n\n# Create matrix presence/absence\ncore_matrix <- matrix(0, nrow = length(all_core_asvs), ncol = length(locations),\n                      dimnames = list(all_core_asvs, locations))\n\n# fill matrix: \nfor (loc in locations) {\n  core_matrix[core_list[[loc]], loc] <- 1\n}\n\n# Convert to data frame to UpSetR\ncore_df <- as.data.frame(core_matrix)\n\n# Create intersection list\nqueries_list <- list()\n```\n:::\n\n\n\n\n\n## 03. plot aesthetics\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#library(UpSetR)\n# Fossil Lagoon\nqueries_list <- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\"), color = \"#A3D9A8\",\n       active = TRUE, query.name = \"Fossil Lagoon\")))\n\n# Reforma Waterfalls\nqueries_list <- append(queries_list, list(\n  list(query = intersects, params = list(\"Reforma Waterfalls\"), color = \"#44C17B\",\n       active = TRUE, query.name = \"Reforma Waterfalls\")))\n\n# Miguelito Dike\nqueries_list <- append(queries_list, list(\n  list(query = intersects, params = list(\"Miguelito Dike\"), color = \"#2E8B57\",\n       active = TRUE, query.name = \"Miguelito Dike\")))\n\n\n# Core\nqueries_list <- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\", \n                                         \"Reforma Waterfalls\",\n                                         \"Miguelito Dike\"),\n       color = \"#8D3CA3\", active = TRUE, query.name = \"Core\")))\n```\n:::\n\n\n\n\n\n## 04. UpSet plot\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#library(UpSetR)\nupset_plot <- upset(core_df,\n                    sets = colnames(core_df),\n                    order.by = \"freq\",\n                    mainbar.y.label = \"Shared ASVs\",\n                    sets.x.label = \"ASVs per Site\",\n                    text.scale = 1.3,\n                    point.size = 4,\n                    line.size = 1.5,\n                    query.legend = \"bottom\",\n                    sets.bar.color = \n                      c(\"#44C17B\",\"#A3D9A8\",\"#2E8B57\"),\n                    queries = queries_list)\n\n# show\nprint(upset_plot)\n```\n\n::: {.cell-output-display}\n![](03.4.Coremicrobiome_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\nsave plot\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npdf(\"Figures/interior_mangroves/core_upset.pdf\", width = 5.8, height = 4)\nupset_plot\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nquartz_off_screen \n                2 \n```\n\n\n:::\n:::\n\n\n\n\n\n## 05. Get unique and core ASV info\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### get unique ASVs per mangrove system\nunique_asvs <- list()\nfor (loc in colnames(core_df)) {\n  unique_asvs[[loc]] <- rownames(core_df)[rowSums(core_df == 1) == 1 & core_df[[loc]] == 1]\n  cat(loc, \": Unique ASVs:\", length(unique_asvs[[loc]]), \"\\n\")\n  print(head(unique_asvs[[loc]], 5))  # Show first 5\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFossil Lagoon : Unique ASVs: 551 \n[1] \"ASV_1157\" \"ASV_2508\" \"ASV_7072\" \"ASV_3541\" \"ASV_2759\"\nMiguelito Dike : Unique ASVs: 199 \n[1] \"ASV_115\"  \"ASV_1676\" \"ASV_4663\" \"ASV_1294\" \"ASV_1092\"\nReforma Waterfalls : Unique ASVs: 867 \n[1] \"ASV_6234\" \"ASV_1191\" \"ASV_5039\" \"ASV_2114\" \"ASV_5289\"\n```\n\n\n:::\n\n```{.r .cell-code}\n#unique_asvs\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verify taxonomy\nif (!is.null(tax_table(physeq))) {\n  tax_table_df <- as.data.frame(tax_table(physeq))\n\n  # Get taxonomy function\n  get_taxonomy <- function(asv_list) {\n    if (length(asv_list) > 0) {\n      taxonomy <- tax_table_df[asv_list, , drop = FALSE]\n      return(taxonomy)\n    } else {\n      return(NULL)\n    }\n  }\n\n  # Get taxonomy\n  taxonomy_unique <- lapply(unique_asvs, get_taxonomy)\n\n  # show first 5  unique ASVs\n  for (loc in names(taxonomy_unique)) {\n    cat(\"\\nFirst unique ASVs taxonomy\", loc, \":\\n\")\n    if (!is.null(taxonomy_unique[[loc]])) {\n      print(head(taxonomy_unique[[loc]], 5))\n    } else {\n      cat(\"There are no unique ASV to\", loc, \"\\n\")\n    }\n  }\n} else {\n  cat(\"Please import taxonomy.\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFirst unique ASVs taxonomy Fossil Lagoon :\n            Kingdom        Phylum         Class         Order        Family\nASV_1157 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_2508 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_7072 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_3541 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_2759 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\n                 Genus                 Species\nASV_1157 Bathyarchaeia                    <NA>\nASV_2508 Bathyarchaeia                    <NA>\nASV_7072 Bathyarchaeia                    <NA>\nASV_3541 Bathyarchaeia                    <NA>\nASV_2759 Bathyarchaeia uncultured_methanogenic\n\nFirst unique ASVs taxonomy Miguelito Dike :\n            Kingdom           Phylum          Class\nASV_115  d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_1676 d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_4663 d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_1294 d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_1092 d__Archaea Thermoplasmatota Thermoplasmata\n                                      Order                             Family\nASV_115                       Bathyarchaeia                      Bathyarchaeia\nASV_1676                      Bathyarchaeia                      Bathyarchaeia\nASV_4663                      Bathyarchaeia                      Bathyarchaeia\nASV_1294                      Bathyarchaeia                      Bathyarchaeia\nASV_1092 Marine_Benthic_Group_D_and_DHVEG-1 Marine_Benthic_Group_D_and_DHVEG-1\n                                      Genus                   Species\nASV_115                       Bathyarchaeia      uncultured_bacterium\nASV_1676                      Bathyarchaeia   uncultured_methanogenic\nASV_4663                      Bathyarchaeia   uncultured_methanogenic\nASV_1294                      Bathyarchaeia                      <NA>\nASV_1092 Marine_Benthic_Group_D_and_DHVEG-1 uncultured_Thermoplasmata\n\nFirst unique ASVs taxonomy Reforma Waterfalls :\n            Kingdom        Phylum         Class         Order        Family\nASV_6234 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_1191 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_5039 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_2114 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_5289 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\n                 Genus                   Species\nASV_6234 Bathyarchaeia   uncultured_methanogenic\nASV_1191 Bathyarchaeia                      <NA>\nASV_5039 Bathyarchaeia   uncultured_methanogenic\nASV_2114 Bathyarchaeia  uncultured_crenarchaeote\nASV_5289 Bathyarchaeia uncultured_Bathyarchaeota\n```\n\n\n:::\n\n```{.r .cell-code}\n# Confirm the total number of unique ASVs\nlapply(taxonomy_unique, function(x) if (!is.null(x)) nrow(x) else 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`Fossil Lagoon`\n[1] 551\n\n$`Miguelito Dike`\n[1] 199\n\n$`Reforma Waterfalls`\n[1] 867\n```\n\n\n:::\n:::\n\n\n\n\n\nGet taxonomy\n\nPhylum level\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list to store unique asv to Phylum level\nphylum_unique <- list()\n\n# Iterate on each Mangrove system\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy phylum\n    tax_df <- taxonomy_unique[[loc]]\n    if (\"Phylum\" %in% colnames(tax_df)) {\n      phylum <- tax_df$Phylum\n      phylum <- phylum[!is.na(phylum)]  # Exclude NA\n      phylum_unique[[loc]] <- unique(phylum)\n    } else {\n      cat(\"Phylum is not available to\", loc, \"\\n\")\n      phylum_unique[[loc]] <- character(0)\n    }\n  } else {\n    phylum_unique[[loc]] <- character(0)\n  }\n}\n\n# Identify exclusive phylum for Mangrove system\nall_phylums <- unique(unlist(phylum_unique))\nphylum_exclusive <- list()\nfor (loc in names(phylum_unique)) {\n  other_locations <- setdiff(names(phylum_unique), loc)\n  other_phylum <- unique(unlist(phylum_unique[other_locations]))\n  exclusive_phylum <- setdiff(phylum_unique[[loc]], other_phylum)\n  phylum_exclusive[[loc]] <- exclusive_phylum\n  cat(\"Exclusive phylum in\", loc, \":\", length(exclusive_phylum), \"\\n\")\n  if (length(exclusive_phylum) > 0) {\n    print(exclusive_phylum)\n  } else {\n    cat(\"There are not exclusive phylum.\\n\")\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nExclusive phylum in Fossil Lagoon : 1 \n[1] \"Hydrogenedentes\"\nExclusive phylum in Miguelito Dike : 2 \n[1] \"Thermoplasmatota\" \"Fibrobacterota\"  \nExclusive phylum in Reforma Waterfalls : 9 \n[1] \"WPS-2\"             \"10bav-F6\"          \"RCP2-54\"          \n[4] \"Bdellovibrionota\"  \"Deferrisomatota\"   \"Campilobacterota\" \n[7] \"WS2\"               \"Entotheonellaeota\" \"Nitrospinota\"     \n```\n\n\n:::\n:::\n\n\n\n\n\nClass level\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list to store unique asv to Class level\nclass_unique <- list()\n\n# Iterate on each Location\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy class\n    tax_df <- taxonomy_unique[[loc]]\n    if (\"Class\" %in% colnames(tax_df)) {\n      class <- tax_df$Class\n      class <- class[!is.na(class)]  # Exclude NA\n      class_unique[[loc]] <- unique(class)\n    } else {\n      cat(\"Class is not available to\", loc, \"\\n\")\n      class_unique[[loc]] <- character(0)\n    }\n  } else {\n    class_unique[[loc]] <- character(0)\n  }\n}\n\n# Identify exclusive phylum for Mangrove system\nall_class <- unique(unlist(class_unique))\nclass_exclusive <- list()\nfor (loc in names(class_unique)) {\n  other_locations <- setdiff(names(class_unique), loc)\n  other_class <- unique(unlist(class_unique[other_locations]))\n  exclusive_class <- setdiff(class_unique[[loc]], other_class)\n  class_exclusive[[loc]] <- exclusive_class\n  cat(\"Exclusive class in\", loc, \":\", length(exclusive_class), \"\\n\")\n  if (length(exclusive_class) > 0) {\n    print(exclusive_class)\n  } else {\n    cat(\"There are not exclusive class.\\n\")\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nExclusive class in Fossil Lagoon : 10 \n [1] \"Chlamydiae\"      \"ABY1\"            \"Kazania\"         \"MD2902-B12\"     \n [5] \"Kapabacteria\"    \"Microgenomatia\"  \"Hydrogenedentia\" \"OC31\"           \n [9] \"WCHB1-81\"        \"OLB14\"          \nExclusive class in Miguelito Dike : 3 \n[1] \"Thermoplasmata\"   \"Chitinivibrionia\" \"Leptospirae\"     \nExclusive class in Reforma Waterfalls : 17 \n [1] \"vadinHA49\"       \"Saccharimonadia\" \"AKAU4049\"        \"WPS-2\"          \n [5] \"DG-56\"           \"10bav-F6\"        \"RCP2-54\"         \"Bdellovibrionia\"\n [9] \"Defferrisomatia\" \"bacteriap25\"     \"Campylobacteria\" \"WS2\"            \n[13] \"Holophagae\"      \"Entotheonellia\"  \"Subgroup_25\"     \"Subgroup_11\"    \n[17] \"P9X2b3D02\"      \n```\n\n\n:::\n:::\n\n\n\n\n\nFamily level\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list to store unique asv to specific taxonomy level\nfamilies_unique <- list()\n\n# Iterate on each Mangrove system\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy families\n    tax_df <- taxonomy_unique[[loc]]\n    if (\"Family\" %in% colnames(tax_df)) {\n      families <- tax_df$Family\n      families <- families[!is.na(families)]  # Exclude NA\n      families_unique[[loc]] <- unique(families)\n    } else {\n      cat(\"Family is not available to\", loc, \"\\n\")\n      families_unique[[loc]] <- character(0)\n    }\n  } else {\n    families_unique[[loc]] <- character(0)\n  }\n}\n\n# Identify exclusive family for Mangrove system\nall_families <- unique(unlist(families_unique))\nfamilies_exclusive <- list()\nfor (loc in names(families_unique)) {\n  other_locations <- setdiff(names(families_unique), loc)\n  other_families <- unique(unlist(families_unique[other_locations]))\n  exclusive_families <- setdiff(families_unique[[loc]], other_families)\n  families_exclusive[[loc]] <- exclusive_families\n  cat(\"Exclusive family in\", loc, \":\", length(exclusive_families), \"\\n\")\n  if (length(exclusive_families) > 0) {\n    print(exclusive_families)\n  } else {\n    cat(\"There are not exclusive family.\\n\")\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nExclusive family in Fossil Lagoon : 37 \n [1] \"mle1-8\"                     \"AKAU3564_sediment_group\"   \n [3] \"Pirellulaceae\"              \"Methylacidiphilaceae\"      \n [5] \"Simkaniaceae\"               \"Candidatus_Moranbacteria\"  \n [7] \"Candidatus_Komeilibacteria\" \"Kazania\"                   \n [9] \"MD2902-B12\"                 \"Gammaproteobacteria\"       \n[11] \"EC3\"                        \"Diplorickettsiaceae\"       \n[13] \"Rhodanobacteraceae\"         \"Methylococcaceae\"          \n[15] \"Beggiatoaceae\"              \"A0839\"                     \n[17] \"Micropepsaceae\"             \"Haliangiaceae\"             \n[19] \"UASB-TL25\"                  \"Polyangiaceae\"             \n[21] \"Eel-36e1D6\"                 \"BIrii41\"                   \n[23] \"Myxococcaceae\"              \"Paludibacteraceae\"         \n[25] \"37-13\"                      \"Kapabacteriales\"           \n[27] \"Candidatus_Collierbacteria\" \"Candidatus_Levybacteria\"   \n[29] \"Hydrogenedensaceae\"         \"OC31\"                      \n[31] \"WCHB1-81\"                   \"OLB14\"                     \n[33] \"MSB-5E12\"                   \"Bryobacteraceae\"           \n[35] \"Hungateiclostridiaceae\"     \"Ruminococcaceae\"           \n[37] \"Streptococcaceae\"          \nExclusive family in Miguelito Dike : 9 \n[1] \"Marine_Benthic_Group_D_and_DHVEG-1\" \"Alteromonadaceae\"                  \n[3] \"Bacteroidetes_BD2-2\"                \"Bifidobacteriaceae\"                \n[5] \"Napoli-4B-65\"                       \"t0.6.f\"                            \n[7] \"Sh765B-AG-111\"                      \"SAR202_clade\"                      \n[9] \"Leptospiraceae\"                    \nExclusive family in Reforma Waterfalls : 63 \n [1] \"vadinHA49\"              \"CCM11a\"                 \"Gemmataceae\"           \n [4] \"Rubritaleaceae\"         \"LWQ8\"                   \"WX65\"                  \n [7] \"Methylomirabilaceae\"    \"AKAU4049\"               \"WPS-2\"                 \n[10] \"DG-56\"                  \"Enterobacteriaceae\"     \"Succinivibrionaceae\"   \n[13] \"KI89A_clade\"            \"Xanthomonadaceae\"       \"Spongiibacteraceae\"    \n[16] \"EPR3968-O8a-Bc78\"       \"PLTA13\"                 \"CCD24\"                 \n[19] \"JG36-GS-52\"             \"Chromatiaceae\"          \"Ectothiorhodospiraceae\"\n[22] \"WN-HWB-116\"             \"Sutterellaceae\"         \"SC-I-84\"               \n[25] \"Chitinimonadaceae\"      \"Oxalobacteraceae\"       \"Gallionellaceae\"       \n[28] \"MBMPE27\"                \"Rhizobiaceae\"           \"Sphingomonadaceae\"     \n[31] \"Reyranellaceae\"         \"Geminicoccaceae\"        \"Ferrovibrionales\"      \n[34] \"10bav-F6\"               \"RCP2-54\"                \"Bdellovibrionaceae\"    \n[37] \"Defferrisomataceae\"     \"bacteriap25\"            \"Dysgonomonadaceae\"     \n[40] \"Sphingobacteriaceae\"    \"Flavobacteriaceae\"      \"Saprospiraceae\"        \n[43] \"LD-RB-34\"               \"Sulfurimonadaceae\"      \"WS2\"                   \n[46] \"Subgroup_7\"             \"Entotheonellaceae\"      \"Subgroup_25\"           \n[49] \"Subgroup_9\"             \"Subgroup_11\"            \"Geodermatophilaceae\"   \n[52] \"IMCC26256\"              \"vadinBA26\"              \"FS117-23B-02\"          \n[55] \"SJA-15\"                 \"DS-100\"                 \"Pyrinomonadaceae\"      \n[58] \"Solibacteraceae\"        \"P9X2b3D02\"              \"Peptostreptococcaceae\" \n[61] \"Clostridiaceae\"         \"Alicyclobacillaceae\"    \"Enterococcaceae\"       \n```\n\n\n:::\n:::\n\n\n\n\n\nGet core table\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine taxonomy in data.frame\ntaxonomy_unique_df <- do.call(rbind, lapply(names(taxonomy_unique), function(loc) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    df <- taxonomy_unique[[loc]]\n    df$Location <- loc\n    df$ASV <- rownames(df)# add name asv column\n    return(df)\n  } else {\n    return(NULL)\n  }\n}))\n\n# Move columns\ntaxonomy_unique_df <- taxonomy_unique_df[, c(\"ASV\", \"Location\", setdiff(names(taxonomy_unique_df), c(\"ASV\", \"Location\")))]\n\n# show first rows of data.frame to verify\nprint(head(taxonomy_unique_df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              ASV      Location    Kingdom        Phylum         Class\nASV_1157 ASV_1157 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_2508 ASV_2508 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_7072 ASV_7072 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_3541 ASV_3541 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_2759 ASV_2759 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_2092 ASV_2092 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\n                 Order        Family         Genus                 Species\nASV_1157 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    <NA>\nASV_2508 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    <NA>\nASV_7072 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    <NA>\nASV_3541 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    <NA>\nASV_2759 Bathyarchaeia Bathyarchaeia Bathyarchaeia uncultured_methanogenic\nASV_2092 Bathyarchaeia Bathyarchaeia Bathyarchaeia uncultured_methanogenic\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# save data.frame\nwrite.csv(taxonomy_unique_df, file = \"Tables/interior_mangroves/unique_asvs_taxonomy.csv\", row.names = FALSE)\n```\n:::\n\n\n\n\n\n## 06. Get core taxonomy\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshared_asvs <- Reduce(intersect, core_list)\nprint(shared_asvs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"ASV_120\"  \"ASV_1769\" \"ASV_513\"  \"ASV_537\"  \"ASV_2449\" \"ASV_167\" \n  [7] \"ASV_480\"  \"ASV_2782\" \"ASV_1291\" \"ASV_1967\" \"ASV_4990\" \"ASV_1489\"\n [13] \"ASV_231\"  \"ASV_3\"    \"ASV_551\"  \"ASV_645\"  \"ASV_9\"    \"ASV_10\"  \n [19] \"ASV_20\"   \"ASV_48\"   \"ASV_506\"  \"ASV_913\"  \"ASV_2363\" \"ASV_18\"  \n [25] \"ASV_85\"   \"ASV_97\"   \"ASV_798\"  \"ASV_253\"  \"ASV_198\"  \"ASV_1302\"\n [31] \"ASV_1518\" \"ASV_3187\" \"ASV_802\"  \"ASV_969\"  \"ASV_2829\" \"ASV_1443\"\n [37] \"ASV_1523\" \"ASV_19\"   \"ASV_24\"   \"ASV_35\"   \"ASV_501\"  \"ASV_1093\"\n [43] \"ASV_1322\" \"ASV_1865\" \"ASV_1344\" \"ASV_25\"   \"ASV_376\"  \"ASV_51\"  \n [49] \"ASV_977\"  \"ASV_1375\" \"ASV_1514\" \"ASV_1853\" \"ASV_2591\" \"ASV_6\"   \n [55] \"ASV_33\"   \"ASV_16\"   \"ASV_1987\" \"ASV_2604\" \"ASV_160\"  \"ASV_1189\"\n [61] \"ASV_1873\" \"ASV_4157\" \"ASV_2866\" \"ASV_3516\" \"ASV_39\"   \"ASV_41\"  \n [67] \"ASV_68\"   \"ASV_1042\" \"ASV_1246\" \"ASV_3880\" \"ASV_2297\" \"ASV_511\" \n [73] \"ASV_1356\" \"ASV_4894\" \"ASV_743\"  \"ASV_1573\" \"ASV_746\"  \"ASV_1089\"\n [79] \"ASV_1116\" \"ASV_118\"  \"ASV_58\"   \"ASV_62\"   \"ASV_204\"  \"ASV_3227\"\n [85] \"ASV_3698\" \"ASV_2303\" \"ASV_1041\" \"ASV_2235\" \"ASV_2317\" \"ASV_3225\"\n [91] \"ASV_130\"  \"ASV_300\"  \"ASV_692\"  \"ASV_552\"  \"ASV_7\"    \"ASV_250\" \n [97] \"ASV_103\"  \"ASV_114\"  \"ASV_197\"  \"ASV_36\"   \"ASV_109\"  \"ASV_79\"  \n[103] \"ASV_61\"   \"ASV_256\"  \"ASV_196\"  \"ASV_321\"  \"ASV_123\"  \"ASV_105\" \n[109] \"ASV_162\"  \"ASV_166\"  \"ASV_395\"  \"ASV_3212\" \"ASV_246\"  \"ASV_8\"   \n[115] \"ASV_15\"   \"ASV_12\"   \"ASV_11\"   \"ASV_71\"   \"ASV_568\"  \"ASV_487\" \n[121] \"ASV_689\"  \"ASV_892\"  \"ASV_584\"  \"ASV_362\"  \"ASV_1595\" \"ASV_1786\"\n[127] \"ASV_329\"  \"ASV_2126\" \"ASV_3984\" \"ASV_643\"  \"ASV_557\"  \"ASV_781\" \n[133] \"ASV_1254\" \"ASV_1032\" \"ASV_23\"   \"ASV_93\"   \"ASV_86\"   \"ASV_147\" \n[139] \"ASV_1080\" \"ASV_297\"  \"ASV_331\"  \"ASV_4\"    \"ASV_230\"  \"ASV_653\" \n[145] \"ASV_396\"  \"ASV_21\"   \"ASV_2616\" \"ASV_3087\" \"ASV_450\"  \"ASV_3338\"\n[151] \"ASV_516\"  \"ASV_1911\" \"ASV_2747\" \"ASV_141\"  \"ASV_784\"  \"ASV_771\" \n[157] \"ASV_2787\" \"ASV_1075\" \"ASV_2600\" \"ASV_2301\" \"ASV_345\"  \"ASV_942\" \n[163] \"ASV_558\"  \"ASV_92\"   \"ASV_283\"  \"ASV_289\"  \"ASV_221\"  \"ASV_434\" \n[169] \"ASV_239\"  \"ASV_341\"  \"ASV_148\"  \"ASV_116\"  \"ASV_747\"  \"ASV_127\" \n[175] \"ASV_4434\" \"ASV_3540\" \"ASV_1256\" \"ASV_1264\" \"ASV_1124\" \"ASV_2786\"\n[181] \"ASV_3411\" \"ASV_29\"   \"ASV_59\"   \"ASV_60\"   \"ASV_505\"  \"ASV_163\" \n[187] \"ASV_2082\" \"ASV_1751\" \"ASV_3218\" \"ASV_317\"  \"ASV_1487\" \"ASV_1552\"\n[193] \"ASV_935\"  \"ASV_1370\" \"ASV_1408\" \"ASV_280\"  \"ASV_473\"  \"ASV_40\"  \n[199] \"ASV_399\"  \"ASV_110\"  \"ASV_201\"  \"ASV_383\"  \"ASV_1646\" \"ASV_227\" \n[205] \"ASV_278\"  \"ASV_668\"  \"ASV_1208\" \"ASV_921\"  \"ASV_1020\" \"ASV_14\"  \n[211] \"ASV_249\"  \"ASV_453\"  \"ASV_4485\" \"ASV_22\"   \"ASV_622\"  \"ASV_65\"  \n[217] \"ASV_2949\" \"ASV_3929\" \"ASV_275\"  \"ASV_451\"  \"ASV_155\"  \"ASV_548\" \n[223] \"ASV_3387\" \"ASV_3539\" \"ASV_1062\" \"ASV_2653\" \"ASV_774\"  \"ASV_1081\"\n[229] \"ASV_1727\" \"ASV_2603\" \"ASV_3016\" \"ASV_222\"  \"ASV_2448\" \"ASV_243\" \n[235] \"ASV_470\"  \"ASV_1839\" \"ASV_215\"  \"ASV_226\"  \"ASV_944\"  \"ASV_286\" \n[241] \"ASV_442\"  \"ASV_4817\" \"ASV_1163\" \"ASV_493\"  \"ASV_150\"  \"ASV_2\"   \n[247] \"ASV_412\"  \"ASV_475\"  \"ASV_157\"  \"ASV_415\"  \"ASV_776\"  \"ASV_494\" \n[253] \"ASV_125\"  \"ASV_13\"   \"ASV_1\"   \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshared_taxonomy <- get_taxonomy(shared_asvs)\nprint(shared_taxonomy)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Kingdom            Phylum                  Class\nASV_120   d__Archaea     Crenarchaeota          Bathyarchaeia\nASV_1769 d__Bacteria   Planctomycetota         Planctomycetes\nASV_513  d__Bacteria       Sumerlaeota             Sumerlaeia\nASV_537  d__Bacteria Verrucomicrobiota       Verrucomicrobiae\nASV_2449 d__Bacteria Verrucomicrobiota       Verrucomicrobiae\nASV_167  d__Bacteria      Deinococcota             Deinococci\nASV_480  d__Bacteria   Patescibacteria        Saccharimonadia\nASV_2782 d__Bacteria   Patescibacteria        Saccharimonadia\nASV_1291 d__Bacteria   Patescibacteria          Parcubacteria\nASV_1967 d__Bacteria   Patescibacteria          Parcubacteria\nASV_4990 d__Bacteria   Patescibacteria          Parcubacteria\nASV_1489 d__Bacteria   Patescibacteria                   ABY1\nASV_231  d__Bacteria   Acidobacteriota          Aminicenantia\nASV_3    d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_551  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_645  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_9    d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_10   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_20   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_48   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_506  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_913  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2363 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_18   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_85   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_97   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_798  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_253  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_198  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1302 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1518 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_3187 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_802  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_969  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2829 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1443 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1523 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_19   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_24   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_35   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_501  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1093 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1322 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1865 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1344 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_25   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_376  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_51   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_977  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1375 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1514 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1853 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2591 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_6    d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_33   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_16   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1987 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2604 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_160  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1189 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1873 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_4157 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2866 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_3516 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_39   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_41   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_68   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1042 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1246 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_3880 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2297 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_511  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1356 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_4894 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_743  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1573 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_746  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1089 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1116 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_118  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_58   d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_62   d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_204  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_3227 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_3698 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_2303 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_1041 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_2235 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_2317 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_3225 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_130  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_300  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_692  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_552  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_7    d__Bacteria           Sva0485                Sva0485\nASV_250  d__Bacteria           Sva0485                Sva0485\nASV_103  d__Bacteria           Sva0485                Sva0485\nASV_114  d__Bacteria           Sva0485                Sva0485\nASV_197  d__Bacteria           Sva0485                Sva0485\nASV_36   d__Bacteria           Sva0485                Sva0485\nASV_109  d__Bacteria           Sva0485                Sva0485\nASV_79   d__Bacteria           Sva0485                Sva0485\nASV_61   d__Bacteria           Sva0485                Sva0485\nASV_256  d__Bacteria           Sva0485                Sva0485\nASV_196  d__Bacteria           Sva0485                Sva0485\nASV_321  d__Bacteria           Sva0485                Sva0485\nASV_123  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_105  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_162  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_166  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_395  d__Bacteria  Desulfobacterota             uncultured\nASV_3212 d__Bacteria       Myxococcota              Polyangia\nASV_246  d__Bacteria            MBNT15                 MBNT15\nASV_8    d__Bacteria      Bacteroidota            Bacteroidia\nASV_15   d__Bacteria      Bacteroidota            Bacteroidia\nASV_12   d__Bacteria      Bacteroidota            Bacteroidia\nASV_11   d__Bacteria      Bacteroidota            Bacteroidia\nASV_71   d__Bacteria      Bacteroidota            Bacteroidia\nASV_568  d__Bacteria      Bacteroidota            Bacteroidia\nASV_487  d__Bacteria      Bacteroidota            Bacteroidia\nASV_689  d__Bacteria      Bacteroidota            Bacteroidia\nASV_892  d__Bacteria      Bacteroidota            Bacteroidia\nASV_584  d__Bacteria      Bacteroidota            Bacteroidia\nASV_362  d__Bacteria      Bacteroidota            Bacteroidia\nASV_1595 d__Bacteria      Bacteroidota            Bacteroidia\nASV_1786 d__Bacteria      Bacteroidota            Bacteroidia\nASV_329  d__Bacteria      Bacteroidota            Bacteroidia\nASV_2126 d__Bacteria      Bacteroidota            Bacteroidia\nASV_3984 d__Bacteria      Bacteroidota            Bacteroidia\nASV_643  d__Bacteria      Bacteroidota         Ignavibacteria\nASV_557  d__Bacteria      Bacteroidota         Ignavibacteria\nASV_781  d__Bacteria      Bacteroidota              Kryptonia\nASV_1254 d__Bacteria  Campilobacterota        Campylobacteria\nASV_1032 d__Bacteria     Spirochaetota           Spirochaetia\nASV_23   d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_93   d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_86   d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_147  d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_1080 d__Bacteria   Acidobacteriota            Subgroup_18\nASV_297  d__Bacteria     Calditrichota           Calditrichia\nASV_331  d__Bacteria      Zixibacteria           Zixibacteria\nASV_4    d__Bacteria  Actinobacteriota         Actinobacteria\nASV_230  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_653  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_396  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_21   d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2616 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_3087 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_450  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_3338 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_516  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_1911 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2747 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_141  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_784  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_771  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2787 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_1075 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2600 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2301 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_345  d__Bacteria  Actinobacteriota         Coriobacteriia\nASV_942  d__Bacteria  Actinobacteriota         Coriobacteriia\nASV_558  d__Bacteria       Chloroflexi                   <NA>\nASV_92   d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_283  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_289  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_221  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_434  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_239  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_341  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_148  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_116  d__Bacteria       Chloroflexi           Anaerolineae\nASV_747  d__Bacteria       Chloroflexi           Anaerolineae\nASV_127  d__Bacteria       Chloroflexi           Anaerolineae\nASV_4434 d__Bacteria       Chloroflexi           Chloroflexia\nASV_3540 d__Bacteria   Acidobacteriota         Acidobacteriae\nASV_1256 d__Bacteria     Cyanobacteria      Sericytochromatia\nASV_1264 d__Bacteria    Fusobacteriota          Fusobacteriia\nASV_1124 d__Bacteria        Firmicutes             Clostridia\nASV_2786 d__Bacteria        Firmicutes             Clostridia\nASV_3411 d__Bacteria        Firmicutes             Clostridia\nASV_29   d__Bacteria        Firmicutes          Negativicutes\nASV_59   d__Bacteria        Firmicutes          Negativicutes\nASV_60   d__Bacteria        Firmicutes          Negativicutes\nASV_505  d__Bacteria        Firmicutes          Negativicutes\nASV_163  d__Bacteria        Firmicutes          Negativicutes\nASV_2082 d__Bacteria        Firmicutes          Negativicutes\nASV_1751 d__Bacteria        Firmicutes          Negativicutes\nASV_3218 d__Bacteria        Firmicutes          Negativicutes\nASV_317  d__Bacteria        Firmicutes          Negativicutes\nASV_1487 d__Bacteria        Firmicutes          Negativicutes\nASV_1552 d__Bacteria        Firmicutes          Negativicutes\nASV_935  d__Bacteria        Firmicutes          Negativicutes\nASV_1370 d__Bacteria        Firmicutes          Negativicutes\nASV_1408 d__Bacteria        Firmicutes          Negativicutes\nASV_280  d__Bacteria        Firmicutes          Negativicutes\nASV_473  d__Bacteria        Firmicutes          Negativicutes\nASV_40   d__Bacteria        Firmicutes          Negativicutes\nASV_399  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_110  d__Bacteria        Firmicutes                Bacilli\nASV_201  d__Bacteria        Firmicutes                Bacilli\nASV_383  d__Bacteria        Firmicutes                Bacilli\nASV_1646 d__Bacteria        Firmicutes                Bacilli\nASV_227  d__Bacteria        Firmicutes                Bacilli\nASV_278  d__Bacteria        Firmicutes                Bacilli\nASV_668  d__Bacteria        Firmicutes                Bacilli\nASV_1208 d__Bacteria        Firmicutes                Bacilli\nASV_921  d__Bacteria        Firmicutes                Bacilli\nASV_1020 d__Bacteria        Firmicutes                Bacilli\nASV_14   d__Bacteria        Firmicutes                Bacilli\nASV_249  d__Bacteria        Firmicutes                Bacilli\nASV_453  d__Bacteria        Firmicutes                Bacilli\nASV_4485 d__Bacteria        Firmicutes                Bacilli\nASV_22   d__Bacteria        Firmicutes                Bacilli\nASV_622  d__Bacteria        Firmicutes                Bacilli\nASV_65   d__Bacteria        Firmicutes                Bacilli\nASV_2949 d__Bacteria        Firmicutes                Bacilli\nASV_3929 d__Bacteria        Firmicutes                Bacilli\nASV_275  d__Bacteria        Firmicutes                Bacilli\nASV_451  d__Bacteria        Firmicutes                Bacilli\nASV_155  d__Bacteria        Firmicutes                Bacilli\nASV_548  d__Bacteria        Firmicutes                Bacilli\nASV_3387 d__Bacteria        Firmicutes                Bacilli\nASV_3539 d__Bacteria        Firmicutes                Bacilli\nASV_1062 d__Bacteria        Firmicutes                Bacilli\nASV_2653 d__Bacteria        Firmicutes                Bacilli\nASV_774  d__Bacteria        Firmicutes                Bacilli\nASV_1081 d__Bacteria        Firmicutes                Bacilli\nASV_1727 d__Bacteria        Firmicutes                Bacilli\nASV_2603 d__Bacteria        Firmicutes                Bacilli\nASV_3016 d__Bacteria        Firmicutes                Bacilli\nASV_222  d__Bacteria        Firmicutes                Bacilli\nASV_2448 d__Bacteria        Firmicutes                Bacilli\nASV_243  d__Bacteria        Firmicutes                Bacilli\nASV_470  d__Bacteria        Firmicutes                Bacilli\nASV_1839 d__Bacteria        Firmicutes                Bacilli\nASV_215  d__Bacteria        Firmicutes                Bacilli\nASV_226  d__Bacteria        Firmicutes                Bacilli\nASV_944  d__Bacteria        Firmicutes                Bacilli\nASV_286  d__Bacteria        Firmicutes                Bacilli\nASV_442  d__Bacteria        Firmicutes                Bacilli\nASV_4817 d__Bacteria        Firmicutes                Bacilli\nASV_1163 d__Bacteria        Firmicutes                Bacilli\nASV_493  d__Bacteria        Firmicutes                Bacilli\nASV_150  d__Bacteria        Firmicutes                Bacilli\nASV_2    d__Bacteria        Firmicutes                Bacilli\nASV_412  d__Bacteria        Firmicutes                Bacilli\nASV_475  d__Bacteria        Firmicutes                Bacilli\nASV_157  d__Bacteria        Firmicutes                Bacilli\nASV_415  d__Bacteria        Firmicutes                Bacilli\nASV_776  d__Bacteria        Firmicutes                Bacilli\nASV_494  d__Bacteria        Firmicutes                Bacilli\nASV_125  d__Bacteria        Firmicutes                Bacilli\nASV_13   d__Bacteria        Firmicutes                Bacilli\nASV_1    d__Bacteria        Firmicutes                Bacilli\n                                  Order                       Family\nASV_120                   Bathyarchaeia                Bathyarchaeia\nASV_1769                  Isosphaerales               Isosphaeraceae\nASV_513                    Sumerlaeales                Sumerlaeaceae\nASV_537                  Pedosphaerales              Pedosphaeraceae\nASV_2449                 Pedosphaerales              Pedosphaeraceae\nASV_167                   Deinococcales               Deinococcaceae\nASV_480               Saccharimonadales           Saccharimonadaceae\nASV_2782              Saccharimonadales            Saccharimonadales\nASV_1291                  Parcubacteria                Parcubacteria\nASV_1967      Candidatus_Kaiserbacteria    Candidatus_Kaiserbacteria\nASV_4990                           <NA>                         <NA>\nASV_1489   Candidatus_Magasanikbacteria Candidatus_Magasanikbacteria\nASV_231                 Aminicenantales              Aminicenantales\nASV_3                  Enterobacterales           Enterobacteriaceae\nASV_551                Enterobacterales           Enterobacteriaceae\nASV_645                Enterobacterales           Enterobacteriaceae\nASV_9                  Enterobacterales           Enterobacteriaceae\nASV_10                 Enterobacterales           Enterobacteriaceae\nASV_20                 Enterobacterales           Enterobacteriaceae\nASV_48                 Enterobacterales           Enterobacteriaceae\nASV_506                Enterobacterales           Enterobacteriaceae\nASV_913                Enterobacterales           Enterobacteriaceae\nASV_2363               Enterobacterales           Enterobacteriaceae\nASV_18                 Enterobacterales           Enterobacteriaceae\nASV_85                 Enterobacterales           Enterobacteriaceae\nASV_97                 Enterobacterales               Morganellaceae\nASV_798                Enterobacterales               Morganellaceae\nASV_253                Enterobacterales               Morganellaceae\nASV_198                Enterobacterales                 Yersiniaceae\nASV_1302               Enterobacterales                 Yersiniaceae\nASV_1518               Enterobacterales           Enterobacteriaceae\nASV_3187               Enterobacterales           Enterobacteriaceae\nASV_802                Enterobacterales           Enterobacteriaceae\nASV_969                Enterobacterales           Enterobacteriaceae\nASV_2829               Enterobacterales           Enterobacteriaceae\nASV_1443               Enterobacterales           Enterobacteriaceae\nASV_1523               Enterobacterales           Enterobacteriaceae\nASV_19                 Enterobacterales           Enterobacteriaceae\nASV_24                 Enterobacterales           Enterobacteriaceae\nASV_35                 Enterobacterales           Enterobacteriaceae\nASV_501                Enterobacterales               Morganellaceae\nASV_1093               Enterobacterales               Morganellaceae\nASV_1322               Enterobacterales               Morganellaceae\nASV_1865               Enterobacterales               Morganellaceae\nASV_1344               Enterobacterales               Morganellaceae\nASV_25                    Aeromonadales               Aeromonadaceae\nASV_376                   Aeromonadales               Aeromonadaceae\nASV_51                  Pseudomonadales                Moraxellaceae\nASV_977                 Pseudomonadales                Moraxellaceae\nASV_1375                Pseudomonadales                Moraxellaceae\nASV_1514                Pseudomonadales                Moraxellaceae\nASV_1853                Pseudomonadales                Moraxellaceae\nASV_2591                Pseudomonadales                Moraxellaceae\nASV_6                   Pseudomonadales             Pseudomonadaceae\nASV_33                  Pseudomonadales             Pseudomonadaceae\nASV_16                  Pseudomonadales             Pseudomonadaceae\nASV_1987                Pseudomonadales             Pseudomonadaceae\nASV_2604                Pseudomonadales             Pseudomonadaceae\nASV_160                     KF-JG30-C25                  KF-JG30-C25\nASV_1189                Xanthomonadales             Xanthomonadaceae\nASV_1873                Xanthomonadales             Xanthomonadaceae\nASV_4157                Xanthomonadales             Xanthomonadaceae\nASV_2866                Xanthomonadales             Xanthomonadaceae\nASV_3516                Xanthomonadales             Xanthomonadaceae\nASV_39             Acidiferrobacterales        Acidiferrobacteraceae\nASV_41                  Burkholderiales                       B1-7BS\nASV_68                  Burkholderiales                       B1-7BS\nASV_1042                Burkholderiales               Comamonadaceae\nASV_1246                Burkholderiales               Comamonadaceae\nASV_3880                Burkholderiales               Comamonadaceae\nASV_2297                Burkholderiales               Comamonadaceae\nASV_511                 Burkholderiales             Burkholderiaceae\nASV_1356                Burkholderiales             Burkholderiaceae\nASV_4894                Burkholderiales             Burkholderiaceae\nASV_743                 Burkholderiales               Alcaligenaceae\nASV_1573                Burkholderiales                Neisseriaceae\nASV_746                 Burkholderiales             Oxalobacteraceae\nASV_1089                Burkholderiales             Oxalobacteraceae\nASV_1116                Burkholderiales            Nitrosomonadaceae\nASV_118                 Burkholderiales            Nitrosomonadaceae\nASV_58                      Rhizobiales            Xanthobacteraceae\nASV_62                      Rhizobiales            Xanthobacteraceae\nASV_204                     Rhizobiales             Beijerinckiaceae\nASV_3227                    Rhizobiales             Beijerinckiaceae\nASV_3698                    Rhizobiales             Beijerinckiaceae\nASV_2303                    Rhizobiales            Xanthobacteraceae\nASV_1041                    Rhizobiales                 Rhizobiaceae\nASV_2235                    Rhizobiales                 Rhizobiaceae\nASV_2317                    Rhizobiales                 Rhizobiaceae\nASV_3225               Sphingomonadales            Sphingomonadaceae\nASV_130                 Acetobacterales             Acetobacteraceae\nASV_300                 Acetobacterales             Acetobacteraceae\nASV_692                 Acetobacterales             Acetobacteraceae\nASV_552                 Acetobacterales             Acetobacteraceae\nASV_7                           Sva0485                      Sva0485\nASV_250                         Sva0485                      Sva0485\nASV_103                         Sva0485                      Sva0485\nASV_114                         Sva0485                      Sva0485\nASV_197                         Sva0485                      Sva0485\nASV_36                          Sva0485                      Sva0485\nASV_109                         Sva0485                      Sva0485\nASV_79                          Sva0485                      Sva0485\nASV_61                          Sva0485                      Sva0485\nASV_256                         Sva0485                      Sva0485\nASV_196                         Sva0485                      Sva0485\nASV_321                         Sva0485                      Sva0485\nASV_123              Desulfatiglandales          Desulfatiglandaceae\nASV_105               Desulfobacterales           Desulfosarcinaceae\nASV_162               Desulfobacterales           Desulfosarcinaceae\nASV_166               Desulfobacterales           Desulfosarcinaceae\nASV_395                      uncultured                   uncultured\nASV_3212                   Polyangiales                      BIrii41\nASV_246                          MBNT15                       MBNT15\nASV_8                     Bacteroidales               Prevotellaceae\nASV_15                    Bacteroidales               Prevotellaceae\nASV_12                    Bacteroidales               Prevotellaceae\nASV_11                    Bacteroidales               Prevotellaceae\nASV_71                    Bacteroidales               Prevotellaceae\nASV_568                   Bacteroidales               Prevotellaceae\nASV_487                   Bacteroidales               Prevotellaceae\nASV_689                   Bacteroidales               Prevotellaceae\nASV_892                   Bacteroidales            Dysgonomonadaceae\nASV_584                   Bacteroidales            Dysgonomonadaceae\nASV_362                   Bacteroidales            Dysgonomonadaceae\nASV_1595                  Bacteroidales            Dysgonomonadaceae\nASV_1786                  Bacteroidales            Dysgonomonadaceae\nASV_329                   Bacteroidales            Paludibacteraceae\nASV_2126               Flavobacteriales                Weeksellaceae\nASV_3984               Flavobacteriales                Weeksellaceae\nASV_643               Ignavibacteriales           Ignavibacteriaceae\nASV_557               Ignavibacteriales                         <NA>\nASV_781                    Kryptoniales                        BSV26\nASV_1254              Campylobacterales              Arcobacteraceae\nASV_1032                 Spirochaetales              Spirochaetaceae\nASV_23                       uncultured                   uncultured\nASV_93                       uncultured                   uncultured\nASV_86                       uncultured                   uncultured\nASV_147                      uncultured                   uncultured\nASV_1080                    Subgroup_18                  Subgroup_18\nASV_297                  Calditrichales              Calditrichaceae\nASV_331                    Zixibacteria                 Zixibacteria\nASV_4                 Bifidobacteriales           Bifidobacteriaceae\nASV_230               Bifidobacteriales           Bifidobacteriaceae\nASV_653               Bifidobacteriales           Bifidobacteriaceae\nASV_396               Bifidobacteriales           Bifidobacteriaceae\nASV_21                    Micrococcales               Micrococcaceae\nASV_2616                  Micrococcales               Dermacoccaceae\nASV_3087                  Micrococcales           Intrasporangiaceae\nASV_450                   Micrococcales             Dermabacteraceae\nASV_3338                  Micrococcales               Micrococcaceae\nASV_516             Streptosporangiales              Nocardiopsaceae\nASV_1911            Streptosporangiales              Nocardiopsaceae\nASV_2747            Propionibacteriales         Propionibacteriaceae\nASV_141               Corynebacteriales           Corynebacteriaceae\nASV_784               Corynebacteriales           Corynebacteriaceae\nASV_771               Corynebacteriales           Corynebacteriaceae\nASV_2787              Corynebacteriales           Corynebacteriaceae\nASV_1075              Corynebacteriales                 Nocardiaceae\nASV_2600              Corynebacteriales                 Nocardiaceae\nASV_2301               Streptomycetales            Streptomycetaceae\nASV_345                Coriobacteriales              Eggerthellaceae\nASV_942                Coriobacteriales                 Atopobiaceae\nASV_558                            <NA>                         <NA>\nASV_92                             GIF3                         GIF3\nASV_283                            GIF3                         GIF3\nASV_289                            <NA>                         <NA>\nASV_221                       vadinBA26                    vadinBA26\nASV_434                            GIF9                         GIF9\nASV_239                            GIF9                         GIF9\nASV_341                            GIF9                         GIF9\nASV_148                            S085                         S085\nASV_116                  Anaerolineales              Anaerolineaceae\nASV_747                  Anaerolineales              Anaerolineaceae\nASV_127                  Anaerolineales              Anaerolineaceae\nASV_4434              Thermomicrobiales           Thermomicrobiaceae\nASV_3540                 Solibacterales              Solibacteraceae\nASV_1256              Sericytochromatia            Sericytochromatia\nASV_1264                Fusobacteriales             Leptotrichiaceae\nASV_1124                Oscillospirales              Ruminococcaceae\nASV_2786                Oscillospirales              Ruminococcaceae\nASV_3411                Oscillospirales              Ruminococcaceae\nASV_29   Veillonellales-Selenomonadales              Veillonellaceae\nASV_59   Veillonellales-Selenomonadales             Selenomonadaceae\nASV_60   Veillonellales-Selenomonadales             Selenomonadaceae\nASV_505  Veillonellales-Selenomonadales             Selenomonadaceae\nASV_163  Veillonellales-Selenomonadales             Selenomonadaceae\nASV_2082 Veillonellales-Selenomonadales             Selenomonadaceae\nASV_1751 Veillonellales-Selenomonadales             Selenomonadaceae\nASV_3218 Veillonellales-Selenomonadales             Selenomonadaceae\nASV_317  Veillonellales-Selenomonadales              Veillonellaceae\nASV_1487 Veillonellales-Selenomonadales              Veillonellaceae\nASV_1552 Veillonellales-Selenomonadales              Veillonellaceae\nASV_935  Veillonellales-Selenomonadales              Veillonellaceae\nASV_1370 Veillonellales-Selenomonadales              Veillonellaceae\nASV_1408 Veillonellales-Selenomonadales              Veillonellaceae\nASV_280  Veillonellales-Selenomonadales              Veillonellaceae\nASV_473  Veillonellales-Selenomonadales              Veillonellaceae\nASV_40   Veillonellales-Selenomonadales              Veillonellaceae\nASV_399                Enterobacterales           Enterobacteriaceae\nASV_110              Erysipelotrichales          Erysipelotrichaceae\nASV_201               Entomoplasmatales           Entomoplasmataceae\nASV_383              Erysipelotrichales    Erysipelatoclostridiaceae\nASV_1646             Erysipelotrichales    Erysipelatoclostridiaceae\nASV_227                Staphylococcales            Staphylococcaceae\nASV_278                Staphylococcales            Staphylococcaceae\nASV_668                Staphylococcales            Staphylococcaceae\nASV_1208                     Bacillales                  Bacillaceae\nASV_921                      Bacillales                  Bacillaceae\nASV_1020                Lactobacillales              Enterococcaceae\nASV_14                  Lactobacillales              Enterococcaceae\nASV_249                 Lactobacillales              Enterococcaceae\nASV_453                 Lactobacillales              Enterococcaceae\nASV_4485                Lactobacillales                Vagococcaceae\nASV_22                  Lactobacillales             Lactobacillaceae\nASV_622                 Lactobacillales             Lactobacillaceae\nASV_65                  Lactobacillales             Lactobacillaceae\nASV_2949                Lactobacillales             Lactobacillaceae\nASV_3929                Lactobacillales             Lactobacillaceae\nASV_275                 Lactobacillales             Lactobacillaceae\nASV_451                 Lactobacillales             Lactobacillaceae\nASV_155                 Lactobacillales             Lactobacillaceae\nASV_548                 Lactobacillales             Lactobacillaceae\nASV_3387                Lactobacillales             Lactobacillaceae\nASV_3539                Lactobacillales             Lactobacillaceae\nASV_1062                Lactobacillales             Lactobacillaceae\nASV_2653                Lactobacillales             Lactobacillaceae\nASV_774                 Lactobacillales             Lactobacillaceae\nASV_1081                Lactobacillales             Lactobacillaceae\nASV_1727                Lactobacillales             Lactobacillaceae\nASV_2603                Lactobacillales             Lactobacillaceae\nASV_3016                Lactobacillales             Lactobacillaceae\nASV_222                 Lactobacillales             Lactobacillaceae\nASV_2448                Lactobacillales             Lactobacillaceae\nASV_243                 Lactobacillales             Lactobacillaceae\nASV_470                 Lactobacillales             Leuconostocaceae\nASV_1839                Lactobacillales             Leuconostocaceae\nASV_215                 Lactobacillales              Enterococcaceae\nASV_226                 Lactobacillales             Streptococcaceae\nASV_944                 Lactobacillales             Streptococcaceae\nASV_286                 Lactobacillales             Streptococcaceae\nASV_442                 Lactobacillales             Streptococcaceae\nASV_4817                Lactobacillales              Enterococcaceae\nASV_1163                Lactobacillales              Enterococcaceae\nASV_493                 Lactobacillales              Enterococcaceae\nASV_150                 Lactobacillales              Enterococcaceae\nASV_2                   Lactobacillales              Enterococcaceae\nASV_412                 Lactobacillales              Enterococcaceae\nASV_475                 Lactobacillales              Enterococcaceae\nASV_157                 Lactobacillales              Enterococcaceae\nASV_415                 Lactobacillales              Enterococcaceae\nASV_776                 Lactobacillales              Enterococcaceae\nASV_494                 Lactobacillales              Enterococcaceae\nASV_125                 Lactobacillales              Enterococcaceae\nASV_13                  Lactobacillales              Enterococcaceae\nASV_1                   Lactobacillales              Enterococcaceae\n                                                      Genus\nASV_120                                       Bathyarchaeia\nASV_1769                                         uncultured\nASV_513                                           Sumerlaea\nASV_537                                          uncultured\nASV_2449                                         uncultured\nASV_167                                         Deinococcus\nASV_480                                                TM7a\nASV_2782                                  Saccharimonadales\nASV_1291                                      Parcubacteria\nASV_1967                          Candidatus_Kaiserbacteria\nASV_4990                                               <NA>\nASV_1489                       Candidatus_Magasanikbacteria\nASV_231                                     Aminicenantales\nASV_3                                          Enterobacter\nASV_551                                        Enterobacter\nASV_645                                        Enterobacter\nASV_9                                                  <NA>\nASV_10                                                 <NA>\nASV_20                                                 <NA>\nASV_48                                                 <NA>\nASV_506                                                <NA>\nASV_913                                                <NA>\nASV_2363                                       Enterobacter\nASV_18                                                 <NA>\nASV_85                                                 <NA>\nASV_97                                           Morganella\nASV_798                                          Morganella\nASV_253                                          Morganella\nASV_198                                            Serratia\nASV_1302                                           Serratia\nASV_1518                                         Shimwellia\nASV_3187                                         Raoultella\nASV_802                                          Raoultella\nASV_969                                          Raoultella\nASV_2829                                               <NA>\nASV_1443                                               <NA>\nASV_1523                                               <NA>\nASV_19                                                 <NA>\nASV_24                                 Escherichia-Shigella\nASV_35                                                 <NA>\nASV_501                                             Proteus\nASV_1093                                        Providencia\nASV_1322                                        Providencia\nASV_1865                                        Providencia\nASV_1344                                            Proteus\nASV_25                                            Aeromonas\nASV_376                                           Aeromonas\nASV_51                                        Enhydrobacter\nASV_977                                       Acinetobacter\nASV_1375                                      Acinetobacter\nASV_1514                                      Acinetobacter\nASV_1853                                      Acinetobacter\nASV_2591                                      Acinetobacter\nASV_6                                           Pseudomonas\nASV_33                                          Pseudomonas\nASV_16                                          Pseudomonas\nASV_1987                                        Pseudomonas\nASV_2604                                        Pseudomonas\nASV_160                                         KF-JG30-C25\nASV_1189                                         Luteimonas\nASV_1873                                   Stenotrophomonas\nASV_4157                                   Stenotrophomonas\nASV_2866                                   Stenotrophomonas\nASV_3516                                         Lysobacter\nASV_39                                        Sulfurifustis\nASV_41                                               B1-7BS\nASV_68                                               B1-7BS\nASV_1042                                               <NA>\nASV_1246                                            Delftia\nASV_3880                                         uncultured\nASV_2297                                       Schlegelella\nASV_511          Burkholderia-Caballeronia-Paraburkholderia\nASV_1356                                          Ralstonia\nASV_4894                                          Ralstonia\nASV_743                                                <NA>\nASV_1573                                         uncultured\nASV_746                                            Massilia\nASV_1089                                           Massilia\nASV_1116                                          Ellin6067\nASV_118                                                MND1\nASV_58                                       Bradyrhizobium\nASV_62                                       Bradyrhizobium\nASV_204                      Methylobacterium-Methylorubrum\nASV_3227                     Methylobacterium-Methylorubrum\nASV_3698                     Methylobacterium-Methylorubrum\nASV_2303                                       Pseudolabrys\nASV_1041                                      Mesorhizobium\nASV_2235                                            Ensifer\nASV_2317 Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\nASV_3225                                        Sphingobium\nASV_130                                         Acetobacter\nASV_300                                         Acetobacter\nASV_692                                         Acetobacter\nASV_552                                         Acetobacter\nASV_7                                               Sva0485\nASV_250                                             Sva0485\nASV_103                                             Sva0485\nASV_114                                             Sva0485\nASV_197                                             Sva0485\nASV_36                                              Sva0485\nASV_109                                             Sva0485\nASV_79                                              Sva0485\nASV_61                                              Sva0485\nASV_256                                             Sva0485\nASV_196                                             Sva0485\nASV_321                                             Sva0485\nASV_123                                      Desulfatiglans\nASV_105                              Sva0081_sediment_group\nASV_162                              Sva0081_sediment_group\nASV_166                              Sva0081_sediment_group\nASV_395                                          uncultured\nASV_3212                                            BIrii41\nASV_246                                              MBNT15\nASV_8                                            Prevotella\nASV_15                                           Prevotella\nASV_12                                           Prevotella\nASV_11                                           Prevotella\nASV_71                                           Prevotella\nASV_568                                          Prevotella\nASV_487                                          Prevotella\nASV_689                                          Prevotella\nASV_892                                        Dysgonomonas\nASV_584                                        Dysgonomonas\nASV_362                                        Dysgonomonas\nASV_1595                                               <NA>\nASV_1786                                               <NA>\nASV_329                                                <NA>\nASV_2126                                    Cloacibacterium\nASV_3984                                         uncultured\nASV_643                                     Ignavibacterium\nASV_557                                                <NA>\nASV_781                                               BSV26\nASV_1254                                         Arcobacter\nASV_1032                                        Spirochaeta\nASV_23                                           uncultured\nASV_93                                           uncultured\nASV_86                                           uncultured\nASV_147                                          uncultured\nASV_1080                                        Subgroup_18\nASV_297                                         Calorithrix\nASV_331                                        Zixibacteria\nASV_4                                       Bifidobacterium\nASV_230                                     Bifidobacterium\nASV_653                                     Bifidobacterium\nASV_396                                     Bifidobacterium\nASV_21                                          Micrococcus\nASV_2616                                         Kytococcus\nASV_3087                                               <NA>\nASV_450                                     Brachybacterium\nASV_3338                                   Paenarthrobacter\nASV_516                                        Nocardiopsis\nASV_1911                                       Nocardiopsis\nASV_2747                                      Cutibacterium\nASV_141                                     Corynebacterium\nASV_784                                     Corynebacterium\nASV_771                                     Corynebacterium\nASV_2787                                    Corynebacterium\nASV_1075                                        Rhodococcus\nASV_2600                                        Rhodococcus\nASV_2301                                       Streptomyces\nASV_345                                          uncultured\nASV_942                                           Olsenella\nASV_558                                                <NA>\nASV_92                                                 GIF3\nASV_283                                                GIF3\nASV_289                                                <NA>\nASV_221                                           vadinBA26\nASV_434                                                GIF9\nASV_239                                                GIF9\nASV_341                                                GIF9\nASV_148                                                S085\nASV_116                                          uncultured\nASV_747                                          uncultured\nASV_127                                          uncultured\nASV_4434                                        Nitrolancea\nASV_3540                              Candidatus_Solibacter\nASV_1256                                  Sericytochromatia\nASV_1264                                       Leptotrichia\nASV_1124                                   Faecalibacterium\nASV_2786                                   Faecalibacterium\nASV_3411                                   Faecalibacterium\nASV_29                                           uncultured\nASV_59                                           Pectinatus\nASV_60                                           Pectinatus\nASV_505                                          Pectinatus\nASV_163                                          Pectinatus\nASV_2082                                         Pectinatus\nASV_1751                                         Pectinatus\nASV_3218                                         Pectinatus\nASV_317                                         Megasphaera\nASV_1487                                        Megasphaera\nASV_1552                                        Megasphaera\nASV_935                                           Dialister\nASV_1370                                         uncultured\nASV_1408                                         uncultured\nASV_280                                          uncultured\nASV_473                                          uncultured\nASV_40                                           uncultured\nASV_399                                                <NA>\nASV_110                                             ZOR0006\nASV_201                                        Entomoplasma\nASV_383                                      Asteroleplasma\nASV_1646                                            UCG-004\nASV_227                                      Staphylococcus\nASV_278                                      Staphylococcus\nASV_668                                      Staphylococcus\nASV_1208                                           Bacillus\nASV_921                                      Oceanobacillus\nASV_1020                                       Enterococcus\nASV_14                                         Enterococcus\nASV_249                                        Enterococcus\nASV_453                                        Enterococcus\nASV_4485                                         Vagococcus\nASV_22                                        Lactobacillus\nASV_622                                       Lactobacillus\nASV_65                                        Lactobacillus\nASV_2949                                      Lactobacillus\nASV_3929                                      Lactobacillus\nASV_275                                       Lactobacillus\nASV_451                                       Lactobacillus\nASV_155                                       Lactobacillus\nASV_548                                       Lactobacillus\nASV_3387                                      Lactobacillus\nASV_3539                                      Lactobacillus\nASV_1062                                      Lactobacillus\nASV_2653                                        Pediococcus\nASV_774                                                <NA>\nASV_1081                                      Lactobacillus\nASV_1727                                      Lactobacillus\nASV_2603                                      Lactobacillus\nASV_3016                                      Lactobacillus\nASV_222                                       Lactobacillus\nASV_2448                                      Lactobacillus\nASV_243                                       Lactobacillus\nASV_470                                           Weissella\nASV_1839                                        Leuconostoc\nASV_215                                        Enterococcus\nASV_226                                       Streptococcus\nASV_944                                       Streptococcus\nASV_286                                         Lactococcus\nASV_442                                         Lactococcus\nASV_4817                                       Enterococcus\nASV_1163                                       Enterococcus\nASV_493                                        Enterococcus\nASV_150                                        Enterococcus\nASV_2                                          Enterococcus\nASV_412                                        Enterococcus\nASV_475                                        Enterococcus\nASV_157                                        Enterococcus\nASV_415                                        Enterococcus\nASV_776                                        Enterococcus\nASV_494                                        Enterococcus\nASV_125                                        Enterococcus\nASV_13                                         Enterococcus\nASV_1                                          Enterococcus\n                                    Species\nASV_120                                <NA>\nASV_1769                               <NA>\nASV_513                 uncultured_organism\nASV_537                                <NA>\nASV_2449               uncultured_bacterium\nASV_167                     Deinococcus_sp.\nASV_480                uncultured_bacterium\nASV_2782                               <NA>\nASV_1291                               <NA>\nASV_1967               uncultured_bacterium\nASV_4990                               <NA>\nASV_1489               uncultured_bacterium\nASV_231            uncultured_Aminicenantes\nASV_3                                  <NA>\nASV_551                                <NA>\nASV_645                                <NA>\nASV_9                                  <NA>\nASV_10                                 <NA>\nASV_20                                 <NA>\nASV_48                                 <NA>\nASV_506                                <NA>\nASV_913                                <NA>\nASV_2363                               <NA>\nASV_18                                 <NA>\nASV_85                                 <NA>\nASV_97                                 <NA>\nASV_798                                <NA>\nASV_253                                <NA>\nASV_198                                <NA>\nASV_1302                               <NA>\nASV_1518             Cronobacter_muytjensii\nASV_3187                               <NA>\nASV_802                                <NA>\nASV_969                                <NA>\nASV_2829                               <NA>\nASV_1443                               <NA>\nASV_1523                               <NA>\nASV_19                                 <NA>\nASV_24                   Citrobacter_koseri\nASV_35                                 <NA>\nASV_501                                <NA>\nASV_1093                               <NA>\nASV_1322                               <NA>\nASV_1865                               <NA>\nASV_1344                               <NA>\nASV_25                                 <NA>\nASV_376                                <NA>\nASV_51                                 <NA>\nASV_977              Acinetobacter_ursingii\nASV_1375             Acinetobacter_ursingii\nASV_1514           Acinetobacter_schindleri\nASV_1853           Acinetobacter_schindleri\nASV_2591           Acinetobacter_schindleri\nASV_6                                  <NA>\nASV_33                                 <NA>\nASV_16                                 <NA>\nASV_1987        Pseudomonas_psychrotolerans\nASV_2604                  Pseudomonas_fragi\nASV_160                 uncultured_organism\nASV_1189                               <NA>\nASV_1873                               <NA>\nASV_4157                               <NA>\nASV_2866                               <NA>\nASV_3516                               <NA>\nASV_39           uncultured_proteobacterium\nASV_41                 uncultured_bacterium\nASV_68                 uncultured_bacterium\nASV_1042                               <NA>\nASV_1246                               <NA>\nASV_3880                     Leptothrix_sp.\nASV_2297                               <NA>\nASV_511                                <NA>\nASV_1356                               <NA>\nASV_4894                Ralstonia_insidiosa\nASV_743                                <NA>\nASV_1573               uncultured_bacterium\nASV_746                                <NA>\nASV_1089                               <NA>\nASV_1116                               <NA>\nASV_118                uncultured_bacterium\nASV_58                                 <NA>\nASV_62                                 <NA>\nASV_204                                <NA>\nASV_3227                               <NA>\nASV_3698        Methylobacterium_isbiliense\nASV_2303                               <NA>\nASV_1041                               <NA>\nASV_2235                               <NA>\nASV_2317                               <NA>\nASV_3225             Sphingobium_yanoikuyae\nASV_130                                <NA>\nASV_300                                <NA>\nASV_692                                <NA>\nASV_552                                <NA>\nASV_7             uncultured_Spirochaetales\nASV_250           uncultured_Spirochaetales\nASV_103                                <NA>\nASV_114                                <NA>\nASV_197                                <NA>\nASV_36                     uncultured_delta\nASV_109                    uncultured_delta\nASV_79                                 <NA>\nASV_61                                 <NA>\nASV_256                    uncultured_delta\nASV_196                    uncultured_delta\nASV_321                    uncultured_delta\nASV_123                                <NA>\nASV_105                                <NA>\nASV_162                                <NA>\nASV_166                                <NA>\nASV_395                    uncultured_delta\nASV_3212                               <NA>\nASV_246                    uncultured_delta\nASV_8                          unidentified\nASV_15                         unidentified\nASV_12                         unidentified\nASV_11                         unidentified\nASV_71                         unidentified\nASV_568                        unidentified\nASV_487                                <NA>\nASV_689                                <NA>\nASV_892                                <NA>\nASV_584     Dysgonomonas_capnocytophagoides\nASV_362                                <NA>\nASV_1595                               <NA>\nASV_1786                               <NA>\nASV_329                                <NA>\nASV_2126                               <NA>\nASV_3984               uncultured_bacterium\nASV_643                uncultured_bacterium\nASV_557                                <NA>\nASV_781                 uncultured_Chlorobi\nASV_1254           Arcobacter_cryaerophilus\nASV_1032               uncultured_bacterium\nASV_23               uncultured_Nitrospirae\nASV_93               uncultured_Nitrospirae\nASV_86                uncultured_prokaryote\nASV_147               uncultured_prokaryote\nASV_1080                               <NA>\nASV_297                uncultured_bacterium\nASV_331                uncultured_bacterium\nASV_4                                  <NA>\nASV_230                                <NA>\nASV_653            Bifidobacterium_animalis\nASV_396                                <NA>\nASV_21                                 <NA>\nASV_2616                               <NA>\nASV_3087                               <NA>\nASV_450                                <NA>\nASV_3338                               <NA>\nASV_516                                <NA>\nASV_1911                               <NA>\nASV_2747                               <NA>\nASV_141                                <NA>\nASV_784  Corynebacterium_tuberculostearicum\nASV_771                                <NA>\nASV_2787    Corynebacterium_lipophiloflavum\nASV_1075     Rhodococcus_corynebacterioides\nASV_2600                               <NA>\nASV_2301                               <NA>\nASV_345                                <NA>\nASV_942                       Olsenella_sp.\nASV_558                                <NA>\nASV_92                 uncultured_bacterium\nASV_283                uncultured_bacterium\nASV_289                                <NA>\nASV_221                uncultured_bacterium\nASV_434                uncultured_bacterium\nASV_239              uncultured_Chloroflexi\nASV_341                uncultured_bacterium\nASV_148                uncultured_bacterium\nASV_116          uncultured_Anaerolineaceae\nASV_747              uncultured_Chloroflexi\nASV_127                 uncultured_Chlorobi\nASV_4434               uncultured_bacterium\nASV_3540                  uncultured_forest\nASV_1256               uncultured_bacterium\nASV_1264                               <NA>\nASV_1124                               <NA>\nASV_2786                               <NA>\nASV_3411                               <NA>\nASV_29                 uncultured_bacterium\nASV_59           Pectinatus_cerevisiiphilus\nASV_60           Pectinatus_cerevisiiphilus\nASV_505          Pectinatus_cerevisiiphilus\nASV_163          Pectinatus_cerevisiiphilus\nASV_2082         Pectinatus_cerevisiiphilus\nASV_1751         Pectinatus_cerevisiiphilus\nASV_3218         Pectinatus_cerevisiiphilus\nASV_317                uncultured_bacterium\nASV_1487               uncultured_bacterium\nASV_1552               uncultured_bacterium\nASV_935                uncultured_bacterium\nASV_1370               uncultured_bacterium\nASV_1408               uncultured_bacterium\nASV_280                uncultured_bacterium\nASV_473                uncultured_bacterium\nASV_40                 uncultured_bacterium\nASV_399                                <NA>\nASV_110                Firmicutes_bacterium\nASV_201               Entomoplasma_somnilux\nASV_383                uncultured_bacterium\nASV_1646                               <NA>\nASV_227         Staphylococcaceae_bacterium\nASV_278                                <NA>\nASV_668                                <NA>\nASV_1208                    Bacillus_kochii\nASV_921               Compostibacillus_humi\nASV_1020                               <NA>\nASV_14                                 <NA>\nASV_249                                <NA>\nASV_453                                <NA>\nASV_4485                               <NA>\nASV_22              Lactobacillus_ghanensis\nASV_622             Lactobacillus_ghanensis\nASV_65              Lactobacillus_kimchicus\nASV_2949            Lactobacillus_hilgardii\nASV_3929            Lactobacillus_kimchicus\nASV_275             Lactobacillus_kimchicus\nASV_451             Lactobacillus_kimchicus\nASV_155       Lactobacillus_paracollinoides\nASV_548                                <NA>\nASV_3387                               <NA>\nASV_3539                               <NA>\nASV_1062       Lactobacillus_vaccinostercus\nASV_2653           Pediococcus_argentinicus\nASV_774                                <NA>\nASV_1081            Lactobacillus_camelliae\nASV_1727            Lactobacillus_camelliae\nASV_2603                               <NA>\nASV_3016            Lactobacillus_pantheris\nASV_222                                <NA>\nASV_2448          Lactobacillus_delbrueckii\nASV_243     Lactobacillus_ginsenosidimutans\nASV_470         Weissella_paramesenteroides\nASV_1839                               <NA>\nASV_215                                <NA>\nASV_226                                <NA>\nASV_944                                <NA>\nASV_286                Lactococcus_garvieae\nASV_442                  Lactococcus_lactis\nASV_4817                               <NA>\nASV_1163                               <NA>\nASV_493                                <NA>\nASV_150                                <NA>\nASV_2                                  <NA>\nASV_412                                <NA>\nASV_475                                <NA>\nASV_157                                <NA>\nASV_415                                <NA>\nASV_776                                <NA>\nASV_494                                <NA>\nASV_125                                <NA>\nASV_13                                 <NA>\nASV_1                  Enterococcus_mundtii\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshared_family <- unique(shared_taxonomy$Family[!is.na(shared_taxonomy$Family)])\nprint(shared_family)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Bathyarchaeia\"                \"Isosphaeraceae\"              \n [3] \"Sumerlaeaceae\"                \"Pedosphaeraceae\"             \n [5] \"Deinococcaceae\"               \"Saccharimonadaceae\"          \n [7] \"Saccharimonadales\"            \"Parcubacteria\"               \n [9] \"Candidatus_Kaiserbacteria\"    \"Candidatus_Magasanikbacteria\"\n[11] \"Aminicenantales\"              \"Enterobacteriaceae\"          \n[13] \"Morganellaceae\"               \"Yersiniaceae\"                \n[15] \"Aeromonadaceae\"               \"Moraxellaceae\"               \n[17] \"Pseudomonadaceae\"             \"KF-JG30-C25\"                 \n[19] \"Xanthomonadaceae\"             \"Acidiferrobacteraceae\"       \n[21] \"B1-7BS\"                       \"Comamonadaceae\"              \n[23] \"Burkholderiaceae\"             \"Alcaligenaceae\"              \n[25] \"Neisseriaceae\"                \"Oxalobacteraceae\"            \n[27] \"Nitrosomonadaceae\"            \"Xanthobacteraceae\"           \n[29] \"Beijerinckiaceae\"             \"Rhizobiaceae\"                \n[31] \"Sphingomonadaceae\"            \"Acetobacteraceae\"            \n[33] \"Sva0485\"                      \"Desulfatiglandaceae\"         \n[35] \"Desulfosarcinaceae\"           \"uncultured\"                  \n[37] \"BIrii41\"                      \"MBNT15\"                      \n[39] \"Prevotellaceae\"               \"Dysgonomonadaceae\"           \n[41] \"Paludibacteraceae\"            \"Weeksellaceae\"               \n[43] \"Ignavibacteriaceae\"           \"BSV26\"                       \n[45] \"Arcobacteraceae\"              \"Spirochaetaceae\"             \n[47] \"Subgroup_18\"                  \"Calditrichaceae\"             \n[49] \"Zixibacteria\"                 \"Bifidobacteriaceae\"          \n[51] \"Micrococcaceae\"               \"Dermacoccaceae\"              \n[53] \"Intrasporangiaceae\"           \"Dermabacteraceae\"            \n[55] \"Nocardiopsaceae\"              \"Propionibacteriaceae\"        \n[57] \"Corynebacteriaceae\"           \"Nocardiaceae\"                \n[59] \"Streptomycetaceae\"            \"Eggerthellaceae\"             \n[61] \"Atopobiaceae\"                 \"GIF3\"                        \n[63] \"vadinBA26\"                    \"GIF9\"                        \n[65] \"S085\"                         \"Anaerolineaceae\"             \n[67] \"Thermomicrobiaceae\"           \"Solibacteraceae\"             \n[69] \"Sericytochromatia\"            \"Leptotrichiaceae\"            \n[71] \"Ruminococcaceae\"              \"Veillonellaceae\"             \n[73] \"Selenomonadaceae\"             \"Erysipelotrichaceae\"         \n[75] \"Entomoplasmataceae\"           \"Erysipelatoclostridiaceae\"   \n[77] \"Staphylococcaceae\"            \"Bacillaceae\"                 \n[79] \"Enterococcaceae\"              \"Vagococcaceae\"               \n[81] \"Lactobacillaceae\"             \"Leuconostocaceae\"            \n[83] \"Streptococcaceae\"            \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshared_phyla <- unique(shared_taxonomy$Phylum[!is.na(shared_taxonomy$Phylum)])\nprint(shared_phyla)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Crenarchaeota\"     \"Planctomycetota\"   \"Sumerlaeota\"      \n [4] \"Verrucomicrobiota\" \"Deinococcota\"      \"Patescibacteria\"  \n [7] \"Acidobacteriota\"   \"Proteobacteria\"    \"Sva0485\"          \n[10] \"Desulfobacterota\"  \"Myxococcota\"       \"MBNT15\"           \n[13] \"Bacteroidota\"      \"Campilobacterota\"  \"Spirochaetota\"    \n[16] \"Nitrospirota\"      \"Calditrichota\"     \"Zixibacteria\"     \n[19] \"Actinobacteriota\"  \"Chloroflexi\"       \"Cyanobacteria\"    \n[22] \"Fusobacteriota\"    \"Firmicutes\"       \n```\n\n\n:::\n:::\n\n\n\n\n\n## 07. Relative abundance of core asv\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter\nphyseq_shared <- prune_taxa(shared_asvs, physeq)\nhead(otu_table(physeq_shared))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOTU Table:          [6 taxa and 50 samples]\n                     taxa are rows\n         S1A015 S1A1530 S1A3050 S1A5075 S1B07 S1B2230 S1B3040 S1B6575 S2A1727\nASV_120      11     286     140     200    55     242     111     119     383\nASV_1769     14       0       0      15    29      31      20       5      22\nASV_513      37     115      81     105    32      13       2       8      41\nASV_537      78      52      17       7   155      20       0       2      21\nASV_2449      9       3       4      18    20      15      10      11      10\nASV_167     106     107      55      66   262     115     151      68      65\n         S2A3545 S2A5060 S2A515 S2B07 S2B1522 S2B3040 S2B5565 S3A07 S3A1522\nASV_120       67     126    154    91     521     104      78   133      35\nASV_1769       8      15      6    16       0      23      10    29       8\nASV_513      106      48     32    90      34      21      19    31       2\nASV_537       67      38     22   123      20      39      10    69       0\nASV_2449      11      22     12     9      13       6       8     9      13\nASV_167      128     164     65    91      72     133      89   113     122\n         S3A3040 S3A6070 S3B2030 S3B3545 S3B515 S3B6070 S4B07 S4B1522 S4B3040\nASV_120       96      57     179     143    105     311    35     212     292\nASV_1769      21       7      16      15     15      59    18       3      17\nASV_513       19       0      14      46      9      18   138      67      75\nASV_537       39       0       0       4     18      21    95      13       8\nASV_2449      15       6      27      17     12      40    14       0      12\nASV_167       59     120     183      98     80     346   141      83     125\n         S4B5565 S5A07 S5A1522 S5A3040 S5A5565 S5B07 S5B1522 S5B3040 S5B5060\nASV_120      324     0       0     166     203     4     139     760     525\nASV_1769      14    33      33      29      10    20      15      27      13\nASV_513       64     5      50      98       8    64      11      73       8\nASV_537       21    38      15      26       0    66      40      79      10\nASV_2449       2    42       7      11       0    10      10      17      15\nASV_167       90   262     165     222      68   189     112     137      96\n         S6A07 S6A1522 S6A3040 S6B07 S6B1522 S6B3040 S7A07 S7A1522 S7A3040\nASV_120      9     205     129     0      69     242     6     208     243\nASV_1769    18       0      29    75      34      19    24       9      16\nASV_513     21     122     109     0       0      35    25      85     142\nASV_537    173      92       0   208      74      98   284      22      22\nASV_2449    11       6      21    24      14      19    11       3      25\nASV_167     72      88     138   201     167     116   136      71     115\n         S7A5060 S7B07 S7B1522 S7B3040 S7B5060\nASV_120      121     3      82      50      99\nASV_1769       0     9      30      17      15\nASV_513       12    53     130     161      70\nASV_537        6    95      77      28      20\nASV_2449       5    18      10      16      24\nASV_167       28   110     107     151     151\n```\n\n\n:::\n\n```{.r .cell-code}\n# rel abundance\nphyseq_rel <- transform_sample_counts(physeq_shared, function(x){x / sum(x)})\nhead(otu_table(physeq_shared))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOTU Table:          [6 taxa and 50 samples]\n                     taxa are rows\n         S1A015 S1A1530 S1A3050 S1A5075 S1B07 S1B2230 S1B3040 S1B6575 S2A1727\nASV_120      11     286     140     200    55     242     111     119     383\nASV_1769     14       0       0      15    29      31      20       5      22\nASV_513      37     115      81     105    32      13       2       8      41\nASV_537      78      52      17       7   155      20       0       2      21\nASV_2449      9       3       4      18    20      15      10      11      10\nASV_167     106     107      55      66   262     115     151      68      65\n         S2A3545 S2A5060 S2A515 S2B07 S2B1522 S2B3040 S2B5565 S3A07 S3A1522\nASV_120       67     126    154    91     521     104      78   133      35\nASV_1769       8      15      6    16       0      23      10    29       8\nASV_513      106      48     32    90      34      21      19    31       2\nASV_537       67      38     22   123      20      39      10    69       0\nASV_2449      11      22     12     9      13       6       8     9      13\nASV_167      128     164     65    91      72     133      89   113     122\n         S3A3040 S3A6070 S3B2030 S3B3545 S3B515 S3B6070 S4B07 S4B1522 S4B3040\nASV_120       96      57     179     143    105     311    35     212     292\nASV_1769      21       7      16      15     15      59    18       3      17\nASV_513       19       0      14      46      9      18   138      67      75\nASV_537       39       0       0       4     18      21    95      13       8\nASV_2449      15       6      27      17     12      40    14       0      12\nASV_167       59     120     183      98     80     346   141      83     125\n         S4B5565 S5A07 S5A1522 S5A3040 S5A5565 S5B07 S5B1522 S5B3040 S5B5060\nASV_120      324     0       0     166     203     4     139     760     525\nASV_1769      14    33      33      29      10    20      15      27      13\nASV_513       64     5      50      98       8    64      11      73       8\nASV_537       21    38      15      26       0    66      40      79      10\nASV_2449       2    42       7      11       0    10      10      17      15\nASV_167       90   262     165     222      68   189     112     137      96\n         S6A07 S6A1522 S6A3040 S6B07 S6B1522 S6B3040 S7A07 S7A1522 S7A3040\nASV_120      9     205     129     0      69     242     6     208     243\nASV_1769    18       0      29    75      34      19    24       9      16\nASV_513     21     122     109     0       0      35    25      85     142\nASV_537    173      92       0   208      74      98   284      22      22\nASV_2449    11       6      21    24      14      19    11       3      25\nASV_167     72      88     138   201     167     116   136      71     115\n         S7A5060 S7B07 S7B1522 S7B3040 S7B5060\nASV_120      121     3      82      50      99\nASV_1769       0     9      30      17      15\nASV_513       12    53     130     161      70\nASV_537        6    95      77      28      20\nASV_2449       5    18      10      16      24\nASV_167       28   110     107     151     151\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Aggregate data by Location\nphyseq_agg <- merge_samples(physeq_rel, \"Location\")\n\n# Convert to relative abundance\nphyseq_agg_rel <- transform_sample_counts(physeq_agg, function(x) x / sum(x))\n\n# Location names\nlocations <- unique(sample_data(physeq_rel)$Location)\nsample_names(physeq_agg_rel) <- locations\nsample_data(physeq_agg_rel)$Location <- factor(locations, levels = locations)\n```\n:::\n\n\n\n\n\nBarplot of core by Phylum level\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Numbers of ASV\nn_asvs <- length(unique(tax_table(physeq_agg_rel)[, \"Phylum\"]))\n\n# color palette\nbase_colors <- c(\n  \"#4B0082\",\n  \"cyan4\",\n  \"#FF1493\",  \n  \"#FFD700\",  \n  \"#8A2BE6\",  \n  \"#74F3D3FF\",\n  \"#F3E33ABA\",\n  \"#AC9ECEFF\",\n  \"#6EC5ABFF\",\n  \"#8D3CA3\")\ncustom_palette <- colorRampPalette(base_colors)(n_asvs)\n\n# Create the bar plot with facet by Mangrove_type\nbarplot_core <- phyloseq::plot_bar(physeq_agg_rel, fill = \"Phylum\") +\n    geom_bar(aes(color = Phylum, fill = Phylum), \n               stat = \"identity\", position = \"stack\") +\n    labs(x = \"\", y = \"Relative Abundance\", element_text(size = 12)) +\n    facet_wrap(~ Location, scales = \"free_x\", nrow = 1) +\n    scale_fill_manual(values = custom_palette) +\n    scale_color_manual(values = custom_palette) +\n  theme_minimal() +\n  theme(axis.text = element_text(colour = \"black\", size = 10),\n        axis.title = element_text(colour = \"black\", size = 10),\n        legend.text = element_text(size = 10),\n        legend.title = element_text(size = 11),\n        legend.position = \"bottom\",\n        axis.text.x = element_text(size = 10, angle = 0, \n                        hjust = 0.5, color = \"black\"),\n      axis.text.y = element_text(size = 10, color = \"black\"),\n      strip.text = element_text(size = 12, \n                                color = \"black\"),\n      panel.background = element_blank())\n\nbarplot_core\n```\n\n::: {.cell-output-display}\n![](03.4.Coremicrobiome_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npdf(\"Figures/interior_mangroves/rel_abun_core.pdf\")\nbarplot_core\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nquartz_off_screen \n                2 \n```\n\n\n:::\n:::\n\n\n\n\n\n### 07.2 Ampvis heatmap\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create and extract otu table\notu_table_ampvis <- data.frame(OTU = rownames(phyloseq::otu_table(physeq_shared)@.Data),\n                                 phyloseq::otu_table(physeq_shared)@.Data,\n                                 phyloseq::tax_table(physeq_shared)@.Data,\n                                 check.names = FALSE)\n\n# Metadata\nmeta_data_ampvis <- data.frame(phyloseq::sample_data(physeq_shared),\n                                 check.names = FALSE)\n\n# change index by SampleID\nmeta_data_ampvis <- meta_data_ampvis %>% rownames_to_column(var = \"SampleID\")\n\n# ampvis object\nav2 <- amp_load(otu_table_ampvis, meta_data_ampvis)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nampv_heatmap_abundances_phylum_core <- amp_heatmap(av2,\n            group_by = \"Location\",\n            #facet_by = \"Location\",\n            plot_values = TRUE,\n            tax_show = 23,\n            showRemainingTaxa = TRUE,\n            tax_aggregate = \"Phylum\",\n            plot_colorscale = \"log10\",\n            plot_values_size = 3,\n            min_abundance = 0.001,\n            round = 2,\n            color_vector = c(\"#703AF5\",\"#DADAEB\" ,\"#75157a\")) + #\"#DADAEB\"\n  theme(axis.text.x = element_text(angle = 0, size=11, \n                                   vjust = 1, hjust = 0.5),\n        axis.text.y = element_text(size=12),\n        legend.position=\"right\")\n\nampv_heatmap_abundances_phylum_core\n```\n\n::: {.cell-output-display}\n![](03.4.Coremicrobiome_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# save\nggsave(\"Figures/interior_mangroves/Core_RelativeAbundance_heatmap.pdf\",\n       ampv_heatmap_abundances_phylum_core, bg='transparent', \n       width = 4, height = 5.5)\n```\n:::\n\n\n\n\n\n### 07.3 Extract relative abundance info\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\notu_rel_df <- psmelt(physeq_agg_rel)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in psmelt(physeq_agg_rel): The sample variables: \nSample\n have been renamed to: \nsample_Sample\nto avoid conflicts with special phyloseq plot attribute names.\n```\n\n\n:::\n\n```{.r .cell-code}\notu_rel_df_agg <- aggregate(Abundance ~ Sample + Phylum, data = otu_rel_df, sum)\nprint(otu_rel_df_agg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Sample            Phylum Abundance\n1       Fossil Lagoon   Acidobacteriota  0.003576\n2      Miguelito Dike   Acidobacteriota  0.002371\n3  Reforma Waterfalls   Acidobacteriota  0.002469\n4       Fossil Lagoon  Actinobacteriota  0.079636\n5      Miguelito Dike  Actinobacteriota  0.075970\n6  Reforma Waterfalls  Actinobacteriota  0.084031\n7       Fossil Lagoon      Bacteroidota  0.102028\n8      Miguelito Dike      Bacteroidota  0.097611\n9  Reforma Waterfalls      Bacteroidota  0.106167\n10      Fossil Lagoon     Calditrichota  0.001953\n11     Miguelito Dike     Calditrichota  0.002084\n12 Reforma Waterfalls     Calditrichota  0.001117\n13      Fossil Lagoon  Campilobacterota  0.000440\n14     Miguelito Dike  Campilobacterota  0.000389\n15 Reforma Waterfalls  Campilobacterota  0.000410\n16      Fossil Lagoon       Chloroflexi  0.024488\n17     Miguelito Dike       Chloroflexi  0.029684\n18 Reforma Waterfalls       Chloroflexi  0.021331\n19      Fossil Lagoon     Crenarchaeota  0.004505\n20     Miguelito Dike     Crenarchaeota  0.002274\n21 Reforma Waterfalls     Crenarchaeota  0.003313\n22      Fossil Lagoon     Cyanobacteria  0.000372\n23     Miguelito Dike     Cyanobacteria  0.000457\n24 Reforma Waterfalls     Cyanobacteria  0.000450\n25      Fossil Lagoon      Deinococcota  0.002327\n26     Miguelito Dike      Deinococcota  0.002014\n27 Reforma Waterfalls      Deinococcota  0.002149\n28      Fossil Lagoon  Desulfobacterota  0.014731\n29     Miguelito Dike  Desulfobacterota  0.017633\n30 Reforma Waterfalls  Desulfobacterota  0.007691\n31      Fossil Lagoon        Firmicutes  0.332269\n32     Miguelito Dike        Firmicutes  0.331807\n33 Reforma Waterfalls        Firmicutes  0.338907\n34      Fossil Lagoon    Fusobacteriota  0.000395\n35     Miguelito Dike    Fusobacteriota  0.000377\n36 Reforma Waterfalls    Fusobacteriota  0.000478\n37      Fossil Lagoon            MBNT15  0.002557\n38     Miguelito Dike            MBNT15  0.001361\n39 Reforma Waterfalls            MBNT15  0.001685\n40      Fossil Lagoon       Myxococcota  0.000173\n41     Miguelito Dike       Myxococcota  0.000161\n42 Reforma Waterfalls       Myxococcota  0.000192\n43      Fossil Lagoon      Nitrospirota  0.023630\n44     Miguelito Dike      Nitrospirota  0.040794\n45 Reforma Waterfalls      Nitrospirota  0.012895\n46      Fossil Lagoon   Patescibacteria  0.002097\n47     Miguelito Dike   Patescibacteria  0.002273\n48 Reforma Waterfalls   Patescibacteria  0.002529\n49      Fossil Lagoon   Planctomycetota  0.000314\n50     Miguelito Dike   Planctomycetota  0.000321\n51 Reforma Waterfalls   Planctomycetota  0.000288\n52      Fossil Lagoon    Proteobacteria  0.321910\n53     Miguelito Dike    Proteobacteria  0.314589\n54 Reforma Waterfalls    Proteobacteria  0.337182\n55      Fossil Lagoon     Spirochaetota  0.000696\n56     Miguelito Dike     Spirochaetota  0.000646\n57 Reforma Waterfalls     Spirochaetota  0.000490\n58      Fossil Lagoon       Sumerlaeota  0.000977\n59     Miguelito Dike       Sumerlaeota  0.001240\n60 Reforma Waterfalls       Sumerlaeota  0.000796\n61      Fossil Lagoon           Sva0485  0.079575\n62     Miguelito Dike           Sva0485  0.071257\n63 Reforma Waterfalls           Sva0485  0.073804\n64      Fossil Lagoon Verrucomicrobiota  0.000753\n65     Miguelito Dike Verrucomicrobiota  0.001750\n66 Reforma Waterfalls Verrucomicrobiota  0.000884\n67      Fossil Lagoon      Zixibacteria  0.000599\n68     Miguelito Dike      Zixibacteria  0.002938\n69 Reforma Waterfalls      Zixibacteria  0.000743\n```\n\n\n:::\n:::\n\n\n\n\n\n## Save rds core plot\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(upset_plot, \"rds/interior_mangroves/upset_plot.rds\")\n```\n:::\n",
    "supporting": [
      "03.4.Coremicrobiome_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
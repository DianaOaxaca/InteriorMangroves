[
  {
    "objectID": "A_InteriorCoastalCompare.html",
    "href": "A_InteriorCoastalCompare.html",
    "title": "Interior and coastal mangroves compare",
    "section": "",
    "text": "This section focuses on comparisons between inland and coastal mangroves in order to answer the following questions:\nHow are coastal and inland mangroves similar?\nHow are coastal and inland mangroves similar, considering their depth?\nHow are inland mangroves similar to a degraded coastal mangrove?",
    "crumbs": [
      "Interior and coastal mangroves compare"
    ]
  },
  {
    "objectID": "03.1.RelativeAbundances.html",
    "href": "03.1.RelativeAbundances.html",
    "title": "Relative Abundances",
    "section": "",
    "text": "library(phyloseq)\nlibrary(qiime2R)\nlibrary(microbiome)\nlibrary(dplyr)\nlibrary(tibble)\nlibrary(ampvis2)\nlibrary(microbiomeutilities)\nlibrary(tidyr)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Relative Abundances"
    ]
  },
  {
    "objectID": "03.1.RelativeAbundances.html#load-libraries",
    "href": "03.1.RelativeAbundances.html#load-libraries",
    "title": "Relative Abundances",
    "section": "",
    "text": "library(phyloseq)\nlibrary(qiime2R)\nlibrary(microbiome)\nlibrary(dplyr)\nlibrary(tibble)\nlibrary(ampvis2)\nlibrary(microbiomeutilities)\nlibrary(tidyr)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Relative Abundances"
    ]
  },
  {
    "objectID": "03.1.RelativeAbundances.html#prepare-data",
    "href": "03.1.RelativeAbundances.html#prepare-data",
    "title": "Relative Abundances",
    "section": "02. Prepare data",
    "text": "02. Prepare data\n02.1 Create Phyloseq Object\n\nps &lt;- qza_to_phyloseq(\n  features = \"data/ASV_table_filter_freq218_emc.qza\",\n  tree = \"data/rooted-tree-iqtree.qza\",\n  taxonomy = \"data/taxonomy.qza\",\n  metadata = \"data/metadata2.tsv\")\n\n\n# check\nps\n\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 7097 taxa and 50 samples ]\nsample_data() Sample Data:       [ 50 samples by 29 sample variables ]\ntax_table()   Taxonomy Table:    [ 7097 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 7097 tips and 7096 internal nodes ]\n\n\n02.2 Check data\n\n#library(microbiome)\nmicrobiome::summarize_phyloseq(ps)\n\nCompositional = NO2\n\n\n1] Min. number of reads = 664132] Max. number of reads = 6748463] Total number of reads = 90064984] Average number of reads = 180129.965] Median number of reads = 171486.57] Sparsity = 0.5668845991263916] Any OTU sum to 1 or less? NO8] Number of singletons = 09] Percent of OTUs that are singletons \n        (i.e. exactly one read detected across all samples)010] Number of sample variables are: 29SampleIDDepthDepthsSiteSample_typeDateLocationTemp...C..intSalnidad..ppm.intSalinidad..ppt.intpH.intpHsupRedox.medido.en.campo1Redox.mV..Eh.intTemperatura...C.supSalnidad..ppm.supSalinidad..ppt.supRedox.medido.en.campoRedox.mV..Eh.supS.2..mg.l..campoml.de.muestra1Factor.de.dilucion1S.2..mg.l.ID_MSO.....mg.l..campoml.de.muestra2Factor.de.dilucion2SO.....mg.l.2\n\n\n[[1]]\n[1] \"1] Min. number of reads = 66413\"\n\n[[2]]\n[1] \"2] Max. number of reads = 674846\"\n\n[[3]]\n[1] \"3] Total number of reads = 9006498\"\n\n[[4]]\n[1] \"4] Average number of reads = 180129.96\"\n\n[[5]]\n[1] \"5] Median number of reads = 171486.5\"\n\n[[6]]\n[1] \"7] Sparsity = 0.566884599126391\"\n\n[[7]]\n[1] \"6] Any OTU sum to 1 or less? NO\"\n\n[[8]]\n[1] \"8] Number of singletons = 0\"\n\n[[9]]\n[1] \"9] Percent of OTUs that are singletons \\n        (i.e. exactly one read detected across all samples)0\"\n\n[[10]]\n[1] \"10] Number of sample variables are: 29\"\n\n[[11]]\n [1] \"Sample\"                 \"ID\"                     \"Depth\"                 \n [4] \"Depths\"                 \"Site\"                   \"Sample_type\"           \n [7] \"Date\"                   \"Location\"               \"Temp...C..int\"         \n[10] \"Salnidad..ppm.int\"      \"Salinidad..ppt.int\"     \"pH.int\"                \n[13] \"pHsup\"                  \"Redox.medido.en.campo1\" \"Redox.mV..Eh.int\"      \n[16] \"Temperatura...C.sup\"    \"Salnidad..ppm.sup\"      \"Salinidad..ppt.sup\"    \n[19] \"Redox.medido.en.campo\"  \"Redox.mV..Eh.sup\"       \"S.2..mg.l..campo\"      \n[22] \"ml.de.muestra1\"         \"Factor.de.dilucion1\"    \"S.2..mg.l.\"            \n[25] \"ID_M\"                   \"SO.....mg.l..campo\"     \"ml.de.muestra2\"        \n[28] \"Factor.de.dilucion2\"    \"SO.....mg.l.\"          \n\n\n02.3 Rename mangrove system\n\n# Extract metadata\nmetadata &lt;- as(sample_data(ps), \"data.frame\")\n\n# Rename specific levels in the Mangrove system column\n#library(dplyr)\nmetadata &lt;- metadata %&gt;%\n  mutate(`Location` = case_when(\n    Location == \"El Cacahuate\" ~ \"Fossil Lagoon\",\n    Location == \"La Piedad\" ~ \"Reforma Waterfalls\",\n    Location == \"Dique Miguelito\" ~ \"Miguelito Dike\",\n    TRUE ~ Location))\n\n# update sample_data in phyloseq object\nsample_data(ps) &lt;- sample_data(metadata)\n\n02.4. Color pallets\n\ndepth_colors &lt;- c(\"0-15\" = \"#f5e5c4\",\n                 \"16-30\" = \"#baa179\",\n                 \"31-45\" = \"#a67451\",\n                 \"50-75\" = \"#80673b\")\n\nloc_colors &lt;- c(\"Fossil Lagoon\"= \"#A3D9A8\",\n                \"Reforma Waterfalls\" = \"#44C17B\",\n                \"Miguelito Dike\" = \"#2E8B57\")\n\n02.5 Check samples\n\n# Samples Plot\n\n# Reorder samples\nmetadata$Location &lt;- factor(\n  metadata$Location,\n  levels = c(\"Fossil Lagoon\", \"Reforma Waterfalls\", \n             \"Miguelito Dike\"))\n\n#plot\nsamples_plot &lt;- ggplot(metadata, aes(x = Location, y = ..count..,\nfill = Location)) + geom_bar(position = \"dodge\") +\n  facet_wrap(~ Location, scales = \"free_x\") +\n  labs(title = \"Samples of the analysis\", y = \"Number of Samples\",\n       x = \"Mangrove system\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 0)) +\n  scale_fill_manual(values = loc_colors)\n\n# show plot\nprint(samples_plot)\n\nWarning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(count)` instead.\n\n\n\n\n\n\n\n\n02.6 Get full core\n\n# Get full core with microbiome\nfull_ps_core_counts &lt;- core(ps, 0, 0.5)\n\n# Check\nps\n\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 7097 taxa and 50 samples ]\nsample_data() Sample Data:       [ 50 samples by 29 sample variables ]\ntax_table()   Taxonomy Table:    [ 7097 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 7097 tips and 7096 internal nodes ]\n\nfull_ps_core_counts\n\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 2048 taxa and 50 samples ]\nsample_data() Sample Data:       [ 50 samples by 29 sample variables ]\ntax_table()   Taxonomy Table:    [ 2048 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 2048 tips and 2047 internal nodes ]\n\n\n02.7 Save object in RDS to next analysis\n\nsaveRDS(ps, \"rds/interior_mangroves/phyloseq.rds\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Relative Abundances"
    ]
  },
  {
    "objectID": "03.1.RelativeAbundances.html#relative-abundance-phyloseq-objects",
    "href": "03.1.RelativeAbundances.html#relative-abundance-phyloseq-objects",
    "title": "Relative Abundances",
    "section": "03. Relative abundance phyloseq objects",
    "text": "03. Relative abundance phyloseq objects\n03.1 Create ampvis objects\nCreate full, core and Site ampvis objects\n\n# library(tibble)\n# library(ampvis2)\n# Ampvis object function\ncreate_ampvis_object &lt;- function(pseq) {\n  # create and extract otu table\n  otu_table_ampvis &lt;- data.frame(OTU = rownames(phyloseq::otu_table(pseq)@.Data),\n                                 phyloseq::otu_table(pseq)@.Data,\n                                 phyloseq::tax_table(pseq)@.Data,\n                                 check.names = FALSE)\n\n  # Metadata\n  meta_data_ampvis &lt;- data.frame(phyloseq::sample_data(pseq),\n                                 check.names = FALSE)\n\n  # change index by SampleID\n  meta_data_ampvis &lt;- meta_data_ampvis %&gt;% rownames_to_column(var = \"SampleID\")\n\n  # ampvis object\n  av2 &lt;- amp_load(otu_table_ampvis, meta_data_ampvis)\n  \n  return(av2)\n}\n\n\n# phyloseq objects\nphyloseq_objects &lt;-list(ps=ps, full_ps_core_counts = full_ps_core_counts)\n\n# Apply function\nampvis_objects &lt;- lapply(phyloseq_objects, create_ampvis_object)\n\nampvis_objects\n\n$ps\nampvis2 object with 3 elements. \nSummary of OTU table:\n     Samples         OTUs  Total#Reads    Min#Reads    Max#Reads Median#Reads \n          50         7097      9006498        66413       674846     171486.5 \n   Avg#Reads \n   180129.96 \n\nAssigned taxonomy:\n     Kingdom       Phylum        Class        Order       Family        Genus \n  7097(100%) 7077(99.72%) 7043(99.24%) 6811(95.97%) 6795(95.74%) 6672(94.01%) \n     Species \n4818(67.89%) \n\nMetadata variables: 30 \n SampleID, Sample, ID, Depth, Depths, Site, Sample_type, Date, Location, Temp...C..int, Salnidad..ppm.int, Salinidad..ppt.int, pH.int, pHsup, Redox.medido.en.campo1, Redox.mV..Eh.int, Temperatura...C.sup, Salnidad..ppm.sup, Salinidad..ppt.sup, Redox.medido.en.campo, Redox.mV..Eh.sup, S.2..mg.l..campo, ml.de.muestra1, Factor.de.dilucion1, S.2..mg.l., ID_M, SO.....mg.l..campo, ml.de.muestra2, Factor.de.dilucion2, SO.....mg.l.\n\n$full_ps_core_counts\nampvis2 object with 3 elements. \nSummary of OTU table:\n     Samples         OTUs  Total#Reads    Min#Reads    Max#Reads Median#Reads \n          50         2048      6092185        45680       451490       114651 \n   Avg#Reads \n    121843.7 \n\nAssigned taxonomy:\n     Kingdom       Phylum        Class        Order       Family        Genus \n  2048(100%) 2043(99.76%) 2031(99.17%)  1960(95.7%) 1957(95.56%) 1913(93.41%) \n     Species \n1336(65.23%) \n\nMetadata variables: 30 \n SampleID, Sample, ID, Depth, Depths, Site, Sample_type, Date, Location, Temp...C..int, Salnidad..ppm.int, Salinidad..ppt.int, pH.int, pHsup, Redox.medido.en.campo1, Redox.mV..Eh.int, Temperatura...C.sup, Salnidad..ppm.sup, Salinidad..ppt.sup, Redox.medido.en.campo, Redox.mV..Eh.sup, S.2..mg.l..campo, ml.de.muestra1, Factor.de.dilucion1, S.2..mg.l., ID_M, SO.....mg.l..campo, ml.de.muestra2, Factor.de.dilucion2, SO.....mg.l.\n\n\n\n#subset amp obj\n\nav2_full &lt;- ampvis_objects$ps\nav2_full_core &lt;- ampvis_objects$full_ps_core_counts\n\n03.2 Kingdom\n\nav2_full$metadata$Depth &lt;- factor(av2_full$metadata$Depths, levels = c(\"0-15\", \"16-30\", \"31-45\", \"50-75\"))\nampv_heatmap_abundances_king_full &lt;- amp_heatmap(av2_full,\n            group_by = \"Depth\",\n            facet_by =  \"Location\",\n            plot_values = TRUE,\n            tax_show = 25,\n            tax_aggregate = \"Kingdom\",\n            plot_colorscale = \"log10\",\n             plot_values_size = 3,\n            color_vector = c(\"deepskyblue3\", \"yellow3\" ,\"magenta3\"))+\n  theme(axis.text.x = element_text(angle = 0, size=9, \n                                   hjust = 0.5, vjust = 0.5),\n        axis.text.y = element_text(size=12, hjust = 1),\n        legend.position=\"right\")\n\nampv_heatmap_abundances_king_full\n\n\n\n\n\n\n# save\nggsave(\"Figures/interior_mangroves/RelAbundances_king.pdf\", last_plot(),width = 16, height = 4.5, units = \"cm\" )\n\nGet data\n\n# library(microbiome)\n# library(microbiomeutilities)\n# library(dplyr)\n\nking_abundances &lt;- taxa_summary(ps,\"Kingdom\")\n\nData provided is not compositional \n will first transform\n\nking_abundances\n\n         Taxa        Max.Rel.Ab        Mean.Rel.Ab      Median.Rel.Ab\n1  d__Archaea 0.132017376126457 0.0231528152808648 0.0141264487609834\n2 d__Bacteria 0.999715207898234  0.976847184719135  0.985873551239017\n             Std.dev\n1 0.0247080819800889\n2 0.0247080819800889\n\n\n03.3 Phylum full\nplot\n\nampv_heatmap_abundances_phylum_loc_full &lt;- amp_heatmap(av2_full,\n            group_by = \"Depth\",\n            facet_by = \"Location\",\n            plot_values = TRUE,\n            tax_show = 30,\n            showRemainingTaxa = TRUE,\n            tax_aggregate = \"Phylum\",\n            tax_add = \"Kingdom\",\n            plot_colorscale = \"log10\",\n            plot_values_size = 2.6,\n            color_vector = c(\"deepskyblue3\", \"yellow3\" ,\"magenta3\"))+\n  theme(axis.text.x = element_text(angle = 0, size=8, \n                                   vjust = 1, hjust = 0.5),\n        axis.text.y = element_text(size=9),\n        legend.position=\"right\")\n\nampv_heatmap_abundances_phylum_loc_full\n\n\n\n\n\n\n\n**Get info**\n\n#library(ampvis2)\n#heatmap\nphy_ab_depth &lt;- amp_heatmap(av2_full,\n            #group_by = \"Depth\",\n            facet_by =   c(\"Depth\",\"Site\",\"Location\"),\n            plot_values = FALSE,\n            tax_show = 30,\n            textmap = TRUE,\n            tax_aggregate = \"Phylum\")\n\n\n# library(dplyr)\n# library(tidyr)\n# library(tibble)\n\n# Transform data.frame to long format\nphy_ab_long &lt;- phy_ab_depth %&gt;%\n  rownames_to_column(\"Phylum\") %&gt;% \n  pivot_longer(\n    cols = -Phylum, \n    names_to = \"Sample_Location\", \n    values_to = \"Abundance\"\n  ) %&gt;%\n  separate(Sample_Location, into = c(\"Sample\",\"Depth\", \"Site\", \"Location\"), sep = \" \") %&gt;%\n  mutate(\n    Depth = gsub(\"-cm\", \"\", Depth)  # Clean depth name\n  )\n\nWarning: Expected 4 pieces. Additional pieces discarded in 1500 rows [1, 2, 3, 4, 5, 6,\n7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].\n\n# mean and sd Depth and Location\nphy_ab_summary_stats &lt;- phy_ab_long %&gt;%\n  group_by(Phylum, Depth, Location) %&gt;%\n  summarise(\n    mean_abundance = mean(Abundance, na.rm = TRUE),\n    sd_abundance = sd(Abundance, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# show\nphy_ab_summary_stats\n\n# A tibble: 360 × 5\n   Phylum          Depth Location  mean_abundance sd_abundance\n   &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;        &lt;dbl&gt;\n 1 Acidobacteriota 0-15  Fossil              6.96        0.808\n 2 Acidobacteriota 0-15  Miguelito           5.27        1.75 \n 3 Acidobacteriota 0-15  Reforma             5.59        1.35 \n 4 Acidobacteriota 16-30 Fossil              7.17        0.870\n 5 Acidobacteriota 16-30 Miguelito           6.48        0.845\n 6 Acidobacteriota 16-30 Reforma             4.47        0.717\n 7 Acidobacteriota 31-45 Fossil              6.65        1.01 \n 8 Acidobacteriota 31-45 Miguelito           6.50        1.21 \n 9 Acidobacteriota 31-45 Reforma             4.77        1.19 \n10 Acidobacteriota 50-75 Fossil              8.87        1.87 \n# ℹ 350 more rows\n\n# Format table\nphy_depth_table &lt;- phy_ab_summary_stats %&gt;%\n  pivot_wider(\n    names_from = Location,\n    values_from = c(mean_abundance, sd_abundance),\n    names_sep = \"_\"\n  )\n\nphy_depth_table\n\n# A tibble: 120 × 8\n   Phylum           Depth mean_abundance_Fossil mean_abundance_Miguelito\n   &lt;chr&gt;            &lt;chr&gt;                 &lt;dbl&gt;                    &lt;dbl&gt;\n 1 Acidobacteriota  0-15                 6.96                      5.27 \n 2 Acidobacteriota  16-30                7.17                      6.48 \n 3 Acidobacteriota  31-45                6.65                      6.50 \n 4 Acidobacteriota  50-75                8.87                      6.12 \n 5 Actinobacteriota 0-15                 3.75                      3.52 \n 6 Actinobacteriota 16-30                2.84                      2.31 \n 7 Actinobacteriota 31-45                3.73                      2.77 \n 8 Actinobacteriota 50-75                3.05                      3.15 \n 9 Armatimonadota   0-15                 0.0361                    0.193\n10 Armatimonadota   16-30                0.231                     0.407\n# ℹ 110 more rows\n# ℹ 4 more variables: mean_abundance_Reforma &lt;dbl&gt;, sd_abundance_Fossil &lt;dbl&gt;,\n#   sd_abundance_Miguelito &lt;dbl&gt;, sd_abundance_Reforma &lt;dbl&gt;\n\n# save\nwrite.table(phy_depth_table, \"Tables/Phylum_depth_location_stats.tsv\", row.names = FALSE, sep = \"\\t\", quote = FALSE)\n\n03.4 Phylum Core\n\n#Factor Depth_cm \nav2_full_core$metadata$Depth &lt;- factor(av2_full_core$metadata$Depths, levels = c(\"0-15\", \"16-30\", \"31-45\", \"50-75\"))\n\n# Full all samples\nampv_heatmap_abundances_phylum_core &lt;- amp_heatmap(av2_full_core,\n            group_by = \"Depth\",\n            facet_by = \"Location\",\n            plot_values = TRUE,\n            tax_show = 30,\n            showRemainingTaxa = TRUE,\n            tax_aggregate = \"Phylum\",\n            tax_add = \"Kingdom\",\n            plot_colorscale = \"log10\",\n            plot_values_size = 2.6,\n            color_vector = c(\"deepskyblue3\", \"yellow3\" ,\"magenta3\"))+\n  theme(axis.text.x = element_text(angle = 0, size=8, \n                                   vjust = 1, hjust = 0.5),\n        axis.text.y = element_text(size=9),\n        legend.position=\"right\")\n\nampv_heatmap_abundances_phylum_core\n\n\n\n\n\n\n\n03.5 Combine plots\n\nlibrary(cowplot)\n#Combine venn plot\ntitle_abund_plot &lt;- ggdraw() + draw_label(\"Relative Abundance\", fontface = 'bold', x = 0.5, hjust = 0.5, size = 15)\nampv_all_phylum_plots &lt;- plot_grid(title_abund_plot, ampv_heatmap_abundances_phylum_loc_full, ampv_heatmap_abundances_phylum_core, labels = c(\"\", \"A\", \"B\"), ncol = 1, rel_heights = c(0.10, 1.2, 1.2))\n\nampv_all_phylum_plots\n\n\n\n\n\n\n\n\n#save\nggsave(\"Figures/interior_mangroves/Abundances_Phylum_full_and_core.pdf\", ampv_all_phylum_plots, width = 18, height = 30, units = \"cm\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Relative Abundances"
    ]
  },
  {
    "objectID": "03.1.RelativeAbundances.html#dominants",
    "href": "03.1.RelativeAbundances.html#dominants",
    "title": "Relative Abundances",
    "section": "Dominants",
    "text": "Dominants\n\n#psgen &lt;- aggregate_taxa(p0,\"Genus\")\ntax_dominant &lt;- dominant_taxa(ps,level = \"Phylum\", group=\"Location\")\nhead(tax_dominant$dominant_overview)\n\n# A tibble: 6 × 5\n# Groups:   Location [3]\n  Location           dominant_taxa      n rel.freq rel.freq.pct\n  &lt;chr&gt;              &lt;chr&gt;          &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;       \n1 Fossil Lagoon      Proteobacteria    13     92.9 93%         \n2 Miguelito Dike     Chloroflexi       13     54.2 54%         \n3 Miguelito Dike     Proteobacteria     9     37.5 38%         \n4 Reforma Waterfalls Proteobacteria     8     66.7 67%         \n5 Reforma Waterfalls Chloroflexi        3     25   25%         \n6 Miguelito Dike     Firmicutes         2      8.3 8%",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Relative Abundances"
    ]
  },
  {
    "objectID": "02.5.Fig2.InteriorCoastalCompare.html",
    "href": "02.5.Fig2.InteriorCoastalCompare.html",
    "title": "Fig.2 Interior and Coastal mangroves compare",
    "section": "",
    "text": "library(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Fig.2 Interior and Coastal mangroves compare"
    ]
  },
  {
    "objectID": "02.5.Fig2.InteriorCoastalCompare.html#load-figures",
    "href": "02.5.Fig2.InteriorCoastalCompare.html#load-figures",
    "title": "Fig.2 Interior and Coastal mangroves compare",
    "section": "Load figures",
    "text": "Load figures\n\nalpha &lt;- readRDS(\"rds/compare_mangroves/alpha_diversity_surface_plot.rds\")\n\nbeta &lt;- readRDS(\"rds/compare_mangroves/beta-diversity-surface-plot.rds\")\n\ncore &lt;- readRDS(\"rds/compare_mangroves/upset_surface_plot.rds\")\n\ndabar &lt;- readRDS(\"rds/compare_mangroves/DA_barplot_surface.rds\")\n\ndahm &lt;- readRDS(\"rds/compare_mangroves/DA_heatmap_surface.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Fig.2 Interior and Coastal mangroves compare"
    ]
  },
  {
    "objectID": "02.5.Fig2.InteriorCoastalCompare.html#combine-plots",
    "href": "02.5.Fig2.InteriorCoastalCompare.html#combine-plots",
    "title": "Fig.2 Interior and Coastal mangroves compare",
    "section": "Combine plots",
    "text": "Combine plots\n\nbeta_core &lt;- plot_grid(beta, core, labels = c(\"B\", \"D)\"),\n                        label_fontface = \"bold\",\n                        ncol = 1, rel_heights = c(0.8, 1))\nbeta_core_da &lt;- plot_grid(beta_core, dahm, labels = c(\"\", \"C)\"),\n                        label_fontface = \"bold\",\n                        ncol = 2, rel_widths = c(1, 0.9))\nalpha_beta_core_da_2 &lt;- plot_grid(alpha, beta_core_da,\n                        ncol = 2, rel_widths = c(0.35, 1))\nalpha_beta_core_da_2\n\n\n\n\n\n\n\n\nggsave(\"Figures/SurfaceComparison/Fig2.SurfaceComparison_2.pdf\",\n       alpha_beta_core_da_2, width = 19, height = 12)\n\n\n\n\n\n\n\nEdit figure in Inkscape\n\n\n\nThe UpSet plot insertion and other details were done in Inkscape. The final figure is shown below:",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Fig.2 Interior and Coastal mangroves compare"
    ]
  },
  {
    "objectID": "00.Presentation.html",
    "href": "00.Presentation.html",
    "title": "Unraveling microbial diversity from a fossil lagoon with an inland mangrove forest",
    "section": "",
    "text": "Website of microbial diversity analysis of the paper …\n\n\n\nMangroves play a crucial role in ecological services like hurricane protection, carbon storage, and biodiversity support by harboring essential microbial communities for nutrient recycling and biogeochemical cycling. The microbial diversity of inland mangroves, particularly the relict mangroves of the San Pedro River from the last interglacial period, remains understudied. The study of these surviving mangrove systems offers insights into microbial dynamics and the identification of resilient microbiota with potential applications in mangrove restoration efforts. By exploring similarities and differences between coastal and inland mangroves, as well as degraded coastal mangroves, we aim to understand the unique qualities that make inland mangroves distinct while also identifying common elements shared by all mangrove ecosystems.\nIn this work we studied the microbial diversity associated with Rhizophora mangle of inland and coastal mangroves distributed on the Yucatan platform. Inland mangroves, distributed along the San Pedro Martir river, are 170 km away from the nearest estuary. Samples were taken from Laguna El Cacahuate (Fossil Lagoon), in the upper part of the river, near Guatemala, and from the Miguelito Dike and Reforma Waterfalls in the lower part of the river, in the state of Tabasco. While for coastal mangroves, public data were taken from isolated sediments in the Términos Lagoon and the Celestún Lagoon.",
    "crumbs": [
      "Presentation"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html",
    "href": "02.3.Coremicrobiome.html",
    "title": "Core microbiome",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(UpSetR)\nlibrary(ggplot2)\nlibrary(ggalluvial)\n\n\n#load data\nphyseq_qiime3 &lt;- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n\n\n# Rename mangrove system columna\ncolnames(sample_data(physeq_qiime3))[colnames(sample_data(physeq_qiime3)) == \"Mangrove system\"] &lt;- \"Mangrove_system\"\n\n# Convert Mangrove_system to factor\nsample_data(physeq_qiime3)$Mangrove_system &lt;- as.factor(sample_data(physeq_qiime3)$Mangrove_system)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#load-libraries-and-prepare-data",
    "href": "02.3.Coremicrobiome.html#load-libraries-and-prepare-data",
    "title": "Core microbiome",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(UpSetR)\nlibrary(ggplot2)\nlibrary(ggalluvial)\n\n\n#load data\nphyseq_qiime3 &lt;- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n\n\n# Rename mangrove system columna\ncolnames(sample_data(physeq_qiime3))[colnames(sample_data(physeq_qiime3)) == \"Mangrove system\"] &lt;- \"Mangrove_system\"\n\n# Convert Mangrove_system to factor\nsample_data(physeq_qiime3)$Mangrove_system &lt;- as.factor(sample_data(physeq_qiime3)$Mangrove_system)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#calculate-core",
    "href": "02.3.Coremicrobiome.html#calculate-core",
    "title": "Core microbiome",
    "section": "01. Calculate core",
    "text": "01. Calculate core\n\n# Prevalence threshold\nprevalence_threshold &lt;- 0.8\n\n# Storage ASVs core list\ncore_list &lt;- list()\nlocations &lt;- levels(sample_data(physeq_qiime3)$Mangrove_system)\n\n# Calculate core\nfor (loc in locations) {\n  # Filter samples by mangrove system\n  physeq_loc &lt;- prune_samples(sample_data(physeq_qiime3)$Mangrove_system == loc, physeq_qiime3)\n  n_samples_loc &lt;- nsamples(physeq_loc)\n\n  # Extract OTU table\n  otu &lt;- as(otu_table(physeq_loc), \"matrix\")\n\n  # Calc prevalence\n  prevalence &lt;- rowSums(otu &gt; 0) / n_samples_loc\n\n  # Identify ASVs with prevalence &gt;= umbral\n  core_taxa &lt;- names(prevalence)[prevalence &gt;= prevalence_threshold]\n\n  # Guardar en la lista\n  core_list[[loc]] &lt;- core_taxa\n}\n\n# Show ASVs core by mangrove system\nprint(lapply(core_list, length))\n\n$`Celestún Lagoon`\n[1] 577\n\n$`Fossil Lagoon`\n[1] 745\n\n$`San Pedro River`\n[1] 781\n\n$`Términos Lagoon`\n[1] 16\n\n# checkpoint,if empty try threshold = 1\nif (all(sapply(core_list, length) == 0)) {\n  cat(\"Try prevalence = 1...\\n\")\n  prevalence_threshold &lt;- 1.0\n  core_list &lt;- list()\n  for (loc in locations) {\n    physeq_loc &lt;- prune_samples(sample_data(physeq_qiime3)$Mangrove_system == loc, physeq_qiime3)\n    n_samples_loc &lt;- nsamples(physeq_loc)\n    otu &lt;- as(otu_table(physeq_loc), \"matrix\")\n    prevalence &lt;- rowSums(otu &gt; 0) / n_samples_loc\n    core_taxa &lt;- names(prevalence)[prevalence &gt;= prevalence_threshold]\n    core_list[[loc]] &lt;- core_taxa\n  }\n  print(lapply(core_list, length))\n}",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#extract-core-info",
    "href": "02.3.Coremicrobiome.html#extract-core-info",
    "title": "Core microbiome",
    "section": "02. Extract core info",
    "text": "02. Extract core info\n\n# Unique core ASV list\nall_core_asvs &lt;- unique(unlist(core_list))\n\n# Create matrix presence/absence\ncore_matrix &lt;- matrix(0, nrow = length(all_core_asvs), ncol = length(locations),\n                      dimnames = list(all_core_asvs, locations))\n\n# fill matrix: \nfor (loc in locations) {\n  core_matrix[core_list[[loc]], loc] &lt;- 1\n}\n\n# Convert to data frame to UpSetR\ncore_df &lt;- as.data.frame(core_matrix)\n\n# Create intersection list\nqueries_list &lt;- list()",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#plot-aesthetics",
    "href": "02.3.Coremicrobiome.html#plot-aesthetics",
    "title": "Core microbiome",
    "section": "03. plot aesthetics",
    "text": "03. plot aesthetics\n\n#library(UpSetR)\n# Fossil Lagoon\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\"), color = \"#A7FCC1\",\n       active = TRUE, query.name = \"Fossil Lagoon\")\n))\n\n# San Pedro River\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"San Pedro River\"), color = \"#26B170\",\n       active = TRUE, query.name = \"San Pedro River\")\n))\n\n# Terminos Lagoon\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Términos Lagoon\"), color = \"#329D9C\",\n       active = TRUE, query.name = \"Términos Lagoon\")\n))\n\n# Celestún\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Celestún Lagoon\"), color = \"#41E8D3\",\n       active = TRUE, query.name = \"Celestún Lagoon\")\n))\n\n# Core\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\", \n                                         \"San Pedro River\",\n                                         \"Términos Lagoon\",\n                                         \"Celestún Lagoon\"),\n       color = \"#8D3CA3\", active = TRUE, query.name = \"Core\")))\n\n# Interior\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\", \"San Pedro River\"),\n       color = \"#356E48\", active = TRUE, query.name = \"Interior\")\n))\n\n## Note: due to the fact that there were no unique asvs for coastal, it was not integrated in this selection.",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#upset-plot",
    "href": "02.3.Coremicrobiome.html#upset-plot",
    "title": "Core microbiome",
    "section": "04. UpSet plot",
    "text": "04. UpSet plot\n\n#library(UpSetR)\nupset_plot &lt;- upset(core_df,\n                    sets = colnames(core_df),\n                    order.by = \"freq\",\n                    mainbar.y.label = \"Shared ASVs\",\n                    sets.x.label = \"ASVs per Site\",\n                    text.scale = 1.5,\n                    point.size = 4,\n                    line.size = 1.5,\n                    query.legend = \"bottom\",\n                    sets.bar.color = \n                      c(\"#26B170\",\"#A7FCC1\",\"#41E8D3\",\"#329D9C\"),\n                    queries = queries_list)\n\n# show\nprint(upset_plot)\n\n\n\n\n\n\n\nsave plot\n\npdf(\"Figures/SurfaceComparison/core_upset.pdf\", width = 5.8, height = 4)\nupset_plot\ndev.off()\n\nquartz_off_screen \n                2",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#get-unique-and-core-asv-info",
    "href": "02.3.Coremicrobiome.html#get-unique-and-core-asv-info",
    "title": "Core microbiome",
    "section": "05. Get unique and core ASV info",
    "text": "05. Get unique and core ASV info\n\n### get unique ASVs per mangrove system\nunique_asvs &lt;- list()\nfor (loc in colnames(core_df)) {\n  unique_asvs[[loc]] &lt;- rownames(core_df)[rowSums(core_df == 1) == 1 & core_df[[loc]] == 1]\n  cat(loc, \": Unique ASVs:\", length(unique_asvs[[loc]]), \"\\n\")\n  print(head(unique_asvs[[loc]], 5))  # Show first 5\n}\n\nCelestún Lagoon : Unique ASVs: 186 \n[1] \"KU578729.1.1383\" \"JF344529.1.1525\" \"JN483938.1.1414\" \"HE804536.1.1436\"\n[5] \"DQ811792.1.1512\"\nFossil Lagoon : Unique ASVs: 270 \n[1] \"FN398053.1.1489\" \"FR667789.1.1446\" \"EU385876.1.1464\" \"EU487871.1.1472\"\n[5] \"JQ989640.1.1399\"\nSan Pedro River : Unique ASVs: 256 \n[1] \"KY618740.1.1206\" \"EU592483.1.1535\" \"LN567307.1.1331\" \"DQ363844.1.926\" \n[5] \"HM598151.1.1526\"\nTérminos Lagoon : Unique ASVs: 1 \n[1] \"EU487913.1.1482\"\n\n#unique_asvs\n\n\n# Verify taxonomy\nif (!is.null(tax_table(physeq_qiime3))) {\n  tax_table_df &lt;- as.data.frame(tax_table(physeq_qiime3))\n\n  # Get taxonomy function\n  get_taxonomy &lt;- function(asv_list) {\n    if (length(asv_list) &gt; 0) {\n      taxonomy &lt;- tax_table_df[asv_list, , drop = FALSE]\n      return(taxonomy)\n    } else {\n      return(NULL)\n    }\n  }\n\n  # Get taxonomy\n  taxonomy_unique &lt;- lapply(unique_asvs, get_taxonomy)\n\n  # show first 5  unique ASVs\n  for (loc in names(taxonomy_unique)) {\n    cat(\"\\nFirst unique ASVs taxonomy\", loc, \":\\n\")\n    if (!is.null(taxonomy_unique[[loc]])) {\n      print(head(taxonomy_unique[[loc]], 5))\n    } else {\n      cat(\"There are no unique ASV to\", loc, \"\\n\")\n    }\n  }\n} else {\n  cat(\"Please import taxonomy.\\n\")\n}\n\n\nFirst unique ASVs taxonomy Celestún Lagoon :\n                    Kingdom                       Phylum\nKU578729.1.1383 d__Bacteria            Verrucomicrobiota\nJF344529.1.1525 d__Bacteria                      Sva0485\nJN483938.1.1414 d__Bacteria                 Bacteroidota\nHE804536.1.1436 d__Bacteria             Actinobacteriota\nDQ811792.1.1512 d__Bacteria SAR324_clade(Marine_group_B)\n                                       Class                        Order\nKU578729.1.1383                  Omnitrophia                Omnitrophales\nJF344529.1.1525                      Sva0485                      Sva0485\nJN483938.1.1414                  Bacteroidia                 Cytophagales\nHE804536.1.1436               Coriobacteriia                        OPB41\nDQ811792.1.1512 SAR324_clade(Marine_group_B) SAR324_clade(Marine_group_B)\n                                      Family                        Genus\nKU578729.1.1383               Omnitrophaceae       Candidatus_Omnitrophus\nJF344529.1.1525                      Sva0485                      Sva0485\nJN483938.1.1414            Cyclobacteriaceae                   uncultured\nHE804536.1.1436                        OPB41                        OPB41\nDQ811792.1.1512 SAR324_clade(Marine_group_B) SAR324_clade(Marine_group_B)\n                         Species\nKU578729.1.1383             &lt;NA&gt;\nJF344529.1.1525             &lt;NA&gt;\nJN483938.1.1414             &lt;NA&gt;\nHE804536.1.1436             &lt;NA&gt;\nDQ811792.1.1512 uncultured_delta\n\nFirst unique ASVs taxonomy Fossil Lagoon :\n                    Kingdom           Phylum               Class\nFN398053.1.1489 d__Bacteria   Proteobacteria Gammaproteobacteria\nFR667789.1.1446 d__Bacteria   Proteobacteria Alphaproteobacteria\nEU385876.1.1464 d__Bacteria   Proteobacteria Gammaproteobacteria\nEU487871.1.1472 d__Bacteria      Chloroflexi     Dehalococcoidia\nJQ989640.1.1399  d__Archaea Thermoplasmatota      Thermoplasmata\n                                             Order\nFN398053.1.1489                    Cellvibrionales\nFR667789.1.1446                      Micropepsales\nEU385876.1.1464              UBA10353_marine_group\nEU487871.1.1472                       Napoli-4B-65\nJQ989640.1.1399 Marine_Benthic_Group_D_and_DHVEG-1\n                                            Family\nFN398053.1.1489                         Halieaceae\nFR667789.1.1446                     Micropepsaceae\nEU385876.1.1464              UBA10353_marine_group\nEU487871.1.1472                       Napoli-4B-65\nJQ989640.1.1399 Marine_Benthic_Group_D_and_DHVEG-1\n                                             Genus              Species\nFN398053.1.1489                               &lt;NA&gt;                 &lt;NA&gt;\nFR667789.1.1446                     Micropepsaceae uncultured_bacterium\nEU385876.1.1464              UBA10353_marine_group uncultured_bacterium\nEU487871.1.1472                       Napoli-4B-65 uncultured_bacterium\nJQ989640.1.1399 Marine_Benthic_Group_D_and_DHVEG-1  uncultured_archaeon\n\nFirst unique ASVs taxonomy San Pedro River :\n                    Kingdom           Phylum               Class\nKY618740.1.1206 d__Bacteria       Firmicutes             Bacilli\nEU592483.1.1535 d__Bacteria Desulfobacterota     Desulfobacteria\nLN567307.1.1331 d__Bacteria   Proteobacteria Alphaproteobacteria\nDQ363844.1.926   d__Archaea Thermoplasmatota      Thermoplasmata\nHM598151.1.1526 d__Bacteria Desulfobacterota     Desulfobacteria\n                             Order              Family          Genus\nKY618740.1.1206         Bacillales         Bacillaceae       Bacillus\nEU592483.1.1535 Desulfatiglandales Desulfatiglandaceae Desulfatiglans\nLN567307.1.1331        Rhizobiales  Methyloligellaceae     uncultured\nDQ363844.1.926          uncultured          uncultured     uncultured\nHM598151.1.1526 Desulfatiglandales Desulfatiglandaceae Desulfatiglans\n                             Species\nKY618740.1.1206                 &lt;NA&gt;\nEU592483.1.1535 uncultured_bacterium\nLN567307.1.1331                 &lt;NA&gt;\nDQ363844.1.926   uncultured_archaeon\nHM598151.1.1526                 &lt;NA&gt;\n\nFirst unique ASVs taxonomy Términos Lagoon :\n                    Kingdom      Phylum        Class          Order\nEU487913.1.1482 d__Bacteria Chloroflexi Anaerolineae Anaerolineales\n                         Family      Genus Species\nEU487913.1.1482 Anaerolineaceae uncultured    &lt;NA&gt;\n\n# Confirm the total number of unique ASVs\nlapply(taxonomy_unique, function(x) if (!is.null(x)) nrow(x) else 0)\n\n$`Celestún Lagoon`\n[1] 186\n\n$`Fossil Lagoon`\n[1] 270\n\n$`San Pedro River`\n[1] 256\n\n$`Términos Lagoon`\n[1] 1\n\n\nGet taxonomy\nPhylum level\n\n# Create a list to store unique asv to Phylum level\nphylum_unique &lt;- list()\n\n# Iterate on each Mangrove system\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy phylum\n    tax_df &lt;- taxonomy_unique[[loc]]\n    if (\"Phylum\" %in% colnames(tax_df)) {\n      phylum &lt;- tax_df$Phylum\n      phylum &lt;- phylum[!is.na(phylum)]  # Exclude NA\n      phylum_unique[[loc]] &lt;- unique(phylum)\n    } else {\n      cat(\"Phylum is not available to\", loc, \"\\n\")\n      phylum_unique[[loc]] &lt;- character(0)\n    }\n  } else {\n    phylum_unique[[loc]] &lt;- character(0)\n  }\n}\n\n# Identify exclusive phylum for Mangrove system\nall_phylums &lt;- unique(unlist(phylum_unique))\nphylum_exclusive &lt;- list()\nfor (loc in names(phylum_unique)) {\n  other_locations &lt;- setdiff(names(phylum_unique), loc)\n  other_phylum &lt;- unique(unlist(phylum_unique[other_locations]))\n  exclusive_phylum &lt;- setdiff(phylum_unique[[loc]], other_phylum)\n  phylum_exclusive[[loc]] &lt;- exclusive_phylum\n  cat(\"Exclusive phylum in\", loc, \":\", length(exclusive_phylum), \"\\n\")\n  if (length(exclusive_phylum) &gt; 0) {\n    print(exclusive_phylum)\n  } else {\n    cat(\"There are not exclusive phylum.\\n\")\n  }\n}\n\nExclusive phylum in Celestún Lagoon : 5 \n[1] \"SAR324_clade(Marine_group_B)\" \"RCP2-54\"                     \n[3] \"Caldatribacteriota\"           \"CK-2C2-2\"                    \n[5] \"Nitrospinota\"                \nExclusive phylum in Fossil Lagoon : 12 \n [1] \"Patescibacteria\" \"Modulibacteria\"  \"Elusimicrobiota\" \"Halobacterota\"  \n [5] \"PAUC34f\"         \"Micrarchaeota\"   \"Hydrogenedentes\" \"LCP-89\"         \n [9] \"Cyanobacteria\"   \"Armatimonadota\"  \"Dependentiae\"    \"Acetothermia\"   \nExclusive phylum in San Pedro River : 3 \n[1] \"Dadabacteria\"     \"Abditibacteriota\" \"Sumerlaeota\"     \nExclusive phylum in Términos Lagoon : 0 \nThere are not exclusive phylum.\n\n\nFamily level\n\n# Create a list to store unique asv to specific taxonomy level\nfamilies_unique &lt;- list()\n\n# Iterate on each Mangrove system\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy families\n    tax_df &lt;- taxonomy_unique[[loc]]\n    if (\"Family\" %in% colnames(tax_df)) {\n      families &lt;- tax_df$Family\n      families &lt;- families[!is.na(families)]  # Exclude NA\n      families_unique[[loc]] &lt;- unique(families)\n    } else {\n      cat(\"Family is not available to\", loc, \"\\n\")\n      families_unique[[loc]] &lt;- character(0)\n    }\n  } else {\n    families_unique[[loc]] &lt;- character(0)\n  }\n}\n\n# Identify exclusive family for Mangrove system\nall_families &lt;- unique(unlist(families_unique))\nfamilies_exclusive &lt;- list()\nfor (loc in names(families_unique)) {\n  other_locations &lt;- setdiff(names(families_unique), loc)\n  other_families &lt;- unique(unlist(families_unique[other_locations]))\n  exclusive_families &lt;- setdiff(families_unique[[loc]], other_families)\n  families_exclusive[[loc]] &lt;- exclusive_families\n  cat(\"Exclusive family in\", loc, \":\", length(exclusive_families), \"\\n\")\n  if (length(exclusive_families) &gt; 0) {\n    print(exclusive_families)\n  } else {\n    cat(\"There are not exclusive family.\\n\")\n  }\n}\n\nExclusive family in Celestún Lagoon : 26 \n [1] \"OPB41\"                        \"SAR324_clade(Marine_group_B)\"\n [3] \"Hungateiclostridiaceae\"       \"MBAE14\"                      \n [5] \"RCP2-54\"                      \"Odinarchaeia\"                \n [7] \"Subgroup_9\"                   \"Nitrosomonadaceae\"           \n [9] \"EF100-94H03\"                  \"Desulfomonilaceae\"           \n[11] \"CCM11a\"                       \"FW22\"                        \n[13] \"JS1\"                          \"Microbulbiferaceae\"          \n[15] \"Ectothiorhodospiraceae\"       \"TG3\"                         \n[17] \"B2M28\"                        \"Caldilineaceae\"              \n[19] \"Nitrososphaeraceae\"           \"Subgroup_21\"                 \n[21] \"Gaiellaceae\"                  \"CK-2C2-2\"                    \n[23] \"Rhizobiales_Incertae_Sedis\"   \"Geothermarchaeaceae\"         \n[25] \"PS-B29\"                       \"P9X2b3D02\"                   \nExclusive family in Fossil Lagoon : 44 \n [1] \"Micropepsaceae\"          \"UBA10353_marine_group\"  \n [3] \"Bdellovibrionaceae\"      \"Gracilibacteria\"        \n [5] \"Moduliflexaceae\"         \"Lineage_IIc\"            \n [7] \"SM23-30\"                 \"Methanomicrobiaceae\"    \n [9] \"PAUC34f\"                 \"Nitrincolaceae\"         \n[11] \"MidBa8\"                  \"PAUC26f\"                \n[13] \"Bradymonadales\"          \"Solimonadaceae\"         \n[15] \"Simkaniaceae\"            \"67-14\"                  \n[17] \"vadinHA49\"               \"Micrarchaeales\"         \n[19] \"HOC36\"                   \"Melioribacteraceae\"     \n[21] \"Hydrogenedensaceae\"      \"Pla3_lineage\"           \n[23] \"LCP-89\"                  \"Rhodobacteraceae\"       \n[25] \"Micavibrionales\"         \"Desulfobacteraceae\"     \n[27] \"Pseudohongiellaceae\"     \"Nostocaceae\"            \n[29] \"VHS-B4-70\"               \"Dissulfuribacteraceae\"  \n[31] \"Run-SP154\"               \"Blastocatellaceae\"      \n[33] \"VHS-B3-70\"               \"Methylohalobiaceae\"     \n[35] \"SBYC\"                    \"Desulfovibrionaceae\"    \n[37] \"Vermiphilaceae\"          \"Kineosporiaceae\"        \n[39] \"Bacteroidetes_vadinHA17\" \"Syntrophobacteraceae\"   \n[41] \"Acetothermiia\"           \"Lentimicrobiaceae\"      \n[43] \"Haloadaptaceae\"          \"MD2894-B20\"             \nExclusive family in San Pedro River : 38 \n [1] \"Geopsychrobacteraceae\"  \"OM182_clade\"            \"Balneolaceae\"          \n [4] \"Subgroup_17\"            \"Sulfurovaceae\"          \"Dadabacteriales\"       \n [7] \"A4b\"                    \"Abditibacteriaceae\"     \"bacteriap25\"           \n[10] \"Marine_Benthic_Group_A\" \"t0.6.f\"                 \"Rhodospirillaceae\"     \n[13] \"Clostridiaceae\"         \"Thermoplasmata\"         \"Saccharospirillaceae\"  \n[16] \"Subgroup_2\"             \"DG-20\"                  \"Spongiibacteraceae\"    \n[19] \"Pla1_lineage\"           \"Desulfococcaceae\"       \"Thiomicrospiraceae\"    \n[22] \"Emcibacteraceae\"        \"Eel-36e1D6\"             \"Thermoplasmatota\"      \n[25] \"Sumerlaeaceae\"          \"KI89A_clade\"            \"PHOS-HE36\"             \n[28] \"Desulfurivibrionaceae\"  \"Planococcaceae\"         \"Hyphomonadaceae\"       \n[31] \"Colwelliaceae\"          \"SAR202_clade\"           \"Arcobacteraceae\"       \n[34] \"Thiotrichaceae\"         \"Myxococcaceae\"          \"C86\"                   \n[37] \"AB-539-J10\"             \"Bacteriovoracaceae\"    \nExclusive family in Términos Lagoon : 0 \nThere are not exclusive family.\n\n\nGet core table\n\n# Combine taxonomy in data.frame\ntaxonomy_unique_df &lt;- do.call(rbind, lapply(names(taxonomy_unique), function(loc) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    df &lt;- taxonomy_unique[[loc]]\n    df$Location &lt;- loc\n    df$ASV &lt;- rownames(df)# add name asv column\n    return(df)\n  } else {\n    return(NULL)\n  }\n}))\n\n# Move columns\ntaxonomy_unique_df &lt;- taxonomy_unique_df[, c(\"ASV\", \"Location\", setdiff(names(taxonomy_unique_df), c(\"ASV\", \"Location\")))]\n\n# show first rows of data.frame to verify\nprint(head(taxonomy_unique_df))\n\n                            ASV        Location     Kingdom\nKU578729.1.1383 KU578729.1.1383 Celestún Lagoon d__Bacteria\nJF344529.1.1525 JF344529.1.1525 Celestún Lagoon d__Bacteria\nJN483938.1.1414 JN483938.1.1414 Celestún Lagoon d__Bacteria\nHE804536.1.1436 HE804536.1.1436 Celestún Lagoon d__Bacteria\nDQ811792.1.1512 DQ811792.1.1512 Celestún Lagoon d__Bacteria\nAF354161.1.1421 AF354161.1.1421 Celestún Lagoon d__Bacteria\n                                      Phylum                        Class\nKU578729.1.1383            Verrucomicrobiota                  Omnitrophia\nJF344529.1.1525                      Sva0485                      Sva0485\nJN483938.1.1414                 Bacteroidota                  Bacteroidia\nHE804536.1.1436             Actinobacteriota               Coriobacteriia\nDQ811792.1.1512 SAR324_clade(Marine_group_B) SAR324_clade(Marine_group_B)\nAF354161.1.1421                Calditrichota                 Calditrichia\n                                       Order                       Family\nKU578729.1.1383                Omnitrophales               Omnitrophaceae\nJF344529.1.1525                      Sva0485                      Sva0485\nJN483938.1.1414                 Cytophagales            Cyclobacteriaceae\nHE804536.1.1436                        OPB41                        OPB41\nDQ811792.1.1512 SAR324_clade(Marine_group_B) SAR324_clade(Marine_group_B)\nAF354161.1.1421               Calditrichales              Calditrichaceae\n                                       Genus          Species\nKU578729.1.1383       Candidatus_Omnitrophus             &lt;NA&gt;\nJF344529.1.1525                      Sva0485             &lt;NA&gt;\nJN483938.1.1414                   uncultured             &lt;NA&gt;\nHE804536.1.1436                        OPB41             &lt;NA&gt;\nDQ811792.1.1512 SAR324_clade(Marine_group_B) uncultured_delta\nAF354161.1.1421              Calditrichaceae             &lt;NA&gt;\n\n\n\n# save data.frame\nwrite.csv(taxonomy_unique_df, file = \"Tables/SurfaceComparison/unique_asvs_taxonomy.csv\", row.names = FALSE)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#get-core-taxonomy",
    "href": "02.3.Coremicrobiome.html#get-core-taxonomy",
    "title": "Core microbiome",
    "section": "06. Get core taxonomy",
    "text": "06. Get core taxonomy\n\nshared_asvs &lt;- Reduce(intersect, core_list)\nprint(shared_asvs)\n\n[1] \"DQ811808.1.1527\" \"EU652571.1.1503\" \"GQ249585.1.1531\" \"AM176885.1.1418\"\n[5] \"FJ203391.1.1488\" \"FJ712534.1.1514\"\n\n\n\nshared_taxonomy &lt;- get_taxonomy(shared_asvs)\nprint(shared_taxonomy)\n\n                    Kingdom           Phylum               Class\nDQ811808.1.1527 d__Bacteria           MBNT15              MBNT15\nEU652571.1.1503 d__Bacteria   Proteobacteria Gammaproteobacteria\nGQ249585.1.1531 d__Bacteria Desulfobacterota     Desulfobacteria\nAM176885.1.1418 d__Bacteria   Proteobacteria Alphaproteobacteria\nFJ203391.1.1488 d__Bacteria            NB1-j               NB1-j\nFJ712534.1.1514 d__Bacteria    Calditrichota        Calditrichia\n                            Order             Family           Genus\nDQ811808.1.1527            MBNT15             MBNT15          MBNT15\nEU652571.1.1503   Nitrosococcales   Nitrosococcaceae            AqS1\nGQ249585.1.1531 Desulfobacterales Desulfosarcinaceae            &lt;NA&gt;\nAM176885.1.1418        uncultured         uncultured      uncultured\nFJ203391.1.1488             NB1-j              NB1-j           NB1-j\nFJ712534.1.1514    Calditrichales    Calditrichaceae Calditrichaceae\n                                        Species\nDQ811808.1.1527 uncultured_Syntrophobacteraceae\nEU652571.1.1503            uncultured_bacterium\nGQ249585.1.1531                            &lt;NA&gt;\nAM176885.1.1418     uncultured_Rhodobacteraceae\nFJ203391.1.1488                            &lt;NA&gt;\nFJ712534.1.1514                            &lt;NA&gt;\n\n\n\nshared_family &lt;- unique(shared_taxonomy$Family[!is.na(shared_taxonomy$Family)])\nprint(shared_family)\n\n[1] \"MBNT15\"             \"Nitrosococcaceae\"   \"Desulfosarcinaceae\"\n[4] \"uncultured\"         \"NB1-j\"              \"Calditrichaceae\"   \n\n\n\nshared_phyla &lt;- unique(shared_taxonomy$Phylum[!is.na(shared_taxonomy$Phylum)])\nprint(shared_phyla)\n\n[1] \"MBNT15\"           \"Proteobacteria\"   \"Desulfobacterota\" \"NB1-j\"           \n[5] \"Calditrichota\"",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#relative-abundance-of-core-asv",
    "href": "02.3.Coremicrobiome.html#relative-abundance-of-core-asv",
    "title": "Core microbiome",
    "section": "07. Relative abundance of core asv",
    "text": "07. Relative abundance of core asv\n\n# Filter\nphyseq_shared &lt;- prune_taxa(shared_asvs, physeq_qiime3)\notu_table(physeq_shared)\n\nOTU Table:          [6 taxa and 25 samples]\n                     taxa are rows\n                S1A015 S1B07 S2B07 S3A07 S4B07 S5A07 S5B07 S6A07 S6B07 S7A07\nDQ811808.1.1527    115   194    59   108    72   216   140    57   182    80\nEU652571.1.1503   5951 12881  5260  8577  6118 13519  8852  6312 11648  5638\nGQ249585.1.1531     67    75    33    19   283    23   112   231   217   284\nAM176885.1.1418    348   658   261   463   292   762   513   402   861   372\nFJ203391.1.1488      2    38    43    16    44    21    51    67     7    72\nFJ712534.1.1514    189    72    32     7   213   114    95   543   365   489\n                S7B07 SRR9973320 SRR9973321 SRR9973322 SRR9973323 SRR9973324\nDQ811808.1.1527    70        853        734        163          7        704\nEU652571.1.1503  5563        397        834         42          8        443\nGQ249585.1.1531   305        214        341        367         23        425\nAM176885.1.1418   270          9         22         13          4         90\nFJ203391.1.1488    28         24         16         13          0         11\nFJ712534.1.1514   380          8         29         12        152          8\n                SRR9973326 SRR9973327 SRR9973331 SRR9973332 SRR9973344\nDQ811808.1.1527        218        345        326        117       1206\nEU652571.1.1503        133        127         58          0        571\nGQ249585.1.1531        122        616        611         37        567\nAM176885.1.1418         34         61         43         17         16\nFJ203391.1.1488          4          8          7          2          9\nFJ712534.1.1514          4         18         42         14         24\n                SRR9973347 zr2502_14_R1.fastq.gz zr2502_1_R1.fastq.gz\nDQ811808.1.1527       1375                   354                   13\nEU652571.1.1503        565                    33                  205\nGQ249585.1.1531        522                    23                   33\nAM176885.1.1418        161                   109                   39\nFJ203391.1.1488         14                    10                   29\nFJ712534.1.1514         54                    28                   72\n                zr2502_37_R1.fastq.gz\nDQ811808.1.1527                   343\nEU652571.1.1503                   286\nGQ249585.1.1531                    16\nAM176885.1.1418                    31\nFJ203391.1.1488                    19\nFJ712534.1.1514                    58\n\n# rel abundance\nphyseq_rel &lt;- transform_sample_counts(physeq_shared, function(x){x / sum(x)})\notu_table(physeq_shared)\n\nOTU Table:          [6 taxa and 25 samples]\n                     taxa are rows\n                S1A015 S1B07 S2B07 S3A07 S4B07 S5A07 S5B07 S6A07 S6B07 S7A07\nDQ811808.1.1527    115   194    59   108    72   216   140    57   182    80\nEU652571.1.1503   5951 12881  5260  8577  6118 13519  8852  6312 11648  5638\nGQ249585.1.1531     67    75    33    19   283    23   112   231   217   284\nAM176885.1.1418    348   658   261   463   292   762   513   402   861   372\nFJ203391.1.1488      2    38    43    16    44    21    51    67     7    72\nFJ712534.1.1514    189    72    32     7   213   114    95   543   365   489\n                S7B07 SRR9973320 SRR9973321 SRR9973322 SRR9973323 SRR9973324\nDQ811808.1.1527    70        853        734        163          7        704\nEU652571.1.1503  5563        397        834         42          8        443\nGQ249585.1.1531   305        214        341        367         23        425\nAM176885.1.1418   270          9         22         13          4         90\nFJ203391.1.1488    28         24         16         13          0         11\nFJ712534.1.1514   380          8         29         12        152          8\n                SRR9973326 SRR9973327 SRR9973331 SRR9973332 SRR9973344\nDQ811808.1.1527        218        345        326        117       1206\nEU652571.1.1503        133        127         58          0        571\nGQ249585.1.1531        122        616        611         37        567\nAM176885.1.1418         34         61         43         17         16\nFJ203391.1.1488          4          8          7          2          9\nFJ712534.1.1514          4         18         42         14         24\n                SRR9973347 zr2502_14_R1.fastq.gz zr2502_1_R1.fastq.gz\nDQ811808.1.1527       1375                   354                   13\nEU652571.1.1503        565                    33                  205\nGQ249585.1.1531        522                    23                   33\nAM176885.1.1418        161                   109                   39\nFJ203391.1.1488         14                    10                   29\nFJ712534.1.1514         54                    28                   72\n                zr2502_37_R1.fastq.gz\nDQ811808.1.1527                   343\nEU652571.1.1503                   286\nGQ249585.1.1531                    16\nAM176885.1.1418                    31\nFJ203391.1.1488                    19\nFJ712534.1.1514                    58\n\n\n\n# Aggregate data by Mangrove_system\nphyseq_agg &lt;- merge_samples(physeq_rel, \"Mangrove_system\")\n\n# Convert to relative abundance\nphyseq_agg_rel &lt;- transform_sample_counts(physeq_agg, function(x) x / sum(x))\n\n# Map Mangrove_type back as a simple vector\nsample_data(physeq_agg_rel)$Mangrove_type &lt;- unlist(sapply(sample_names(physeq_agg_rel), function(sys) {\n  unique(sample_data(physeq_rel)[sample_data(physeq_rel)$Mangrove_system == sys, \"Mangrove_type\"])[1]\n}))\n\n\n# Create the bar plot with facet by Mangrove_type\nbarplot_core &lt;- phyloseq::plot_bar(physeq_agg_rel, fill = \"Family\") +\n    geom_bar(aes(color = Family, fill = Family), stat = \"identity\", position = \"stack\") +\n    labs(x = \"\", y = \"Relative Abundance\", element_text(size = 12)) +\n    facet_wrap(~ Mangrove_type, scales = \"free_x\", nrow = 1) +\n    scale_fill_manual(values = c(\"#2B0082\", \"#706AF5\", \"#77178F\",  \"#bfaDDC\", \"#724BB1\", \"#DADAEB\")) +\n    scale_color_manual(values = c(\"#2B0082\", \"#706AF5\", \"#77178F\",  \"#bfaDDC\", \"#724BB1\", \"#DADAEB\")) + # #716EC1\n  theme(axis.text = element_text(colour = \"black\", size = 12),\n        axis.title = element_text(colour = \"black\", size = 12),\n        legend.text = element_text(size = 12),\n        legend.title = element_text(size = 11),\n        axis.text.x = element_text(size = 9, angle = 0, \n                        hjust = 0.5, color = \"black\"),\n      axis.text.y = element_text(size = 11, color = \"black\"),\n      strip.text = element_text(size = 14, \n                                color = \"black\"), #face = \"bold\"\n      panel.background = element_blank())\n\nbarplot_core\n\n\n\n\n\n\n\n\npdf(\"Figures/SurfaceComparison/rel_abun_core.pdf\")\nbarplot_core\ndev.off()\n\nquartz_off_screen \n                2 \n\n\nExtract relative abundance info\n\notu_rel_df &lt;- psmelt(physeq_agg_rel)\notu_rel_df_agg &lt;- aggregate(Abundance ~ Sample + Family, data = otu_rel_df, sum)\nprint(otu_rel_df_agg)\n\n            Sample             Family Abundance\n1  Celestún Lagoon    Calditrichaceae   0.09042\n2    Fossil Lagoon    Calditrichaceae   0.05669\n3  San Pedro River    Calditrichaceae   0.01253\n4  Términos Lagoon    Calditrichaceae   0.10381\n5  Celestún Lagoon Desulfosarcinaceae   0.29453\n6    Fossil Lagoon Desulfosarcinaceae   0.03343\n7  San Pedro River Desulfosarcinaceae   0.01095\n8  Términos Lagoon Desulfosarcinaceae   0.04898\n9  Celestún Lagoon             MBNT15   0.39252\n10   Fossil Lagoon             MBNT15   0.01083\n11 San Pedro River             MBNT15   0.01323\n12 Términos Lagoon             MBNT15   0.37477\n13 Celestún Lagoon              NB1-j   0.00842\n14   Fossil Lagoon              NB1-j   0.00599\n15 San Pedro River              NB1-j   0.00361\n16 Términos Lagoon              NB1-j   0.03912\n17 Celestún Lagoon   Nitrosococcaceae   0.17525\n18   Fossil Lagoon   Nitrosococcaceae   0.84004\n19 San Pedro River   Nitrosococcaceae   0.91084\n20 Términos Lagoon   Nitrosococcaceae   0.32112\n21 Celestún Lagoon         uncultured   0.03886\n22   Fossil Lagoon         uncultured   0.05302\n23 San Pedro River         uncultured   0.04883\n24 Términos Lagoon         uncultured   0.11220",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.3.Coremicrobiome.html#save-rds-core-plot",
    "href": "02.3.Coremicrobiome.html#save-rds-core-plot",
    "title": "Core microbiome",
    "section": "Save rds core plot",
    "text": "Save rds core plot\n\nsaveRDS(upset_plot, \"rds/compare_mangroves/upset_surface_plot.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Core microbiome"
    ]
  },
  {
    "objectID": "02.4.DifferentialAbundance.html",
    "href": "02.4.DifferentialAbundance.html",
    "title": "Differential Abundance",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ANCOMBC)\nlibrary(tidyverse)\nlibrary(DT)\noptions(DT.options = list(\n  initComplete = JS(\"function(settings, json) {\",\n                    \"$(this.api().table().header()).css({'background-color':\n  '#000', 'color': '#fff'});\",\"}\")))\n\n\n#load data\nphyseq_qiime3 &lt;- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n\n\n# Rename mangrove system columna\ncolnames(sample_data(physeq_qiime3))[colnames(sample_data(physeq_qiime3)) == \"Mangrove system\"] &lt;- \"Mangrove_system\"\n\n# Convert Mangrove_system to factor\nsample_data(physeq_qiime3)$Mangrove_system &lt;- as.factor(sample_data(physeq_qiime3)$Mangrove_system)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "02.4.DifferentialAbundance.html#load-libraries-and-data",
    "href": "02.4.DifferentialAbundance.html#load-libraries-and-data",
    "title": "Differential Abundance",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ANCOMBC)\nlibrary(tidyverse)\nlibrary(DT)\noptions(DT.options = list(\n  initComplete = JS(\"function(settings, json) {\",\n                    \"$(this.api().table().header()).css({'background-color':\n  '#000', 'color': '#fff'});\",\"}\")))\n\n\n#load data\nphyseq_qiime3 &lt;- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n\n\n# Rename mangrove system columna\ncolnames(sample_data(physeq_qiime3))[colnames(sample_data(physeq_qiime3)) == \"Mangrove system\"] &lt;- \"Mangrove_system\"\n\n# Convert Mangrove_system to factor\nsample_data(physeq_qiime3)$Mangrove_system &lt;- as.factor(sample_data(physeq_qiime3)$Mangrove_system)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "02.4.DifferentialAbundance.html#differential-abundance-ancombc2",
    "href": "02.4.DifferentialAbundance.html#differential-abundance-ancombc2",
    "title": "Differential Abundance",
    "section": "01. Differential abundance ANCOMBC2",
    "text": "01. Differential abundance ANCOMBC2\n01.1 Prepare data\n\n# phyloseq to TreeSummarizedExperiment\ntse &lt;- mia::convertFromPhyloseq(physeq_qiime3)\n\n\n#To manually change the reference level, not alphabetic order\ntse$Mangrove_system = factor(tse$Mangrove_system, levels = c(\"Fossil Lagoon\", \"San Pedro River\", \"Términos Lagoon\", \"Celestún Lagoon\"))\n\n\n#conver to factor using letter levels\ntse$Mangrove_system &lt;- factor(recode\n                              (as.character(tse$Mangrove_system),\n                                    `Fossil Lagoon` = \"FL\",\n                                    `San Pedro River` = \"SPR\",\n                                    `Términos Lagoon` = \"TL\",\n                                    `Celestún Lagoon` = \"CL\",\n                                    .missing = \"unknown\"),\n                             levels = c(\"FL\", \"SPR\", \"TL\", \"CL\"))\n\n\n# contrast matrix\ncontrast_matrices &lt;- list(\n  matrix(c(1, -1, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, -1,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, -1, 0,\n           0, 1, 0,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE))\n\n# nodes\nnodes &lt;- list(1, 1, 1, 1)\n\n01.2 Run ANCOM-BC2\n\n# ANCOMBC2\noutput &lt;- ancombc2(\n  data = tse,\n  assay_name = \"counts\",\n  tax_level = \"Phylum\",\n  fix_formula = \"Mangrove_system\",\n  rand_formula = NULL,\n  p_adj_method = \"BH\",\n  pseudo_sens = TRUE,\n  prv_cut = 0.10,\n  lib_cut = 1000,\n  s0_perc = 0.05,\n  group = \"Mangrove_system\",\n  struc_zero = TRUE,\n  neg_lb = TRUE,\n  alpha = 0.05,\n  n_cl = 2,\n  verbose = TRUE,\n  global = TRUE,\n  pairwise = TRUE,\n  dunnet = TRUE,\n  trend = TRUE,\n  iter_control = list(tol = 1e-2, max_iter = 20, verbose = TRUE),\n  em_control = list(tol = 1e-5, max_iter = 100),\n  lme_control = lme4::lmerControl(),\n  mdfdr_control = list(fwer_ctrl_method = \"BH\", B = 100),\n  trend_control = list(\n    contrast = contrast_matrices,\n    node = nodes,\n    solver = \"ECOS\",\n    B = 100\n  )\n)\n\nChecking the input data type ...\n\n\nThe input data is of type: TreeSummarizedExperiment\n\n\nPASS\n\n\nChecking the sample metadata ...\n\n\nThe specified variables in the formula: Mangrove_system\n\n\nThe available variables in the sample metadata: SampleID, BioSample, ID, SRA, SampleName, Collection_date, depth, site, elevation, Broad_scale_environmental_context, Local_scale_environmental_context, Environmental_medium, Latitude_and_Longitude, Geographic.Location, Study_zone, Ecological_type, Parametros, Temperatura, Salinidad, pH, Redox.mV, S.2, SO4, season, filter, Mangrove_system, Mangrove_type\n\n\nPASS\n\n\nChecking other arguments ...\n\n\nThe number of groups of interest is: 4\n\n\nThe sample size per group is: FL = 4, SPR = 7, TL = 3, CL = 11\n\n\nWarning: Small sample size detected for the following group(s): \nFL, TL\nVariance estimation would be unstable when the sample size is &lt; 5 per group\n\n\nPASS\n\n\nObtaining initial estimates ...\n\n\nML iteration = 1, epsilon = 1.1\n\n\nML iteration = 2, epsilon = 7.1\n\n\nML iteration = 3, epsilon = 0.92\n\n\nML iteration = 4, epsilon = 0.31\n\n\nML iteration = 5, epsilon = 0.19\n\n\nML iteration = 6, epsilon = 0.13\n\n\nML iteration = 7, epsilon = 0.083\n\n\nML iteration = 8, epsilon = 0.055\n\n\nML iteration = 9, epsilon = 0.036\n\n\nML iteration = 10, epsilon = 0.024\n\n\nML iteration = 11, epsilon = 0.016\n\n\nML iteration = 12, epsilon = 0.011\n\n\nML iteration = 13, epsilon = 0.007\n\n\nEstimating sample-specific biases ...\n\n\nConducting sensitivity analysis for pseudo-count addition to 0s ...\nFor taxa that are significant but do not pass the sensitivity analysis,\nplease flag them and proceed with caution, as they are likely false positives.\nFor detailed instructions on performing sensitivity analysis,\nplease refer to the package vignette.\n\n\nANCOM-BC2 primary results ...\n\n\nANCOM-BC2 global test ...\n\n\nANCOM-BC2 multiple pairwise comparisons ...\n\n\nANCOM-BC2 multiple pairwise comparisons against the reference group ...\n\n\nANCOM-BC2 pattern analysis ...\n\n\n\n#See results\nres_pair_Mangrove_system &lt;- output$res_pair\n\nhead(res_pair_Mangrove_system)\n\n             taxon lfc_Mangrove_systemSPR lfc_Mangrove_systemTL\n1  Acidobacteriota               -0.26768                 -3.39\n2 Actinobacteriota               -0.23213                 -3.71\n3  Asgardarchaeota                0.26584                 -3.47\n4     Bacteroidota               -0.48731                 -4.52\n5    Calditrichota               -0.16945                 -2.37\n6 Campilobacterota                0.00556                 -2.60\n  lfc_Mangrove_systemCL lfc_Mangrove_systemTL_Mangrove_systemSPR\n1                -0.490                                    -3.13\n2                -0.626                                    -3.47\n3                -0.589                                    -3.74\n4                -0.942                                    -4.03\n5                -0.264                                    -2.20\n6                -1.794                                    -2.61\n  lfc_Mangrove_systemCL_Mangrove_systemSPR\n1                                  -0.2225\n2                                  -0.3937\n3                                  -0.8550\n4                                  -0.4543\n5                                  -0.0946\n6                                  -1.7995\n  lfc_Mangrove_systemCL_Mangrove_systemTL se_Mangrove_systemSPR\n1                                   2.904                 0.158\n2                                   3.080                 0.133\n3                                   2.882                 0.311\n4                                   3.580                 0.139\n5                                   2.110                 0.223\n6                                   0.806                 0.370\n  se_Mangrove_systemTL se_Mangrove_systemCL\n1                0.268                0.166\n2                0.898                0.195\n3                0.380                0.434\n4                0.921                0.209\n5                0.283                0.245\n6                0.449                0.469\n  se_Mangrove_systemTL_Mangrove_systemSPR\n1                                   0.292\n2                                   0.903\n3                                   0.298\n4                                   0.924\n5                                   0.295\n6                                   0.323\n  se_Mangrove_systemCL_Mangrove_systemSPR\n1                                   0.203\n2                                   0.217\n3                                   0.405\n4                                   0.220\n5                                   0.258\n6                                   0.431\n  se_Mangrove_systemCL_Mangrove_systemTL W_Mangrove_systemSPR\n1                                  0.297               -1.699\n2                                  0.914               -1.743\n3                                  0.435                0.856\n4                                  0.937               -3.500\n5                                  0.311               -0.759\n6                                  0.452                0.015\n  W_Mangrove_systemTL W_Mangrove_systemCL\n1              -12.68               -2.96\n2               -4.13               -3.20\n3               -9.13               -1.36\n4               -4.91               -4.50\n5               -8.39               -1.08\n6               -5.80               -3.82\n  W_Mangrove_systemTL_Mangrove_systemSPR W_Mangrove_systemCL_Mangrove_systemSPR\n1                                 -10.69                                 -1.094\n2                                  -3.85                                 -1.812\n3                                 -12.56                                 -2.112\n4                                  -4.37                                 -2.065\n5                                  -7.48                                 -0.366\n6                                  -8.07                                 -4.179\n  W_Mangrove_systemCL_Mangrove_systemTL p_Mangrove_systemSPR\n1                                  9.78              0.10412\n2                                  3.37              0.09592\n3                                  6.62              0.40222\n4                                  3.82              0.00213\n5                                  6.78              0.45646\n6                                  1.78              0.98818\n  p_Mangrove_systemTL p_Mangrove_systemCL\n1            2.61e-11            0.007550\n2            4.81e-04            0.004254\n3            1.42e-08            0.189976\n4            7.44e-05            0.000196\n5            3.81e-08            0.293187\n6            1.39e-05            0.001144\n  p_Mangrove_systemTL_Mangrove_systemSPR p_Mangrove_systemCL_Mangrove_systemSPR\n1                               5.93e-10                               0.286427\n2                               9.40e-04                               0.084249\n3                               6.07e-11                               0.047481\n4                               2.70e-04                               0.051516\n5                               2.37e-07                               0.717960\n6                               1.47e-07                               0.000509\n  p_Mangrove_systemCL_Mangrove_systemTL q_Mangrove_systemSPR\n1                              2.86e-09              0.13119\n2                              2.91e-03              0.10071\n3                              1.89e-06              0.42233\n4                              9.95e-04              0.00269\n5                              1.06e-06              0.57514\n6                              9.06e-02              1.00000\n  q_Mangrove_systemTL q_Mangrove_systemCL\n1            1.65e-10            0.011892\n2            2.96e-03            0.006700\n3            4.46e-08            0.239369\n4            4.69e-04            0.000567\n5            2.40e-07            0.461769\n6            4.37e-05            0.001801\n  q_Mangrove_systemTL_Mangrove_systemSPR q_Mangrove_systemCL_Mangrove_systemSPR\n1                               1.87e-09                                0.30075\n2                               2.96e-03                                0.10071\n3                               3.82e-10                                0.07478\n4                               5.67e-04                                0.05409\n5                               7.48e-07                                0.75386\n6                               9.26e-07                                0.00107\n  q_Mangrove_systemCL_Mangrove_systemTL diff_Mangrove_systemSPR\n1                              6.01e-09                   FALSE\n2                              6.11e-03                   FALSE\n3                              3.97e-06                   FALSE\n4                              1.57e-03                    TRUE\n5                              2.22e-06                   FALSE\n6                              1.14e-01                   FALSE\n  diff_Mangrove_systemTL diff_Mangrove_systemCL\n1                   TRUE                   TRUE\n2                   TRUE                   TRUE\n3                   TRUE                  FALSE\n4                   TRUE                   TRUE\n5                   TRUE                  FALSE\n6                   TRUE                   TRUE\n  diff_Mangrove_systemTL_Mangrove_systemSPR\n1                                      TRUE\n2                                      TRUE\n3                                      TRUE\n4                                      TRUE\n5                                      TRUE\n6                                      TRUE\n  diff_Mangrove_systemCL_Mangrove_systemSPR\n1                                     FALSE\n2                                     FALSE\n3                                     FALSE\n4                                     FALSE\n5                                     FALSE\n6                                      TRUE\n  diff_Mangrove_systemCL_Mangrove_systemTL passed_ss_Mangrove_systemSPR\n1                                     TRUE                         TRUE\n2                                     TRUE                         TRUE\n3                                     TRUE                         TRUE\n4                                     TRUE                        FALSE\n5                                     TRUE                         TRUE\n6                                    FALSE                         TRUE\n  passed_ss_Mangrove_systemTL passed_ss_Mangrove_systemCL\n1                        TRUE                        TRUE\n2                        TRUE                       FALSE\n3                        TRUE                        TRUE\n4                        TRUE                        TRUE\n5                        TRUE                        TRUE\n6                        TRUE                       FALSE\n  passed_ss_Mangrove_systemTL_Mangrove_systemSPR\n1                                           TRUE\n2                                           TRUE\n3                                           TRUE\n4                                           TRUE\n5                                           TRUE\n6                                           TRUE\n  passed_ss_Mangrove_systemCL_Mangrove_systemSPR\n1                                           TRUE\n2                                           TRUE\n3                                          FALSE\n4                                           TRUE\n5                                           TRUE\n6                                           TRUE\n  passed_ss_Mangrove_systemCL_Mangrove_systemTL\n1                                          TRUE\n2                                          TRUE\n3                                          TRUE\n4                                          TRUE\n5                                          TRUE\n6                                          TRUE",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "02.4.DifferentialAbundance.html#get-differential-data",
    "href": "02.4.DifferentialAbundance.html#get-differential-data",
    "title": "Differential Abundance",
    "section": "02. Get differential data",
    "text": "02. Get differential data\n\n# Create dataframe df_fig_pair1 to log-fold change (LFC) values\ndf_fig_pair1_Mangrove_system &lt;- res_pair_Mangrove_system %&gt;%\n  dplyr::filter(`diff_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemTL` == 1 |\n                `diff_Mangrove_systemCL` == 1 |\n                `diff_Mangrove_systemTL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemTL` == 1) %&gt;%\n  dplyr::mutate(lfc1 = ifelse(`diff_Mangrove_systemSPR` == 1, \n                      round(`lfc_Mangrove_systemSPR`, 2), NA),\n                lfc2 = ifelse(`diff_Mangrove_systemTL` == 1, \n                      round(`lfc_Mangrove_systemTL`, 2), NA),\n                lfc3 = ifelse(`diff_Mangrove_systemCL` == 1, \n                      round(`lfc_Mangrove_systemCL`, 2), NA),\n                lfc4 = ifelse(`diff_Mangrove_systemTL_Mangrove_systemSPR` == 1, \n                      round(`lfc_Mangrove_systemTL_Mangrove_systemSPR`, 2), NA),\n                lfc5 = ifelse(`diff_Mangrove_systemCL_Mangrove_systemSPR` == 1, \n                      round(`lfc_Mangrove_systemCL_Mangrove_systemSPR`, 2), NA),\n                lfc6 = ifelse(`diff_Mangrove_systemCL_Mangrove_systemTL` == 1, \n                      round(`lfc_Mangrove_systemCL_Mangrove_systemTL`, 2), NA),\n                ) %&gt;% tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", \n                          values_to = \"value\") %&gt;% dplyr::arrange(taxon)\n\n\n# Create dataframe df_fig_pair2 to significant values\ndf_fig_pair2_Mangrove_system &lt;- res_pair_Mangrove_system %&gt;%\n  dplyr::filter(`diff_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemTL` == 1 |\n                `diff_Mangrove_systemCL` == 1 |\n                `diff_Mangrove_systemTL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemSPR` == 1 |\n                `diff_Mangrove_systemCL_Mangrove_systemTL` == 1) %&gt;%\n   dplyr::mutate(lfc1 = ifelse(`passed_ss_Mangrove_systemSPR` == 1 & \n                `diff_Mangrove_systemSPR` == 1, \"darkblue\", \"black\"),\n                lfc2 = ifelse(`passed_ss_Mangrove_systemTL` == 1 & \n                `diff_Mangrove_systemTL` == 1, \"darkblue\", \"black\"),\n                lfc3 = ifelse(`passed_ss_Mangrove_systemCL` == 1 &\n                `diff_Mangrove_systemCL` == 1, \"darkblue\", \"black\"),\n                lfc4 = ifelse(`passed_ss_Mangrove_systemTL_Mangrove_systemSPR` == 1 &\n                `diff_Mangrove_systemTL_Mangrove_systemSPR` == 1, \"darkblue\", \"black\"),\n                lfc5 = ifelse(`passed_ss_Mangrove_systemCL_Mangrove_systemSPR` == 1 &\n                `diff_Mangrove_systemCL_Mangrove_systemSPR` == 1, \"darkblue\", \"black\"),\n                lfc6 = ifelse(`passed_ss_Mangrove_systemCL_Mangrove_systemTL` == 1 &\n                `diff_Mangrove_systemCL_Mangrove_systemTL` == 1, \"darkblue\", \"black\")) %&gt;% \n  tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", values_to = \"color\") %&gt;% dplyr::arrange(taxon)\n\n\n# Combine dataframes df_fig_pair1 and df_fig_pair2\ndf_fig_pair_Mangrove_system &lt;- df_fig_pair1_Mangrove_system %&gt;%\n  dplyr::left_join(df_fig_pair2_Mangrove_system, by = c(\"taxon\", \"group\"))\n\n# Rename groups\ndf_fig_pair_Mangrove_system$group &lt;- recode(df_fig_pair_Mangrove_system$group,\n                                     `lfc1` = \"SPR vs FL\",\n                                     `lfc2` = \"TL vs FL\",\n                                     `lfc3` = \"CL vs FL\",\n                                     `lfc4` = \"TL vs SPR\",\n                                     `lfc5` = \"CL vs SPR\",\n                                     `lfc6` = \"CL vs TL\")\n\ndf_fig_pair_Mangrove_system$group &lt;- factor(df_fig_pair_Mangrove_system$group,\n                                     levels = c(\"SPR vs FL\",\n                                                \"TL vs FL\",\n                                                \"CL vs FL\",\n                                                \"TL vs SPR\",\n                                                \"CL vs SPR\",\n                                                \"CL vs TL\"))\n\n# Filter comparisons without significant values\ndf_fig_pair_Mangrove_system &lt;- df_fig_pair_Mangrove_system %&gt;%\n  group_by(group) %&gt;%\n  filter(any(!is.na(value))) %&gt;%\n  ungroup()\n\n# Calculate limits\nlo &lt;- floor(min(df_fig_pair_Mangrove_system$value, na.rm = TRUE))\nup &lt;- ceiling(max(df_fig_pair_Mangrove_system$value, na.rm = TRUE))\nmid &lt;- (lo + up) / 2",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "02.4.DifferentialAbundance.html#plot",
    "href": "02.4.DifferentialAbundance.html#plot",
    "title": "Differential Abundance",
    "section": "03. Plot",
    "text": "03. Plot\n\n# heatmap\nheatmap_fig_pair_Mangrove_system &lt;- df_fig_pair_Mangrove_system %&gt;%\n  ggplot(aes(x = group, y = taxon, fill = value)) +\n  geom_tile(color = \"gray50\") +\n  scale_fill_gradient2(low = \"#37485FFF\", high = \"#907c9BFf\", mid = \"#cad8DCFF\", #a71a50\n                       na.value = \"white\", midpoint = mid, limit = c(lo, up),\n                       name = \"LFC\") +\n  geom_text(aes(label = round(value, 2), color = color), size = 3.5, na.rm = TRUE) +\n  scale_color_identity(guide = FALSE) +\n  labs(x = NULL, y = NULL, title = \"Differential abundance between mangrove system\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, size = 13),\n        axis.text.y = element_text(size = 12, color = \"black\"),\n        axis.text.x = element_text(size = 9, angle = 0, \n                                   hjust = 0.5, color = \"black\"))\n\n# show\nprint(heatmap_fig_pair_Mangrove_system)\n\nWarning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in\nggplot2 3.3.4.\nℹ Please use \"none\" instead.\n\n\n\n\n\n\n\n\n\n# DA barplot\nlibrary(paletteer)\nda_barplot &lt;- df_fig_pair_Mangrove_system %&gt;%\n  ggplot(aes(x = taxon, y = value, fill = group, label = round(value, 2))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_paletteer_d(\"ggsci::blue_grey_material\") + #\"rcartocolor::Purp\"\n  # scale_fill_manual(values = c(\"SPR vs FL\" = \"orange\",\n  #                              \"TL vs FL\" = \"#a71b40\",\n  #                              \"CL vs FL\" = \"yellow3\",\n  #                              \"TL vs SPR\" = \"gray50\",\n  #                              \"CL vs SPR\" = \"#af4b91\",\n  #                              \"CL vs TL\" = \"#466eb4\")) +\n  labs(title = \"Differential Abundance by Mangrove system\",\n       x = \"Phylum\",\n       y = \"Log-Fold Change\",\n       fill = \"Comparison\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10),\n        axis.text.y = element_text(size = 8),\n        plot.title = element_text(size = 12),\n        axis.title.x = element_text(size = 9),              \n        axis.title.y = element_text(size = 9),            \n        legend.title = element_text(size = 9))\n\n#show\nda_barplot",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "02.4.DifferentialAbundance.html#save-rds-plot",
    "href": "02.4.DifferentialAbundance.html#save-rds-plot",
    "title": "Differential Abundance",
    "section": "Save rds plot",
    "text": "Save rds plot\n\nsaveRDS(heatmap_fig_pair_Mangrove_system, \"rds/compare_mangroves/DA_heatmap_surface.rds\")\nsaveRDS(da_barplot, \"rds/compare_mangroves/DA_barplot_surface.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "03.InteriorMangroves.html",
    "href": "03.InteriorMangroves.html",
    "title": "Interior Mangroves Exploration",
    "section": "",
    "text": "This section focuses on comparisons between mangrove systems sites across San Pedro River inland mangroves in order to answer the following:\n\nHow is the diversity and structure of the microbial community in inland mangroves.\nConsidering that the Fossil Lagoon, with less anthropogenic exposure, is in the upper part of the river and the Reforma Waterfalls and Miguelito Dike, with more urban exposure, are in the lower part of the river:\nHow different are the upstream and downstream mangroves?\nWho are the drivers of the differences we see between these systems?\nWhich actors are preserved along the river regardless of environmental differences?",
    "crumbs": [
      "Interior mangroves explore"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html",
    "href": "02.2.BetaDiversity.html",
    "title": "Beta diversity",
    "section": "",
    "text": "Tip\n\n\n\nThe analysis of beta diversity was conducted using both NMDS and PERMANOVA to identify the factors that influenced the structure of the microbial community.",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html#load-libraries-and-prepare-data",
    "href": "02.2.BetaDiversity.html#load-libraries-and-prepare-data",
    "title": "Beta diversity",
    "section": "Load libraries and prepare data",
    "text": "Load libraries and prepare data\n\n# load libraries\nlibrary(vegan)\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(pairwiseAdonis)\nlibrary(reshape2)\n\n\n#load data\nphyseq_qiime3 &lt;- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n\n\n#Mangrove system colors\nloc_colors &lt;- c(\"Fossil Lagoon\"= \"#A7fcc1\",\n                \"San Pedro River\" = \"#26B170\",\n                \"Términos Lagoon\" = \"#329D9C\",\n                \"Celestún Lagoon\" = \"#41e8d3\")\n\n\n# Extract data from phyloseq object\n#library(phyloseq)\notu_data &lt;- otu_table(physeq_qiime3, taxa_are_rows = TRUE)\nmetadata &lt;- as(sample_data(physeq_qiime3), \"data.frame\")\n\nsample_data &lt;- data.frame(sample_data(physeq_qiime3))",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html#nmds",
    "href": "02.2.BetaDiversity.html#nmds",
    "title": "Beta diversity",
    "section": "01. NMDS",
    "text": "01. NMDS\nGet distances and stress\n\n\n\n\n\n\nNote\n\n\n\nBray-Curtis dissimilarity distances are a measure of the dissimilarity between microbial communities based on their species composition.\n\n\n\n# library(vegan)\n# library(dplyr)\n# distances\nset.seed(123)\nbray=vegdist(t(otu_data), method = \"bray\")\nnmds_source_bray = vegan::metaMDS(bray, trymax = 20, k = 2)\n\nRun 0 stress 0.11 \nRun 1 stress 0.078 \n... New best solution\n... Procrustes: rmse 0.111  max resid 0.476 \nRun 2 stress 0.161 \nRun 3 stress 0.078 \n... Procrustes: rmse 4.1e-05  max resid 0.00012 \n... Similar to previous best\nRun 4 stress 0.11 \nRun 5 stress 0.133 \nRun 6 stress 0.11 \nRun 7 stress 0.078 \n... Procrustes: rmse 1.87e-05  max resid 6.06e-05 \n... Similar to previous best\nRun 8 stress 0.161 \nRun 9 stress 0.0782 \n... Procrustes: rmse 0.015  max resid 0.057 \nRun 10 stress 0.133 \nRun 11 stress 0.11 \nRun 12 stress 0.166 \nRun 13 stress 0.145 \nRun 14 stress 0.078 \n... Procrustes: rmse 4.39e-05  max resid 0.000144 \n... Similar to previous best\nRun 15 stress 0.0782 \n... Procrustes: rmse 0.015  max resid 0.0572 \nRun 16 stress 0.0782 \n... Procrustes: rmse 0.015  max resid 0.0571 \nRun 17 stress 0.155 \nRun 18 stress 0.0782 \n... Procrustes: rmse 0.015  max resid 0.0572 \nRun 19 stress 0.0782 \n... Procrustes: rmse 0.015  max resid 0.0571 \nRun 20 stress 0.078 \n... New best solution\n... Procrustes: rmse 4.37e-05  max resid 0.000133 \n... Similar to previous best\n*** Best solution repeated 1 times\n\n# stress\nvar_stress_nmds_bray &lt;- round(nmds_source_bray$stress, 5)\n\n# score\nscores_source_bray= nmds_source_bray %&gt;% vegan::scores()\n\nPlot\n\n# library(ggplot2)\n# library(tidyverse)\n\nnmds_plot_bray &lt;- ggplot() +\n  geom_point(data=data.frame(scores_source_bray) %&gt;%\n               rownames_to_column(var = \"SampleID\")%&gt;%\n               left_join(metadata, by = \"SampleID\"),\n             aes(x=NMDS1, y=NMDS2,  color = Mangrove.system, \n                 shape = Mangrove_type),\n             size=5) + theme_linedraw()+\n  scale_fill_manual(values = loc_colors)+\n  scale_color_manual(values = loc_colors)+\n  theme(axis.text = element_text(colour = \"black\", size = 12),\n        axis.title = element_text(colour = \"black\", size = 12),\n        legend.text = element_text(size = 10),\n        legend.title = element_text(size = 12),\n        legend.position = \"right\",\n        legend.box = \"vertical\")+ theme_classic() +\n  labs(title=\"Bray-Curtis distances\") +\n  ylab(\"NMDS2\")+xlab(\"NMDS1\")\n\n## stress legend\nnmds_plot_bray &lt;- nmds_plot_bray +\n  annotate(\"text\", x = Inf, y = -Inf,\n           label = paste(\"Stress:\", var_stress_nmds_bray),\n           hjust = 1.1, vjust = -1.1, size = 4)\n\n# show plot\nnmds_plot_bray",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html#permanova",
    "href": "02.2.BetaDiversity.html#permanova",
    "title": "Beta diversity",
    "section": "02. PERMANOVA",
    "text": "02. PERMANOVA\n\n\n\n\n\n\nNote\n\n\n\nTo test the effects of Mangrove type and Mangrove system on the Bray-Curtis dissimilarity, a PERMANOVA analysis was conducted using adonis2.\n\n\n\n# Extract and transpose OTU table\notu_mat &lt;- t(otu_table(physeq_qiime3))\n\n# PERMANOVA with adonis2\nset.seed(123)\nadonis_result &lt;- adonis2(otu_mat ~ Mangrove_type * Mangrove.system,\n                         data = sample_data,\n                         method = \"bray\",\n                         permutations = 999,\n                         by = \"terms\")\n\n# show adonis result\nprint(adonis_result)\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 999\n\nadonis2(formula = otu_mat ~ Mangrove_type * Mangrove.system, data = sample_data, permutations = 999, method = \"bray\", by = \"terms\")\n                Df SumOfSqs    R2     F Pr(&gt;F)    \nMangrove_type    1     1.77 0.283 11.60  0.001 ***\nMangrove.system  2     1.29 0.206  4.23  0.001 ***\nResidual        21     3.20 0.511                 \nTotal           24     6.25 1.000                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nPlot with PERMANOVA results\n\n#add to plot\nnmds_plot_bray_perm &lt;- nmds_plot_bray + annotate(\"text\", x = Inf, y = -Inf,\n           label = paste(\"PERMANOVA:\",\n                         \"Mangrove system: R² = 0.206, p = 0.001\\n\",\n                         \"Mangrove type: R² = 0.283, p = 0.001\\n\",\n                         \"Residual: R² = 0.511\"),\n           hjust = 1.1, vjust = -7, size = 4)\n\n# Mostrar el gráfico\nprint(nmds_plot_bray_perm)\n\n\n\n\n\n\n#save\nggsave(\"Figures/SurfaceComparison/beta-diversity.pdf\", nmds_plot_bray_perm, width = 7.3, height = 5.5)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html#post-hoc-adonis",
    "href": "02.2.BetaDiversity.html#post-hoc-adonis",
    "title": "Beta diversity",
    "section": "03. Post-hoc adonis",
    "text": "03. Post-hoc adonis\n\n\n\n\n\n\nNote\n\n\n\nTo test differences between the Mangrove systems a Post-hoc pairwise PERMANOVA was conducted using pairwise.adonis\n\n\nPairwise adonis\n\n## Post-hoc Mangrove.system\n#library(pairwiseAdonis)\npairwise_adonis &lt;- pairwiseAdonis::pairwise.adonis2(otu_mat ~ \n                  Mangrove.system, data = sample_data, \n                  method = \"bray\",  permutations = 999)\n\nSet of permutations &lt; 'minperm'. Generating entire set.\n\nprint(pairwise_adonis)\n\n$parent_call\n[1] \"otu_mat ~ Mangrove.system , strata = Null , permutations 999\"\n\n$`San Pedro River_vs_Fossil Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)   \nModel     1    0.274 0.256 3.09  0.003 **\nResidual  9    0.798 0.744               \nTotal    10    1.071 1.000               \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`San Pedro River_vs_Celestún Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)    \nModel     1     1.39 0.378 9.73  0.001 ***\nResidual 16     2.28 0.622                \nTotal    17     3.67 1.000                \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`San Pedro River_vs_Términos Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)  \nModel     1     1.15 0.476 7.26  0.014 *\nResidual  8     1.26 0.524              \nTotal     9     2.41 1.000              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Fossil Lagoon_vs_Celestún Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)   \nModel     1     1.04 0.351 7.03  0.004 **\nResidual 13     1.93 0.649               \nTotal    14     2.98 1.000               \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Fossil Lagoon_vs_Términos Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)  \nModel     1    1.005 0.523 5.48  0.035 *\nResidual  5    0.916 0.477              \nTotal     6    1.921 1.000              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Celestún Lagoon_vs_Términos Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)   \nModel     1     1.01 0.297 5.07  0.003 **\nResidual 12     2.40 0.703               \nTotal    13     3.41 1.000               \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nattr(,\"class\")\n[1] \"pwadstrata\" \"list\"      \n\n\nP-values matrix\n\n# heatmap \n# library(ggplot2)\n# library(reshape2)\n\n#  p-values of pairwise_adonis\np_values &lt;- c(\n  \"San Pedro River_vs_Fossil Lagoon\" = 0.004,\n  \"San Pedro River_vs_Celestún Lagoon\" = 0.001,\n  \"San Pedro River_vs_Términos Lagoon\" = 0.007,\n  \"Fossil Lagoon_vs_Celestún Lagoon\" = 0.001,\n  \"Fossil Lagoon_vs_Términos Lagoon\" = 0.02,\n  \"Celestún Lagoon_vs_Términos Lagoon\" = 0.003\n)\n\n# matrix of p-values\nlocations &lt;- c(\"San Pedro River\", \"Fossil Lagoon\", \"Celestún Lagoon\", \"Términos Lagoon\")\np_matrix &lt;- matrix(NA, nrow = length(locations), ncol = length(locations),\n                   dimnames = list(locations, locations))\n\n# Fill matrix with p-values (only for the upper half then make symmetrical)\npairs &lt;- strsplit(names(p_values), \"_vs_\")\nfor (i in seq_along(pairs)) {\n  row_name &lt;- pairs[[i]][1]\n  col_name &lt;- pairs[[i]][2]\n  p_matrix[row_name, col_name] &lt;- p_values[i]\n  p_matrix[col_name, row_name] &lt;- p_values[i]  # symmetrical\n}\ndiag(p_matrix) &lt;- 1  # compare with itself\n\n# long format\np_melt &lt;- melt(p_matrix)\n\nHeatmap of adonis posthoc\n\n# heatmap\nheatmap_plot &lt;- ggplot(p_melt, aes(x = Var1, y = Var2, fill = value)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\",\n                       midpoint = 0.025, limits = c(0, 0.05),\n                       name = \"p-value\") +\n  geom_text(aes(label = sprintf(\"%.3f\", value)), color = \"black\", size = 3) +\n  theme_minimal() +\n  labs(title = \"Pairwise PERMANOVA post-hoc)\",\n       x = \"Mangrove system\", y = \"Mangrove system\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        axis.title = element_text(size = 12),\n        plot.title = element_text(size = 14))\n\n# show\nprint(heatmap_plot)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html#beta-disper",
    "href": "02.2.BetaDiversity.html#beta-disper",
    "title": "Beta diversity",
    "section": "04. Beta disper",
    "text": "04. Beta disper\n\n\n\n\n\n\nNote\n\n\n\nTo validate the dissimilarity of the data, and to determine whether the differences found are due to changes in composition or to variations in dispersion within groups, the homogeneity of the dispersions between Mangrove type and Mangrove system was calculated using betadisper. Subsequently, the significance of the differences in dispersion was calculated with permutest\n\n\n\n# library(vegan)\n# library(phyloseq)\n# Bray distance matrix\ndist_matrix &lt;- phyloseq::distance(physeq_qiime3, method = \"bray\")\n\nBy Mangrove system\n\n# betadisper\ndisp_location &lt;- betadisper(dist_matrix, sample_data$Mangrove.system)\nprint(summary(disp_location))\n\n                Length Class  Mode   \neig              24    -none- numeric\nvectors         600    -none- numeric\ndistances        25    -none- numeric\ngroup            25    factor numeric\ncentroids        96    -none- numeric\ngroup.distances   4    -none- numeric\ncall              3    -none- call   \n\n\nPermutest\n\n# Significance permutest\nperm_location &lt;- permutest(disp_location, permutations = 999)\nprint(perm_location)\n\n\nPermutation test for homogeneity of multivariate dispersions\nPermutation: free\nNumber of permutations: 999\n\nResponse: Distances\n          Df Sum Sq Mean Sq    F N.Perm Pr(&gt;F)  \nGroups     3  0.143  0.0476 4.55    999  0.022 *\nResiduals 21  0.220  0.0105                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# Plots\nplot(disp_location, main = \"Beta Dispersión por Mangrove system\")\n\n\n\n\n\n\nboxplot(disp_location, main = \"Distancias al centroide por Mangrove system\")\n\n\n\n\n\n\n\nBy Mangrove type\n\n# Betadisper Mangrove_type\ndisp_mangrove_type &lt;- betadisper(dist_matrix, sample_data$Mangrove_type)\nprint(summary(disp_mangrove_type))\n\n                Length Class  Mode   \neig              24    -none- numeric\nvectors         600    -none- numeric\ndistances        25    -none- numeric\ngroup            25    factor numeric\ncentroids        48    -none- numeric\ngroup.distances   2    -none- numeric\ncall              3    -none- call   \n\n# Significance permutest\nperm_mangrove_type &lt;- permutest(disp_mangrove_type, permutations = 999)\nprint(perm_mangrove_type)\n\n\nPermutation test for homogeneity of multivariate dispersions\nPermutation: free\nNumber of permutations: 999\n\nResponse: Distances\n          Df Sum Sq Mean Sq   F N.Perm Pr(&gt;F)  \nGroups     1  0.154  0.1537 7.2    999  0.014 *\nResiduals 23  0.491  0.0213                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# plots\nplot(disp_mangrove_type, main = \"Betadisper  Mangrove_type\")\n\n\n\n\n\n\nboxplot(disp_mangrove_type, main = \"Dist to centroid Mangrove_type\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.2.BetaDiversity.html#save-rds-beta-diversity-plot",
    "href": "02.2.BetaDiversity.html#save-rds-beta-diversity-plot",
    "title": "Beta diversity",
    "section": "Save rds beta diversity plot",
    "text": "Save rds beta diversity plot\n\nsaveRDS(nmds_plot_bray_perm, \"rds/compare_mangroves/beta-diversity-surface-plot.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.SurfaceComparison.html",
    "href": "02.SurfaceComparison.html",
    "title": "Data Prepare",
    "section": "",
    "text": "How similar are coastal and inland mangroves❓\n\n\n\nTo answer this question, only samples that met the selection criteria were selected for comparison with each other. These samples were as follows:\n\nThey hailed from the same depth range.\nThey hailed from the strip, in the case of coastal mangroves.\nThey hailed from the flooding season, in the case of coastal mangroves.",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Data Prepare"
    ]
  },
  {
    "objectID": "02.SurfaceComparison.html#select-samples",
    "href": "02.SurfaceComparison.html#select-samples",
    "title": "Data Prepare",
    "section": "01. Select samples",
    "text": "01. Select samples\n\nlibrary(ggplot2)\nlibrary(qiime2R)\nlibrary(phyloseq)\n#Create phyloseq objects with qiime2 artifacts\nphyseq_qiime3 &lt;- qza_to_phyloseq(\n  features = \"data/cluster_table_filter_freq218_emcEstero.qza\",\n  taxonomy = \"data/taxonomyEstero.qza\",\n  metadata = \"data/metadata14.tsv\")\n\n\n#Filter metadata\n# Extract metadata from phyloseq object\nmetadat &lt;- data.frame(phyloseq::sample_data(physeq_qiime3), check.names = FALSE)\n\n\n#Filter metadata by Study_zone column\nfiltered_metadat &lt;- metadat[metadat$Study_zone %in% c(\"Estero_pargo\", \"Rio San Pedro\", \"Celestún\"), ]\n\n\n#Filter again by Ecological Type column, selecting Fringe parameter\nfiltered_metadat2 &lt;- filtered_metadat[filtered_metadat$Ecological_type %in% c(\"Fringe\"), ]\n\n\n#Filter again by season column to include all samples that were collected form a flood season\nfiltered_metadat3 &lt;- filtered_metadat2[filtered_metadat2$season %in%c(\"flood\"),]\n\n\n#Filter again by season column to include all samples that were collected form the surface\nfiltered_metadat4 &lt;- filtered_metadat3[filtered_metadat3$depth %in%c(\"0-15\", \"0.15\", \"5\"),]\n\n\n#Combine filtered metadata with phyloseq object to create a filtered phyloseq object\nfiltered_physeq2 &lt;- prune_samples(rownames(filtered_metadat4), physeq_qiime3)\n\n\n#Save your new phyloseq object\nsaveRDS(filtered_physeq2, file = \"physeq_objeto_Estero.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Data Prepare"
    ]
  },
  {
    "objectID": "02.SurfaceComparison.html#data-preparation",
    "href": "02.SurfaceComparison.html#data-preparation",
    "title": "Data Prepare",
    "section": "02. Data preparation",
    "text": "02. Data preparation\n\n#load\nphyseq_qiime &lt;- readRDS(\"rds/compare_mangroves/physeq_objeto_Estero.rds\")\n\n02.1 Remove empty ASVs and singletons\n\n#check data\nlibrary(microbiome)\nlibrary(dplyr)\n\n\n#library(microbiome)\nmicrobiome::summarize_phyloseq(physeq_qiime)\n\nCompositional = NO2\n\n\n1] Min. number of reads = 35812] Max. number of reads = 1504313] Total number of reads = 19263064] Average number of reads = 77052.245] Median number of reads = 783677] Sparsity = 0.5742662632375196] Any OTU sum to 1 or less? YES8] Number of singletons = 849] Percent of OTUs that are singletons \n        (i.e. exactly one read detected across all samples)010] Number of sample variables are: 25SampleIDBioSampleIDSRASampleNameCollection_datedepthsiteelevationBroad_scale_environmental_contextLocal_scale_environmental_contextEnvironmental_mediumLatitude_and_LongitudeGeographic.LocationStudy_zoneEcological_typeParametrosTemperaturaSalinidadpHRedox.mVS.2SO4seasonfilter2\n\n\n[[1]]\n[1] \"1] Min. number of reads = 3581\"\n\n[[2]]\n[1] \"2] Max. number of reads = 150431\"\n\n[[3]]\n[1] \"3] Total number of reads = 1926306\"\n\n[[4]]\n[1] \"4] Average number of reads = 77052.24\"\n\n[[5]]\n[1] \"5] Median number of reads = 78367\"\n\n[[6]]\n[1] \"7] Sparsity = 0.574266263237519\"\n\n[[7]]\n[1] \"6] Any OTU sum to 1 or less? YES\"\n\n[[8]]\n[1] \"8] Number of singletons = 84\"\n\n[[9]]\n[1] \"9] Percent of OTUs that are singletons \\n        (i.e. exactly one read detected across all samples)0\"\n\n[[10]]\n[1] \"10] Number of sample variables are: 25\"\n\n[[11]]\n [1] \"SampleID\"                          \"BioSample\"                        \n [3] \"ID\"                                \"SRA\"                              \n [5] \"SampleName\"                        \"Collection_date\"                  \n [7] \"depth\"                             \"site\"                             \n [9] \"elevation\"                         \"Broad_scale_environmental_context\"\n[11] \"Local_scale_environmental_context\" \"Environmental_medium\"             \n[13] \"Latitude_and_Longitude\"            \"Geographic.Location\"              \n[15] \"Study_zone\"                        \"Ecological_type\"                  \n[17] \"Parametros\"                        \"Temperatura\"                      \n[19] \"Salinidad\"                         \"pH\"                               \n[21] \"Redox.mV\"                          \"S.2\"                              \n[23] \"SO4\"                               \"season\"                           \n[25] \"filter\"                           \n\n\n\n# get sums\ntaxa_sums &lt;- taxa_sums(physeq_qiime)\n# Identify ASVs with sum 0 present in all samples\nzero_taxa &lt;- taxa_names(physeq_qiime)[taxa_sums == 0]\n# Remove ASVs with sum 0\nphyseq_qiime2 &lt;- prune_taxa(!taxa_names(physeq_qiime) %in%\n                                zero_taxa, physeq_qiime)\n\n# Remove singletons\nphyseq_qiime3 &lt;- filter_taxa(physeq_qiime2, function(x) sum(x) &gt; 1, TRUE)\n\n02.2 Rename mangrove system\n\n# Extract metadata\nmetadata &lt;- as(sample_data(physeq_qiime3), \"data.frame\")\n\n# Rename specific levels in the Mangrove system column\n#library(dplyr)\nmetadata &lt;- metadata %&gt;%\n  mutate(`Mangrove system` = case_when(\n    Study_zone == \"Rio San Pedro\" ~ \"San Pedro River\",\n    Study_zone == \"Laguna Cacahuate\" ~ \"Fossil Lagoon\",\n    Study_zone == \"Estero_pargo\" ~ \"Términos Lagoon\",\n    Study_zone == \"Celestún\" ~ \"Celestún Lagoon\",\n    TRUE ~ Study_zone))\n\n02.3 Add mangrove type\n\n# Extract sample_data\nsample_data_df &lt;- as(sample_data(physeq_qiime3), \"data.frame\")\n\n# Join sample_data with metadata to add Mangrove system\nsample_data_df &lt;- sample_data_df %&gt;%\n  left_join(dplyr::select(metadata, SampleID, `Mangrove system`), by = \"SampleID\")\n\n# Create Mangrove_type\nsample_data_df &lt;- sample_data_df %&gt;%\n  mutate(Mangrove_type = case_when(\n    `Mangrove system` %in% c(\"Fossil Lagoon\", \"San Pedro River\") ~ \"Interior\",\n    `Mangrove system` %in% c(\"Celestún Lagoon\", \"Términos Lagoon\") ~ \"Coastal\",\n    TRUE ~ NA_character_\n  ))\n\n# add .fastq.gz to SampleID \nsample_data_df$SampleID &lt;- gsub(\"_R1$\", \"_R1.fastq.gz\", sample_data_df$SampleID)\n\n# add rownames as SampleID\nrownames(sample_data_df) &lt;- sample_data_df$SampleID\n\n# update sample_data in phyloseq object\nsample_data(physeq_qiime3) &lt;- sample_data(sample_data_df)\n\n# check\ntail(sample_data(physeq_qiime3))\n\n                                   SampleID    BioSample  ID          SRA\nSRR9973332                       SRR9973332 SAMN12325037 Cel        TM5.8\nSRR9973344                       SRR9973344 SAMN12325034 Cel        TM5.5\nSRR9973347                       SRR9973347 SAMN12325033 Cel        TM5.4\nzr2502_14_R1.fastq.gz zr2502_14_R1.fastq.gz                E zr2502_14_R1\nzr2502_1_R1.fastq.gz   zr2502_1_R1.fastq.gz                E  zr2502_1_R1\nzr2502_37_R1.fastq.gz zr2502_37_R1.fastq.gz                E zr2502_37_R1\n                      SampleName Collection_date depth site elevation\nSRR9973332            SRS5272925      2018-10-04  0.15              3\nSRR9973344            SRS5272913      2018-10-04  0.15              3\nSRR9973347            SRS5272910      2018-10-04  0.15              3\nzr2502_14_R1.fastq.gz                 17/01/2018     5             NA\nzr2502_1_R1.fastq.gz                  17/01/2018     5             NA\nzr2502_37_R1.fastq.gz                 30/05/2018     5             NA\n                      Broad_scale_environmental_context\nSRR9973332                                ENVO:01000181\nSRR9973344                                ENVO:01000181\nSRR9973347                                ENVO:01000181\nzr2502_14_R1.fastq.gz                                  \nzr2502_1_R1.fastq.gz                                   \nzr2502_37_R1.fastq.gz                                  \n                      Local_scale_environmental_context Environmental_medium\nSRR9973332                                ENVO:00000057             sediment\nSRR9973344                                ENVO:00000057             sediment\nSRR9973347                                ENVO:00000057             sediment\nzr2502_14_R1.fastq.gz                                                       \nzr2502_1_R1.fastq.gz                                                        \nzr2502_37_R1.fastq.gz                                                       \n                      Latitude_and_Longitude Geographic.Location   Study_zone\nSRR9973332                   20.85 N 90.37 W      Mexico:Yucatan     Celestún\nSRR9973344                   20.85 N 90.37 W      Mexico:Yucatan     Celestún\nSRR9973347                   20.85 N 90.37 W      Mexico:Yucatan     Celestún\nzr2502_14_R1.fastq.gz                            Mexico:Campeche Estero_pargo\nzr2502_1_R1.fastq.gz                             Mexico:Campeche Estero_pargo\nzr2502_37_R1.fastq.gz                            Mexico:Campeche Estero_pargo\n                      Ecological_type Parametros Temperatura Salinidad pH\nSRR9973332                     Fringe         no          NA        NA NA\nSRR9973344                     Fringe         no          NA        NA NA\nSRR9973347                     Fringe         no          NA        NA NA\nzr2502_14_R1.fastq.gz          Fringe         no          NA        NA NA\nzr2502_1_R1.fastq.gz           Fringe         no          NA        NA NA\nzr2502_37_R1.fastq.gz          Fringe         no          NA        NA NA\n                      Redox.mV S.2 SO4 season filter Mangrove.system\nSRR9973332                  NA  NA  NA  flood     si Celestún Lagoon\nSRR9973344                  NA  NA  NA  flood     si Celestún Lagoon\nSRR9973347                  NA  NA  NA  flood     si Celestún Lagoon\nzr2502_14_R1.fastq.gz       NA  NA  NA  flood     si Términos Lagoon\nzr2502_1_R1.fastq.gz        NA  NA  NA  flood     si Términos Lagoon\nzr2502_37_R1.fastq.gz       NA  NA  NA  flood     si Términos Lagoon\n                      Mangrove_type\nSRR9973332                  Coastal\nSRR9973344                  Coastal\nSRR9973347                  Coastal\nzr2502_14_R1.fastq.gz       Coastal\nzr2502_1_R1.fastq.gz        Coastal\nzr2502_37_R1.fastq.gz       Coastal\n\n\n02.4 Create color pallete\n\n#Mangrove system colors\nloc_colors &lt;- c(\"Fossil Lagoon\"= \"#A7fcc1\",\n                \"San Pedro River\" = \"#26B170\",\n                \"Términos Lagoon\" = \"#329D9C\",\n                \"Celestún Lagoon\" = \"#41e8d3\")\n\n#Mangrove type colors\nmt_colors &lt;- c(\"Interior\"= \"#A7fcc1\",\n                \"Coastal\" = \"#41e8d3\")\n\n02.5 Check samples\n\n# Samples Plot\nmetadata &lt;- as(sample_data(physeq_qiime3), \"data.frame\")\n\nsamples_plot &lt;- ggplot(metadata, aes(x = Mangrove.system, y = ..count..,\nfill = Mangrove.system)) + geom_bar(position = \"dodge\") +\n  facet_wrap(~ Mangrove_type, scales = \"free_x\") +\n  labs(title = \"Samples of the analysis\", y = \"Number of Samples\",\n       x = \"Mangrove system\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 0)) +\n  scale_fill_manual(values = loc_colors)\n\n# show plot\nprint(samples_plot)\n\nWarning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(count)` instead.\n\n\n\n\n\n\n\n\n02.6 Save objects in RDS to next analysis\n\nsaveRDS(physeq_qiime3, \"rds/compare_mangroves/physeq_qiime3.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Data Prepare"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html",
    "href": "03.3.BetaDiversity.html",
    "title": "Beta diversity",
    "section": "",
    "text": "#Load libraries\nlibrary(vegan)\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(pairwiseAdonis)\nlibrary(reshape2)\nlibrary(ggpubr)\nlibrary(cowplot)\n\n\n#load data\nps &lt;- readRDS(\"rds/interior_mangroves/phyloseq.rds\")\n\n\n# Extract data from phyloseq object\n#library(phyloseq)\notu_data &lt;- otu_table(ps, taxa_are_rows = TRUE)\nmetadata &lt;- as(sample_data(ps), \"data.frame\")\nsample_data &lt;- data.frame(sample_data(ps))\n\n\n# color pallet\ndepth_colors &lt;- c(\"0-15\" = \"#f5e5c4\",\n                 \"16-30\" = \"#baa179\",\n                 \"31-45\" = \"#a67451\",\n                 \"50-75\" = \"#80673b\")\n\nloc_colors &lt;- c(\"Fossil Lagoon\"= \"#A3D9A8\",\n                \"Reforma Waterfalls\" = \"#44C17B\",\n                \"Miguelito Dike\" = \"#2E8B57\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#all-samples",
    "href": "03.3.BetaDiversity.html#all-samples",
    "title": "Beta diversity",
    "section": "01.1 All samples",
    "text": "01.1 All samples\n01.1.1 Get distances and stress\n\n# NMDS wu\nset.seed(123)\nnmds_wunifrac &lt;- ordinate(ps, method = \"NMDS\", distance = \"wunifrac\")\n\nRun 0 stress 0.0887 \nRun 1 stress 0.135 \nRun 2 stress 0.0924 \nRun 3 stress 0.0924 \nRun 4 stress 0.0887 \n... New best solution\n... Procrustes: rmse 6.43e-05  max resid 0.000367 \n... Similar to previous best\nRun 5 stress 0.0943 \nRun 6 stress 0.0924 \nRun 7 stress 0.116 \nRun 8 stress 0.0967 \nRun 9 stress 0.0943 \nRun 10 stress 0.121 \nRun 11 stress 0.0943 \nRun 12 stress 0.0924 \nRun 13 stress 0.117 \nRun 14 stress 0.0941 \nRun 15 stress 0.0941 \nRun 16 stress 0.0887 \n... Procrustes: rmse 0.00011  max resid 0.000666 \n... Similar to previous best\nRun 17 stress 0.0887 \n... Procrustes: rmse 6.31e-05  max resid 0.000392 \n... Similar to previous best\nRun 18 stress 0.0887 \n... Procrustes: rmse 6.78e-05  max resid 0.000404 \n... Similar to previous best\nRun 19 stress 0.0887 \n... Procrustes: rmse 3.66e-05  max resid 2e-04 \n... Similar to previous best\nRun 20 stress 0.0887 \n... New best solution\n... Procrustes: rmse 5.51e-05  max resid 0.000327 \n... Similar to previous best\n*** Best solution repeated 1 times\n\n# stress variable\nvar_stress_nmds_wu &lt;- round(nmds_wunifrac$stress, 5)\nvar_stress_nmds_wu\n\n[1] 0.0887\n\n\n01.1.2 Plot\n\n# Convert Depth to factor \nsample_data(ps)$Depths &lt;- factor(sample_data(ps)$Depths, levels = c(\"0-15\", \"16-30\", \"31-45\", \"50-75\"))\n\n#plot\nnmds_wu &lt;- plot_ordination(ps, nmds_wunifrac, color = \"Depths\") + theme_classic() + \n  labs(col = \"Depth\") + \n  labs(title=\"Weighted UniFrac\") +\n  geom_point(size=5) +\n    scale_fill_manual(values = depth_colors)+ \n    scale_color_manual(values = depth_colors)\n\nnmds_wu &lt;- nmds_wu +\n  annotate(\"text\", x = Inf, y = -Inf, label = paste(\"Stress:\", var_stress_nmds_wu),\n           hjust = 1.1, vjust = -1.1, size = 4)\n\n#show\nnmds_wu\n\n\n\n\n\n\n\n01.1.3 PERMANOVA\n\n\n\n\n\n\nNote\n\n\n\nTo test the effects of Depth and Location on the Weighted Unifrac dissimilarity, a PERMANOVA analysis was conducted using adonis2.\n\n\n\n# UniFrac\nwunifrac_distances &lt;- UniFrac(ps, weighted = TRUE)\n\n# Convert distances 'dist' class\nwunifrac_distances &lt;- as.dist(wunifrac_distances)\n\n# PERMANOVA \nset.seed(123)\nadonis2_wunifrac &lt;- adonis2(\n  wunifrac_distances ~ Depths + Location,\n  data = metadata,\n  permutations = 999,\n  strata = metadata$ID,\n  by = \"terms\")\n\n# Results\nperm_results &lt;- data.frame(\n  Term = c(\"Depth_cm\", \"Location\", \"Residual\"),\n  R2 = c(adonis2_wunifrac$R2[1], adonis2_wunifrac$R2[2], adonis2_wunifrac$R2[3]),\n  p_value = c(adonis2_wunifrac$`Pr(&gt;F)`[1], adonis2_wunifrac$`Pr(&gt;F)`[2], NA))\n\nperm_results\n\n      Term    R2 p_value\n1 Depth_cm 0.226   0.001\n2 Location 0.182   0.002\n3 Residual 0.592      NA\n\n# PERMANOVA text\nperm_text &lt;- paste(\n  \"PERMANOVA:\",\n  paste(\"Depths: R² =\", round(perm_results$R2[1], 3), \", p =\", perm_results$p_value[1]),\n  paste(\"Location: R² =\", round(perm_results$R2[2], 3), \", p =\", perm_results$p_value[2]),\n  paste(\"Residual: R² =\", round(perm_results$R2[3], 3)),\n  sep = \"\\n\")\n\n01.1.4 Plot with permanova\n\n# add to plot\nnmds_wu &lt;- nmds_wu +\n  annotate(\n    \"text\", x = Inf, y = Inf, label = perm_text,\n    hjust = 1.1, vjust = 1.6, size = 3, color = \"black\"\n  )\n\n# Mostrar el gráfico\nnmds_wu\n\n\n\n\n\n\n\n\nggsave(\"Figures/interior_mangroves/nmds_wunifrac_all.pdf\", nmds_wu, width = 20, height = 15, units = \"cm\")\n\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#surface-and-deep-samples",
    "href": "03.3.BetaDiversity.html#surface-and-deep-samples",
    "title": "Beta diversity",
    "section": "01.2 Surface and deep samples",
    "text": "01.2 Surface and deep samples\n01.2.1 Filter depths\n\n# Filter data 0-15 y 50-75\nsample_data(ps)$Depths_fltr &lt;- factor(sample_data(ps)$Depths, levels = c(\"0-15\", \"50-75\"))\n\nps_fltr &lt;- prune_samples(sample_data(ps)$Depths_fltr %in% c(\"0-15\", \"50-75\"), ps)\n\nmetadata_fltr &lt;- as(sample_data(ps_fltr), \"data.frame\")\n\n01.2.2 Get distances and stress\n\n# Distances\nset.seed(123)\nnmds_wunifrac_fltr &lt;- ordinate(ps_fltr, method = \"NMDS\", distance = \"wunifrac\")\n\nRun 0 stress 0.0614 \nRun 1 stress 0.0614 \n... Procrustes: rmse 1.38e-05  max resid 4.53e-05 \n... Similar to previous best\nRun 2 stress 0.0614 \n... Procrustes: rmse 1.04e-05  max resid 4.14e-05 \n... Similar to previous best\nRun 3 stress 0.0728 \nRun 4 stress 0.0728 \nRun 5 stress 0.0728 \nRun 6 stress 0.0614 \n... Procrustes: rmse 2e-05  max resid 7.56e-05 \n... Similar to previous best\nRun 7 stress 0.0879 \nRun 8 stress 0.0728 \nRun 9 stress 0.0879 \nRun 10 stress 0.0728 \nRun 11 stress 0.1 \nRun 12 stress 0.0614 \n... New best solution\n... Procrustes: rmse 2.65e-06  max resid 7.37e-06 \n... Similar to previous best\nRun 13 stress 0.0614 \n... Procrustes: rmse 2.63e-05  max resid 9.25e-05 \n... Similar to previous best\nRun 14 stress 0.0728 \nRun 15 stress 0.0614 \n... Procrustes: rmse 4.99e-05  max resid 0.000154 \n... Similar to previous best\nRun 16 stress 0.0614 \n... Procrustes: rmse 2.23e-05  max resid 8.27e-05 \n... Similar to previous best\nRun 17 stress 0.0728 \nRun 18 stress 0.0879 \nRun 19 stress 0.1 \nRun 20 stress 0.105 \n*** Best solution repeated 4 times\n\n# stress\nvar_stress_nmds_wu_fltr &lt;- round(nmds_wunifrac_fltr$stress, 5)\n\n01.2.3 NMDS plot\n\n# Plot NMDS\nnmds_wu_fltr &lt;- plot_ordination(ps_fltr, nmds_wunifrac_fltr, color = \"Depths\") + \n  theme_classic() + \n  labs(col = \"Depths\") + \n  labs(title = \"Weighted UniFrac\") +\n  geom_point(size = 5) +\n  scale_fill_manual(values = depth_colors) + \n  scale_color_manual(values = depth_colors)\n\n# add stress\nnmds_wu_fltr &lt;- nmds_wu_fltr +\n  annotate(\"text\", x = Inf, y = -Inf, label = paste(\"Stress:\", var_stress_nmds_wu_fltr),\n           hjust = 1.1, vjust = -1.2, size = 3)\n\n01.2.4 PERMANOVA\n\n# UniFrac distances\nwunifrac_distances_fltr &lt;- UniFrac(ps_fltr, weighted = TRUE)\n\n# Convert 'dist' class\nwunifrac_distances_fltr &lt;- as.dist(wunifrac_distances_fltr)\n\n# PERMANOVA \nset.seed(123)\nadonis2_wunifrac_fltr &lt;- adonis2(\n  wunifrac_distances_fltr ~ Depths_fltr + Location,\n  data = metadata_fltr,\n  permutations = 999,\n  strata = metadata_fltr$ID,\n  by = \"terms\")\n\nSet of permutations &lt; 'minperm'. Generating entire set.\n\n# Results\nperm_results_fltr &lt;- data.frame(\n  Term = c(\"Depth_cm\", \"Location\", \"Residual\"),\n  R2 = c(adonis2_wunifrac_fltr$R2[1], adonis2_wunifrac_fltr$R2[2], adonis2_wunifrac_fltr$R2[3]),\n  p_value = c(adonis2_wunifrac_fltr$`Pr(&gt;F)`[1], adonis2_wunifrac_fltr$`Pr(&gt;F)`[2], NA))\n\nperm_results_fltr\n\n      Term     R2 p_value\n1 Depth_cm 0.3465   0.002\n2 Location 0.0932   0.157\n3 Residual 0.5604      NA\n\n# PERMANOVA text\nperm_text_fltr &lt;- paste(\n  \"PERMANOVA:\",\n  paste(\"Depths: R² =\", round(perm_results_fltr$R2[1], 3), \", p =\", perm_results_fltr$p_value[1]),\n  paste(\"Location: R² =\", round(perm_results_fltr$R2[2], 3), \", p =\", perm_results_fltr$p_value[2]), sep = \"\\n\")\n\n01.2.5 Post-hoc adonis\n\n\n\n\n\n\nNote\n\n\n\nTo test differences between the Mangrove systems a Post-hoc pairwise PERMANOVA was conducted using pairwise.adonis\n\n\n01.2.6 Pairwise adonis\n\n## Post-hoc Depths\n# Pairwise PERMANOVA  Weighted UniFrac\nset.seed(123)\npairwise_adonis_fltr &lt;- pairwiseAdonis::pairwise.adonis2(\n  wunifrac_distances_fltr ~ Depths_fltr,\n  data = metadata_fltr,\n  permutations = 999)\n\n# show\npairwise_adonis_fltr\n\n$parent_call\n[1] \"wunifrac_distances_fltr ~ Depths_fltr , strata = Null , permutations 999\"\n\n$`0-15_vs_50-75`\n         Df SumOfSqs    R2    F Pr(&gt;F)    \nModel     1    0.237 0.346 11.7  0.001 ***\nResidual 22    0.447 0.654                \nTotal    23    0.685 1.000                \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nattr(,\"class\")\n[1] \"pwadstrata\" \"list\"      \n\n# Extract pairwise adonis results\npairwise_text_fltr &lt;- paste(\n  \"Pairwise PERMANOVA Depths:\",\n  paste(\"R² =\", round(pairwise_adonis_fltr$`0-15_vs_50-75`$R2[1], 3), \n        \", p =\", pairwise_adonis_fltr$`0-15_vs_50-75`$`Pr(&gt;F)`[1]),\n  sep = \"\\n\")\n\n01.2.7 Beta disper\n\n\n\n\n\n\nImportant\n\n\n\nGiven the pairwise PERMANOVA showed a highly significant result (p = 0.001), it is prudent to calculate the beta dispersion to validate that this result reflects real differences in microbial community composition between “0-15” and “50-75,” and not just differences in variability within each depth. In addition, R² = 0.346 indicates a moderate effect, but the 65.4% residual variance suggests unexplained variability, which could include differences in dispersion.\n\n\n\n# Beta disp\nbeta_disp_fltr &lt;- betadisper(wunifrac_distances_fltr, metadata_fltr$Depths_fltr)\n\n# Significant test\nanova_beta_disp_fltr &lt;- anova(beta_disp_fltr)\nanova_beta_disp_fltr\n\nAnalysis of Variance Table\n\nResponse: Distances\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nGroups     1 0.0013 0.00129    0.35   0.56\nResiduals 22 0.0807 0.00367               \n\n# Show dispersion by group\nbeta_disp_fltr$group.distances\n\n 0-15 50-75 \n0.132 0.117 \n\n# boxplot betadisper\nbeta_data_fltr &lt;- data.frame(\n  Group = metadata_fltr$Depths_fltr,\n  Distance_to_centroid = beta_disp_fltr$distances\n)\nbeta_plot_fltr &lt;- ggplot(beta_data_fltr, aes(x = Group, y = Distance_to_centroid, fill = Group)) +\n  geom_boxplot() +\n  scale_fill_manual(values = depth_colors) +\n  labs(title = \"Betadisper by depth wUniFrac\") +\n  theme_classic()\n\n#show\nbeta_plot_fltr\n\n\n\n\n\n\n\nSave boxplot\n\nggsave(\"Figures/interior_mangroves/Betadisper_depth.pdf\", beta_plot_fltr, bg='transparent', width = 4, height = 4.5)\n\n01.2.8 Plot with PERMANOVA, pairwise PERMANOVA and Betadisper\n\n# add betadisper p-value text\nbeta_text_fltr &lt;- paste(\"Betadisper p-value:\", round(anova_beta_disp_fltr$`Pr(&gt;F)`[1], 3))\n\n\n# Añadir texto de PERMANOVA y dispersión beta\nnmds_wu_fltr &lt;- nmds_wu_fltr +\n  annotate(\n    \"text\", x = Inf, y = Inf, \n    label = paste(perm_text_fltr, pairwise_text_fltr, beta_text_fltr, sep = \"\\n\"),\n    hjust = 1.1, vjust = 1.2, size = 3, color = \"black\")\nnmds_wu_fltr\n\n\n\n\n\n\n\nsave\n\nggsave(\"Figures/interior_mangroves/NMDS_wu_depth.pdf\", nmds_wu_fltr, bg='transparent', width = 6, height = 4.5)\n\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#get-distances-and-stress-2",
    "href": "03.3.BetaDiversity.html#get-distances-and-stress-2",
    "title": "Beta diversity",
    "section": "02.1 Get distances and stress",
    "text": "02.1 Get distances and stress\n\n## Unweighted UniFrac\nnmds_unifrac &lt;- ordinate(ps, method = \"NMDS\", distance = \"unifrac\")\n\nRun 0 stress 0.0783 \nRun 1 stress 0.0783 \n... New best solution\n... Procrustes: rmse 0.000102  max resid 0.000654 \n... Similar to previous best\nRun 2 stress 0.0857 \nRun 3 stress 0.0976 \nRun 4 stress 0.0929 \nRun 5 stress 0.0941 \nRun 6 stress 0.0964 \nRun 7 stress 0.0999 \nRun 8 stress 0.403 \nRun 9 stress 0.112 \nRun 10 stress 0.0941 \nRun 11 stress 0.0999 \nRun 12 stress 0.0783 \n... Procrustes: rmse 0.000441  max resid 0.00284 \n... Similar to previous best\nRun 13 stress 0.0964 \nRun 14 stress 0.0929 \nRun 15 stress 0.0975 \nRun 16 stress 0.0783 \n... Procrustes: rmse 6.12e-05  max resid 0.000392 \n... Similar to previous best\nRun 17 stress 0.104 \nRun 18 stress 0.0783 \n... Procrustes: rmse 0.00053  max resid 0.00341 \n... Similar to previous best\nRun 19 stress 0.0857 \nRun 20 stress 0.1 \n*** Best solution repeated 4 times\n\n# stress variable\nvar_stress_nmds_u &lt;- round(nmds_unifrac$stress, 5)\nvar_stress_nmds_u\n\n[1] 0.0783",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#nmds",
    "href": "03.3.BetaDiversity.html#nmds",
    "title": "Beta diversity",
    "section": "02.2 NMDS",
    "text": "02.2 NMDS\n\n# Reorder 'Location'\nsample_data(ps)$Location &lt;- factor(sample_data(ps)$Location, levels = c(\"Fossil Lagoon\", \"Reforma Waterfalls\", \"Miguelito Dike\"))\n\n# NMDS\nnmds_u &lt;- plot_ordination(ps, nmds_unifrac, color = \"Location\") + \n  theme_classic() + \n  labs(col = \"Location\", title = \"Unweighted UniFrac\") +\n  geom_point(size = 5) +\n  scale_fill_manual(values = loc_colors) + \n  scale_color_manual(values = loc_colors) +\n  annotate(\"text\", x = Inf, y = -Inf, \n           label = paste(\"Stress:\", var_stress_nmds_u),\n           hjust = 1.1, vjust = -1.3, size = 3)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#permanova-2",
    "href": "03.3.BetaDiversity.html#permanova-2",
    "title": "Beta diversity",
    "section": "02.3 PERMANOVA",
    "text": "02.3 PERMANOVA\n\n# UniFrac distances\nunifrac_distances &lt;- UniFrac(ps, weighted = FALSE)\n\n# Convert 'dist' class\nunifrac_distances &lt;- as.dist(unifrac_distances)\n\n# PERMANOVA \nset.seed(123)\nadonis2_unifrac &lt;- adonis2(\n  unifrac_distances ~ Location + Depths,\n  data = metadata,\n  permutations = 999,\n  strata = metadata$ID,\n  by = \"terms\")\n\n# Results\nperm_results &lt;- data.frame(\n  Term = c(\"Location\",\"Depths\", \"Residual\"),\n  R2 = c(adonis2_unifrac$R2[1], adonis2_unifrac$R2[2], adonis2_unifrac$R2[3]),\n  p_value = c(adonis2_unifrac$`Pr(&gt;F)`[1], adonis2_unifrac$`Pr(&gt;F)`[2], NA))\n\nperm_results\n\n      Term    R2 p_value\n1 Location 0.301   0.001\n2   Depths 0.136   0.001\n3 Residual 0.563      NA\n\n# PERMANOVA text\nperm_text &lt;- paste(\n  \"PERMANOVA:\",\n  paste(\"Location: R² =\", round(perm_results$R2[1], 3), \", p =\", perm_results$p_value[1]),\n  paste(\"Depths: R² =\", round(perm_results$R2[2], 3), \", p =\", perm_results$p_value[2]), sep = \"\\n\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#post-hoc-adonis-1",
    "href": "03.3.BetaDiversity.html#post-hoc-adonis-1",
    "title": "Beta diversity",
    "section": "02.4 Post-hoc adonis",
    "text": "02.4 Post-hoc adonis\n\n\n\n\n\n\nImportant\n\n\n\nTo test differences between the Mangrove systems a Post-hoc pairwise PERMANOVA was conducted using pairwise.adonis",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#pairwise-adonis-1",
    "href": "03.3.BetaDiversity.html#pairwise-adonis-1",
    "title": "Beta diversity",
    "section": "02.5 Pairwise adonis",
    "text": "02.5 Pairwise adonis\n\n## Post-hoc Location\n# Pairwise PERMANOVA  Weighted UniFrac\nset.seed(123)\npairwise_adonis_u &lt;- pairwiseAdonis::pairwise.adonis2(\n  unifrac_distances ~ Location + Depths,\n  data = metadata,\n  permutations = 999)\n\n# show\npairwise_adonis_u\n\n$parent_call\n[1] \"unifrac_distances ~ Location + Depths , strata = Null , permutations 999\"\n\n$`Miguelito Dike_vs_Reforma Waterfalls`\n         Df SumOfSqs    R2    F Pr(&gt;F)   \nModel     4     0.93 0.288 3.14  0.002 **\nResidual 31     2.30 0.712               \nTotal    35     3.23 1.000               \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Miguelito Dike_vs_Fossil Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)    \nModel     4     1.60 0.411 5.75  0.001 ***\nResidual 33     2.29 0.589                \nTotal    37     3.89 1.000                \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Reforma Waterfalls_vs_Fossil Lagoon`\n         Df SumOfSqs    R2    F Pr(&gt;F)    \nModel     4    1.148 0.599 7.86  0.001 ***\nResidual 21    0.767 0.401                \nTotal    25    1.915 1.000                \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nattr(,\"class\")\n[1] \"pwadstrata\" \"list\"",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#extract-p-values",
    "href": "03.3.BetaDiversity.html#extract-p-values",
    "title": "Beta diversity",
    "section": "02.6 Extract p-values",
    "text": "02.6 Extract p-values\n\n# Define abbrevs\nlocation_abbrevs &lt;- c(\n  \"Miguelito Dike\" = \"MD\",\n  \"Reforma Waterfalls\" = \"RW\",\n  \"Fossil Lagoon\" = \"FL\")\n\n# Extract values\nlocations &lt;- unique(metadata$Location)\np_matrix &lt;- matrix(NA, nrow = length(locations), ncol = length(locations),\n                   dimnames = list(locations, locations))\nr2_matrix &lt;- matrix(NA, nrow = length(locations), ncol = length(locations),\n                    dimnames = list(locations, locations))\n\nfor (comp in names(pairwise_adonis_u)[-1]) {  # Exclude 'parent_call'\n  pair &lt;- strsplit(comp, \"_vs_\")[[1]]\n  loc1 &lt;- pair[1]\n  loc2 &lt;- pair[2]\n  p_matrix[loc1, loc2] &lt;- pairwise_adonis_u[[comp]]$`Pr(&gt;F)`[1]\n  p_matrix[loc2, loc1] &lt;- pairwise_adonis_u[[comp]]$`Pr(&gt;F)`[1]  # Simetric\n  r2_matrix[loc1, loc2] &lt;- pairwise_adonis_u[[comp]]$R2[1]\n  r2_matrix[loc2, loc1] &lt;- pairwise_adonis_u[[comp]]$R2[1]  # Sim\n}\ndiag(p_matrix) &lt;- 1  # p-value = 1 \ndiag(r2_matrix) &lt;- 0  # R² = 0 \n\n# abbrevs in matrix\nabbrev_locations &lt;- location_abbrevs[locations]\nnames(abbrev_locations) &lt;- NULL\ndimnames(p_matrix) &lt;- list(abbrev_locations, abbrev_locations)\ndimnames(r2_matrix) &lt;- list(abbrev_locations, abbrev_locations)\n\n# Convert to long format\np_melt &lt;- melt(p_matrix, na.rm = TRUE)\ncolnames(p_melt) &lt;- c(\"Location1\", \"Location2\", \"p_value\")\nr2_melt &lt;- melt(r2_matrix, na.rm = TRUE)\ncolnames(r2_melt) &lt;- c(\"Location1\", \"Location2\", \"R2\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#heatmap",
    "href": "03.3.BetaDiversity.html#heatmap",
    "title": "Beta diversity",
    "section": "02.7 Heatmap",
    "text": "02.7 Heatmap\n\n# Heatmap of p-values\nheatmap_plot_p &lt;- ggplot(p_melt, aes(x = Location1, y = Location2, fill = p_value)) +\n  geom_tile(color = \"gray40\") +\n  scale_fill_gradient2(low = \"white\", mid = \"white\", high = \"gray40\",\n                       midpoint = 0.025, limits = c(0, 1),\n                       name = \"p-value\") +\n  geom_text(aes(label = sprintf(\"%.3f\", p_value)), color = \"black\", size = 3) +\n  theme_minimal() +\n  labs(title = \"Pairwise PERMANOVA Unweighted UniFrac\", y = \"Location\") +\n  theme(axis.text.x = element_blank(),  # Ocult axis x\n        axis.title.x = element_blank(),\n        axis.title.y = element_text(size = 12),\n        plot.title = element_text(size = 12))\n\n# Heatmap de R²\nheatmap_plot_r2 &lt;- ggplot(r2_melt, aes(x = Location1, y = Location2, fill = R2)) +\n  geom_tile(color = \"gray40\") +\n  scale_fill_gradient(low = \"white\", high = \"gray40\",\n                      name = \"R²\") +\n  geom_text(aes(label = sprintf(\"%.3f\", R2)), color = \"black\", size = 3) +\n  theme_minimal() +\n  labs(title = NULL,\n       x = \"Location\", y = \"Location\") +\n  theme(axis.text.x = element_text(angle = 0, hjust = 1, size = 12),\n        axis.title = element_text(size = 12),\n        plot.title = element_text(size = 12))\n\n# join cowplot\ncombined_heatmap &lt;- plot_grid(\n  heatmap_plot_p, heatmap_plot_r2,\n  nrow = 2, align = \"v\", axis = \"lr\"\n)\n\n# show\ncombined_heatmap\n\n\n\n\n\n\n\nsave\n\nggsave(\"Figures/interior_mangroves/pairwiseheatmap.pdf\", combined_heatmap, bg='transparent', width = 4, height = 4.5)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#beta-disper-1",
    "href": "03.3.BetaDiversity.html#beta-disper-1",
    "title": "Beta diversity",
    "section": "02.8 Beta disper",
    "text": "02.8 Beta disper\n\n\n\n\n\n\nImportant\n\n\n\nGiven the pairwise PERMANOVA showed a highly significant results, it is prudent to calculate the beta dispersion to validate that this result reflects real differences in microbial community composition between mangrove location and not just differences in variability within mangrove site.\n\n\n\n# Beta disp\nbeta_disp_u &lt;- betadisper(unifrac_distances, metadata$Location)\nanova_beta_disp_u &lt;- anova(beta_disp_u)\n\n# Show dispersion by group\nbeta_disp_u$group.distances\n\n     Fossil Lagoon     Miguelito Dike Reforma Waterfalls \n             0.216              0.270              0.231 \n\n# boxplot betadisper\nbeta_data &lt;- data.frame(\n  Group = metadata$Location,\n  Distance_to_centroid = beta_disp_u$distances\n)\nbeta_plot &lt;- ggplot(beta_data, aes(x = Group, y = Distance_to_centroid, fill = Group)) +\n  geom_boxplot() +\n  scale_fill_manual(values = loc_colors) +\n  labs(title = \"Betadisper by location wUniFrac\") +\n  theme_classic()\n\n#show\nbeta_plot\n\n\n\n\n\n\n\n\nggsave(\"Figures/interior_mangroves/Betadisper_location.pdf\", beta_plot, bg='transparent', width = 5.5, height = 4)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#plot-with-permanova-pairwise-permanova-and-betadisper-1",
    "href": "03.3.BetaDiversity.html#plot-with-permanova-pairwise-permanova-and-betadisper-1",
    "title": "Beta diversity",
    "section": "02.9 Plot with PERMANOVA, pairwise PERMANOVA and Betadisper",
    "text": "02.9 Plot with PERMANOVA, pairwise PERMANOVA and Betadisper\n\nbeta_text &lt;- paste(\"Betadisper, p-value:\", \n                   round(anova_beta_disp_u$`Pr(&gt;F)`[1], 3))\n\n\n# Add texts to NMDS\nnmds_u &lt;- nmds_u +\n  annotate(\n    \"text\", x = Inf, y = Inf, \n    label = paste(perm_text, beta_text, sep = \"\\n\"),\n    hjust = 1.1, vjust = 1.2, size = 3, color = \"black\"\n  )\n\nSave\n\nggsave(\"Figures/interior_mangroves/NMDS_u_location.pdf\", nmds_u, bg='transparent', width = 6, height = 4.5)\n\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#load-an-prepare-data",
    "href": "03.3.BetaDiversity.html#load-an-prepare-data",
    "title": "Beta diversity",
    "section": "03.1 Load an prepare data",
    "text": "03.1 Load an prepare data\n\n# read data\nphychem &lt;- read.csv(\"data/physicochemists.csv\", stringsAsFactors = FALSE)\n\n# Rename specific levels\nphychem &lt;- phychem %&gt;%\n  mutate(`Locality` = case_when(\n    Locality == \"El Cacahuate\" ~ \"Fossil Lagoon\",\n    Locality == \"La Piedad\" ~ \"Reforma Waterfalls\",\n    Locality == \"Dique Miguelito\" ~ \"Miguelito Dike\",\n    TRUE ~ Locality))\n\n# extract intersticial samples 30 cm\nps_phychem30cm &lt;- prune_samples(sample_data(ps)$Depths == \"31-45\", ps)\n\n# Extract metadata from filter object\nmetadata_phychem30cm &lt;- as.data.frame(sample_data(ps_phychem30cm))\n\n# convert to data frame\nmetadata_phychem30cm_df &lt;- data.frame(as(sample_data(ps_phychem30cm), \n                                         \"data.frame\"))\n# join\ncombined_metadata &lt;- merge(metadata_phychem30cm_df, phychem,\n                           by = \"Sample\", all.x = TRUE)\n\n# rownames\nrownames(combined_metadata) &lt;- combined_metadata$Sample\n\n# Convert to sample_data\nsample_data_combined &lt;- sample_data(combined_metadata)\n\n# save into phyloseq object\nsample_data(ps_phychem30cm) &lt;- sample_data_combined",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#get-distances",
    "href": "03.3.BetaDiversity.html#get-distances",
    "title": "Beta diversity",
    "section": "03.2 Get distances",
    "text": "03.2 Get distances\n\n# Calcular las distancias Unifrac no ponderadas\nunifrac_distances_phychem30cm&lt;- distance(ps_phychem30cm, method = \"unifrac\", weighted = FALSE)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#calculate-dbrda",
    "href": "03.3.BetaDiversity.html#calculate-dbrda",
    "title": "Beta diversity",
    "section": "03.3 Calculate dbRDA",
    "text": "03.3 Calculate dbRDA\n\n# Convert distance matrix to vegdist object\nunifrac_vegdist_phychem30cm &lt;- as.dist(unifrac_distances_phychem30cm)\n\n# db-RDA\ndbrda_result &lt;- capscale(unifrac_vegdist_phychem30cm ~ Temperature...C. + \n                           Salinity..ppm. + pH + Redox.mV..Eh. + \n                           S.2..mg.l. + SO....mg.l., data = phychem)\n\n# summary\nsummary(dbrda_result)\n\n\nCall:\ncapscale(formula = unifrac_vegdist_phychem30cm ~ Temperature...C. +      Salinity..ppm. + pH + Redox.mV..Eh. + S.2..mg.l. + SO....mg.l.,      data = phychem) \n\nPartitioning of squared Unknown distance:\n              Inertia Proportion\nTotal           0.995      1.000\nConstrained     0.609      0.612\nUnconstrained   0.385      0.388\n\nEigenvalues, and their contribution to the squared Unknown distance \n\nImportance of components:\n                       CAP1  CAP2   CAP3   CAP4   CAP5   CAP6  MDS1   MDS2\nEigenvalue            0.324 0.117 0.0814 0.0403 0.0263 0.0207 0.261 0.0425\nProportion Explained  0.325 0.117 0.0818 0.0405 0.0265 0.0208 0.263 0.0427\nCumulative Proportion 0.325 0.443 0.5247 0.5652 0.5916 0.6124 0.875 0.9180\n                        MDS3   MDS4   MDS5   MDS6\nEigenvalue            0.0261 0.0242 0.0180 0.0133\nProportion Explained  0.0262 0.0244 0.0181 0.0134\nCumulative Proportion 0.9442 0.9685 0.9866 1.0000\n\nAccumulated constrained eigenvalues\nImportance of components:\n                       CAP1  CAP2   CAP3   CAP4   CAP5   CAP6\nEigenvalue            0.324 0.117 0.0814 0.0403 0.0263 0.0207\nProportion Explained  0.531 0.192 0.1336 0.0661 0.0432 0.0340\nCumulative Proportion 0.531 0.723 0.8567 0.9228 0.9660 1.0000",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#get-significance",
    "href": "03.3.BetaDiversity.html#get-significance",
    "title": "Beta diversity",
    "section": "03.4 Get significance",
    "text": "03.4 Get significance\n\n# Significance\nanova_axes &lt;- anova(dbrda_result, by = \"axis\", \n                    permutations = 999)\nanova_axes\n\nPermutation test for capscale under reduced model\nForward tests for axes\nPermutation: free\nNumber of permutations: 999\n\nModel: capscale(formula = unifrac_vegdist_phychem30cm ~ Temperature...C. + Salinity..ppm. + pH + Redox.mV..Eh. + S.2..mg.l. + SO....mg.l., data = phychem)\n         Df SumOfSqs    F Pr(&gt;F)\nCAP1      1    0.324 5.04   0.14\nCAP2      1    0.117 1.82   0.75\nCAP3      1    0.081 1.27   0.84\nCAP4      1    0.040 0.63   0.96\nCAP5      1    0.026 0.41   0.97\nCAP6      1    0.021 0.32   0.97\nResidual  6    0.385            \n\n# Significance by variable\nanova_terms &lt;- anova(dbrda_result, by = \"terms\", \n                     permutations = 999)\n\nanova_terms\n\nPermutation test for capscale under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 999\n\nModel: capscale(formula = unifrac_vegdist_phychem30cm ~ Temperature...C. + Salinity..ppm. + pH + Redox.mV..Eh. + S.2..mg.l. + SO....mg.l., data = phychem)\n                 Df SumOfSqs    F Pr(&gt;F)  \nTemperature...C.  1    0.208 3.23  0.016 *\nSalinity..ppm.    1    0.120 1.87  0.112  \npH                1    0.064 1.00  0.433  \nRedox.mV..Eh.     1    0.051 0.79  0.565  \nS.2..mg.l.        1    0.108 1.67  0.151  \nSO....mg.l.       1    0.059 0.92  0.470  \nResidual          6    0.385              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# variance by each axis\nsummary(dbrda_result)$cont$importance\n\nImportance of components:\n                       CAP1  CAP2   CAP3   CAP4   CAP5   CAP6  MDS1   MDS2\nEigenvalue            0.324 0.117 0.0814 0.0403 0.0263 0.0207 0.261 0.0425\nProportion Explained  0.325 0.117 0.0818 0.0405 0.0265 0.0208 0.263 0.0427\nCumulative Proportion 0.325 0.443 0.5247 0.5652 0.5916 0.6124 0.875 0.9180\n                        MDS3   MDS4   MDS5   MDS6\nEigenvalue            0.0261 0.0242 0.0180 0.0133\nProportion Explained  0.0262 0.0244 0.0181 0.0134\nCumulative Proportion 0.9442 0.9685 0.9866 1.0000",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#permanova-3",
    "href": "03.3.BetaDiversity.html#permanova-3",
    "title": "Beta diversity",
    "section": "03.5 PERMANOVA",
    "text": "03.5 PERMANOVA\n\n# PERMANOVA\nset.seed(123)\npermanova_result &lt;- adonis2(unifrac_distances_phychem30cm ~ Temperature...C. + Salinity..ppm. + pH +\nRedox.mV..Eh. + S.2..mg.l. + SO....mg.l., \ndata = phychem, by=\"terms\", permutations = 999)\n\n# show\npermanova_result\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 999\n\nadonis2(formula = unifrac_distances_phychem30cm ~ Temperature...C. + Salinity..ppm. + pH + Redox.mV..Eh. + S.2..mg.l. + SO....mg.l., data = phychem, permutations = 999, by = \"terms\")\n                 Df SumOfSqs    R2    F Pr(&gt;F)  \nTemperature...C.  1    0.208 0.209 3.23  0.017 *\nSalinity..ppm.    1    0.120 0.121 1.87  0.122  \npH                1    0.064 0.065 1.00  0.406  \nRedox.mV..Eh.     1    0.051 0.051 0.79  0.565  \nS.2..mg.l.        1    0.108 0.108 1.67  0.172  \nSO....mg.l.       1    0.059 0.059 0.92  0.459  \nResidual          6    0.385 0.388              \nTotal            12    0.995 1.000              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#permanova-plot",
    "href": "03.3.BetaDiversity.html#permanova-plot",
    "title": "Beta diversity",
    "section": "03.6 PERMANOVA Plot",
    "text": "03.6 PERMANOVA Plot\n\n# Extract PERMANOVA results\npermanova_df &lt;- data.frame(\n  Variable = rownames(permanova_result)[1:(nrow(permanova_result)-2)],\n  R2 = permanova_result$R2[1:(nrow(permanova_result)-2)],\n  p_value = permanova_result$`Pr(&gt;F)`[1:(nrow(permanova_result)-2)])\n\n# names\nvar_abbrevs &lt;- c(\n  \"Temperature...C.\" = \"Temperature\",\n  \"Salinity..ppm.\" = \"Salinity\",\n  \"pH\" = \"pH\",\n  \"Redox.mV..Eh.\" = \"Redox\",\n  \"S.2..mg.l.\" = \"S2\",\n  \"SO....mg.l.\" = \"Sulfates\")\n\npermanova_df$Variable &lt;- var_abbrevs[permanova_df$Variable]\n\n\n# plot\npermanova_plot &lt;- ggplot(permanova_df, aes(x = Variable, \n                        y = R2, fill = p_value &lt; 0.05)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = c(\"TRUE\" = \"cyan4\", \"FALSE\" = \"gray80\"), \n                labels = c(\"TRUE\" = \"p &lt; 0.05\", \"FALSE\" = \"p ≥ 0.05\")) +\n  labs(x = \"Environmental variable\", \n       y = \"R² Proportion of Variance Explained\", \n       fill = \"Significance\") +\n  theme_classic() +\n  theme(\n    axis.text = element_text(size = 9),\n    axis.title = element_text(size = 12),\n    legend.text = element_text(size = 12),\n    legend.title = element_text(size = 12),\n    plot.title = element_text(size = 12))\n\n# show\npermanova_plot\n\n\n\n\n\n\n\n\nggsave(\"Figures/interior_mangroves/Physicochemyc_Significance.pdf\", permanova_plot, bg='transparent', width = 5.7, height = 4)\n\nWarning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\nfor 'p ≥ 0.05' in 'mbcsToSbcs': &gt;= substituted for ≥ (U+2265)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "03.3.BetaDiversity.html#dbrda-plot",
    "href": "03.3.BetaDiversity.html#dbrda-plot",
    "title": "Beta diversity",
    "section": "03.7 dbRDA Plot",
    "text": "03.7 dbRDA Plot\n\n# Extract site scores\nscores_samples &lt;- scores(dbrda_result, display = \"sites\")\n\n# Convert to data.frame\nscores_df &lt;- data.frame(scores_samples, Location = phychem$Locality)\n\n# Extra environmental scores\nenv_scores &lt;- scores(dbrda_result, display = \"bp\")\nenv_scores_df &lt;- data.frame(env_scores)\nenv_scores_df$Variable &lt;- rownames(env_scores_df)\n\n# Explain variance percentage\nexplained_var &lt;- summary(dbrda_result)$cont$importance[2, 1:2] * 100  # CAP1 and CAP2\n\n#plot\ncapphychem_plot &lt;- ggplot(scores_df, aes(x = CAP1, y = CAP2, \n  color = Location)) + geom_point(size = 5) + theme_classic() +  \n  labs(\n    col = \"Location\",\n    title = \"db-RDA Unweighted UniFrac\",\n    x = paste0(\"CAP1 (\", round(explained_var[1], 1), \"%)\"),\n    y = paste0(\"CAP2 (\", round(explained_var[2], 1), \"%)\")\n  ) +\n  scale_color_manual(values = loc_colors) +  \n  geom_segment(data = env_scores_df, aes(\n    x = 0, y = 0, xend = CAP1, yend = CAP2),\n               arrow = arrow(length = unit(0.15, \"cm\")), \n    color = \"gray20\", size = 0.6) +\n  # environmental variables\n  geom_text(data = env_scores_df, aes(x = CAP1 * 1.1, \n                            y = CAP2 * 1.1, label = Variable),\n            color = \"black\", size = 3.5) +\n  theme(legend.position = \"right\")\n\ncapphychem_plot\n\n\n\n\n\n\n\n\n#save\nggsave(\"Figures/interior_mangroves/dbRDA.pdf\", capphychem_plot, width = 6, height = 4)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Beta diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html",
    "href": "02.1.AlphaDiversity.html",
    "title": "Alpha diversity",
    "section": "",
    "text": "Tip\n\n\n\nAlpha diversity indices were calculated with Hill numbers (q0 = observed richness, q1 = Shannon Exp and q2 = Inv Simpson). The significance of the observed differences among mangrove systems was determined by employing a linear model, given the imbalanced sample numbers.",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html#load-libraries-and-prepare-data",
    "href": "02.1.AlphaDiversity.html#load-libraries-and-prepare-data",
    "title": "Alpha diversity",
    "section": "Load libraries and prepare data",
    "text": "Load libraries and prepare data\n\n#Load libraries\nlibrary(phyloseq)\nlibrary(hilldiv)\nlibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(vegan)\nlibrary(emmeans)\nlibrary(multcomp)\n\n\n#load data\nphyseq_qiime3 &lt;- readRDS(\"rds/compare_mangroves/physeq_qiime3.rds\")\n\n\n#Mangrove system colors\nloc_colors &lt;- c(\"Fossil Lagoon\"= \"#A7fcc1\",\n                \"San Pedro River\" = \"#26B170\",\n                \"Términos Lagoon\" = \"#329D9C\",\n                \"Celestún Lagoon\" = \"#41e8d3\")\n\n\n# Extract data from phyloseq object\n#library(phyloseq)\notu_data &lt;- otu_table(physeq_qiime3, taxa_are_rows = TRUE)\nmetadata &lt;- as(sample_data(physeq_qiime3), \"data.frame\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html#get-hill-numbers",
    "href": "02.1.AlphaDiversity.html#get-hill-numbers",
    "title": "Alpha diversity",
    "section": "01. Get Hill numbers",
    "text": "01. Get Hill numbers\n\n# Calculate hill numbers\n#library(hilldiv)\n\nq0 &lt;- hill_div(otu_data, qvalue = 0)\nq1 &lt;- hill_div(otu_data, qvalue = 1)\nq2 &lt;- hill_div(otu_data, qvalue = 2)\n\n# Merge metadata with Hill numbers\n#library(tidyverse)\nq012 &lt;- cbind(q0, q1, q2) %&gt;% as.data.frame() %&gt;%\n  rownames_to_column(var = \"SampleID\")\n\n# join\nmetadata_with_hill &lt;- q012 %&gt;%\n  inner_join(metadata, by = c(\"SampleID\"=\"SampleID\"))\n\n# show\nmetadata_with_hill %&gt;% head()\n\n  SampleID   q0  q1    q2 BioSample  ID    SRA SampleName Collection_date depth\n1   S1A015 1266 330 106.0    S1A015 RSP S1A015                 2023-09-28  0-15\n2    S1B07 1502 164  36.0     S1B07 RSP  S1B07                 2023-09-28  0-15\n3    S2B07 1378 351 106.8     S2B07 RSP  S2B07                 2023-09-28  0-15\n4    S3A07 1190 154  37.6     S3A07 RSP  S3A07                 2023-09-28  0-15\n5    S4B07 1563 388 120.4     S4B07 RSP  S4B07                 2023-09-29  0-15\n6    S5A07 1160 131  32.1     S5A07 RSP  S5A07                 2023-09-29  0-15\n  site elevation Broad_scale_environmental_context\n1   1A        NA                                  \n2   1B        NA                                  \n3   2B        NA                                  \n4   3A        NA                                  \n5   4B        NA                                  \n6   5A        NA                                  \n  Local_scale_environmental_context Environmental_medium Latitude_and_Longitude\n1                                                                              \n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n  Geographic.Location    Study_zone Ecological_type Parametros Temperatura\n1      Mexico:Tabasco Rio San Pedro          Fringe         no          NA\n2      Mexico:Tabasco Rio San Pedro          Fringe         no          NA\n3      Mexico:Tabasco Rio San Pedro          Fringe         no          NA\n4      Mexico:Tabasco Rio San Pedro          Fringe         no          NA\n5      Mexico:Tabasco Rio San Pedro          Fringe         no          NA\n6      Mexico:Tabasco Rio San Pedro          Fringe         no          NA\n  Salinidad pH Redox.mV S.2 SO4 season filter Mangrove.system Mangrove_type\n1        NA NA       NA  NA  NA  flood     si San Pedro River      Interior\n2        NA NA       NA  NA  NA  flood     si San Pedro River      Interior\n3        NA NA       NA  NA  NA  flood     si San Pedro River      Interior\n4        NA NA       NA  NA  NA  flood     si San Pedro River      Interior\n5        NA NA       NA  NA  NA  flood     si San Pedro River      Interior\n6        NA NA       NA  NA  NA  flood     si San Pedro River      Interior\n\n#save table\nwrite.table(metadata_with_hill, \"Tables/SurfaceComparison/Metadata_with_hill.tsv\",\n            quote = FALSE, sep = \"\\t\", row.names = TRUE, col.names=TRUE)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html#get-hill-means",
    "href": "02.1.AlphaDiversity.html#get-hill-means",
    "title": "Alpha diversity",
    "section": "02. Get Hill means",
    "text": "02. Get Hill means\n\n# Reorder q values\nmeta_qs &lt;- metadata_with_hill %&gt;%\n  pivot_longer(cols = q0:q2, names_to = \"q\", values_to = \"value\") %&gt;%\n  filter(q %in% c(\"q0\", \"q1\", \"q2\")) %&gt;%\n  mutate(\n    qs = case_when(\n      q == \"q0\" ~ \"q0=Observed\",\n      q == \"q1\" ~ \"q1=Exp Shannon\",\n      q == \"q2\" ~ \"q2=Inv Simpson\",\n    ))\n\n#Get means of Hill numbers\nmeans &lt;- meta_qs %&gt;% group_by(Mangrove_type, Mangrove.system, qs) %&gt;%\n  summarise(means = mean(value, na.rm = TRUE),\n            sd = sd(value, na.rm = TRUE),\n            .groups = 'drop')\n\nprint(means)\n\n# A tibble: 12 × 5\n   Mangrove_type Mangrove.system qs              means    sd\n   &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;\n 1 Coastal       Celestún Lagoon q0=Observed    1202   207. \n 2 Coastal       Celestún Lagoon q1=Exp Shannon  496.   87.6\n 3 Coastal       Celestún Lagoon q2=Inv Simpson  234.   40.5\n 4 Coastal       Términos Lagoon q0=Observed     140    61.8\n 5 Coastal       Términos Lagoon q1=Exp Shannon   78.8  48.9\n 6 Coastal       Términos Lagoon q2=Inv Simpson   51.2  32.7\n 7 Interior      Fossil Lagoon   q0=Observed    1230   134. \n 8 Interior      Fossil Lagoon   q1=Exp Shannon  300.   75.1\n 9 Interior      Fossil Lagoon   q2=Inv Simpson   86.5  26.9\n10 Interior      San Pedro River q0=Observed    1368.  166. \n11 Interior      San Pedro River q1=Exp Shannon  254.  105. \n12 Interior      San Pedro River q2=Inv Simpson   71.7  38.4\n\n#save table\nwrite.table(means, \"Tables/SurfaceComparison/Hill_means_sd.tsv\", quote = FALSE,\n            sep = \"\\t\", row.names = TRUE, col.names=TRUE)\n\n# group by mangrove type\nmeans_mangrove_type &lt;- meta_qs %&gt;% group_by(Mangrove_type, qs) %&gt;%\n  summarise(means = mean(value, na.rm = TRUE),\n            sd = sd(value, na.rm = TRUE),\n            .groups = 'drop')\n\nprint(means_mangrove_type)\n\n# A tibble: 6 × 4\n  Mangrove_type qs              means    sd\n  &lt;chr&gt;         &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;\n1 Coastal       q0=Observed     974.  488. \n2 Coastal       q1=Exp Shannon  407.  195. \n3 Coastal       q2=Inv Simpson  194.   86.3\n4 Interior      q0=Observed    1318.  163. \n5 Interior      q1=Exp Shannon  271.   94.0\n6 Interior      q2=Inv Simpson   77.1  34.0\n\nwrite.table(means, \"Tables/SurfaceComparison/Hill_means_sd_mangrove_type.tsv\", quote = FALSE,\n            sep = \"\\t\", row.names = TRUE, col.names=TRUE)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html#get-sequencing-effort",
    "href": "02.1.AlphaDiversity.html#get-sequencing-effort",
    "title": "Alpha diversity",
    "section": "03. Get sequencing effort",
    "text": "03. Get sequencing effort\n\n### Sample effort\n#library(vegan)\nmat &lt;- as(t(otu_table(physeq_qiime3)), \"matrix\")\nraremax &lt;- min(rowSums(mat))\n\n# plot\nsystem.time(rarecurve(mat, step = 100, sample = raremax, col = \"green4\", \n                      label = FALSE))\n\n\n\n\n\n\n\n   user  system elapsed \n   4.71    0.15    4.88 \n\n# save\npdf(\"Figures/SurfaceComparison/sample_effort.pdf\")\nsystem.time(rarecurve(mat, step = 100, sample = raremax, col = \"green4\", \n                      label = FALSE))\n\n   user  system elapsed \n  4.927   0.141   5.096 \n\ndev.off()\n\nquartz_off_screen \n                2",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html#get-significant-differences",
    "href": "02.1.AlphaDiversity.html#get-significant-differences",
    "title": "Alpha diversity",
    "section": "04. Get significant differences",
    "text": "04. Get significant differences\n\n\n\n\n\n\nRemember\n\n\n\nThe significance of the observed differences among mangrove systems was determined by employing a linear model, given the imbalanced sample numbers.\n\n\n\n# change variable to factor\nmetadata_with_hill$Mangrove.system &lt;- \n  factor(metadata_with_hill$Mangrove.system)\n\n# Change to Fossil Lagoon reference\nmetadata_with_hill$Mangrove.system &lt;- \n  relevel(metadata_with_hill$Mangrove.system,ref = \"Fossil Lagoon\")\n\nq0 Observed richness\n\n# linear model adjust\nq0lm &lt;- lm(q0 ~ Mangrove.system, data = metadata_with_hill)\n# summary\nsummary(q0lm)\n\n\nCall:\nlm(formula = q0 ~ Mangrove.system, data = metadata_with_hill)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-334.0 -102.4    9.6  140.0  247.0 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                      1230.0       88.3   13.93  4.5e-12 ***\nMangrove.systemCelestún Lagoon    -28.0      103.1   -0.27     0.79    \nMangrove.systemSan Pedro River    138.4      110.7    1.25     0.22    \nMangrove.systemTérminos Lagoon  -1090.0      134.9   -8.08  7.0e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 177 on 21 degrees of freedom\nMultiple R-squared:  0.84,  Adjusted R-squared:  0.817 \nF-statistic: 36.7 on 3 and 21 DF,  p-value: 1.56e-08\n\n# check model reliability\nshapiro.test(residuals(q0lm))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(q0lm)\nW = 1, p-value = 0.4\n\n\n\n# get differences with emmeans\n#library(emmeans)\nq0_lm_means &lt;- emmeans(q0lm, pairwise ~ Mangrove.system)\n\n# get significance letters\n#library(multcomp)\ncld_results &lt;- cld(object = q0_lm_means$emmeans, Letters = letters)\n\n# Convertir a data frame\nq0_emmeans_df &lt;- as.data.frame(cld_results)\nq0_emmeans_df\n\n Mangrove.system emmean    SE df lower.CL upper.CL .group\n Términos Lagoon    140 102.0 21      -72      352  a    \n Celestún Lagoon   1202  53.3 21     1091     1313   b   \n Fossil Lagoon     1230  88.3 21     1046     1414   b   \n San Pedro River   1368  66.8 21     1230     1507   b   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Reorder samples\nmetadata_with_hill$Mangrove.system &lt;- factor(\n  metadata_with_hill$Mangrove.system,\n  levels = c(\"Fossil Lagoon\", \"San Pedro River\", \n             \"Términos Lagoon\", \"Celestún Lagoon\"))\n\n\n# boxplot with significance\nq0plot &lt;- ggplot(metadata_with_hill, aes(x = Mangrove.system, y = q0, fill = Mangrove.system)) +\n  geom_boxplot() +\n  #geom_jitter(aes(fill = Mangrove.system), width = 0.1, alpha = 0.4) +\n  geom_text(data = q0_emmeans_df, aes(y = emmean, label = .group), vjust = -3,\n          color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"q0 = Observed\", y = NULL, x = NULL) + #,\n  #caption = \"letters by lm emmeans\") +\n  theme_classic() + scale_fill_manual(values = loc_colors) +\n  theme(legend.position = \"none\", axis.text.x = element_blank())\n\nq1 Diversity Exp Shannon\n\n# linear model\nq1lm &lt;- lm(q1 ~ Mangrove.system, data = metadata_with_hill)\n\n# summary\nsummary(q1lm)\n\n\nCall:\nlm(formula = q1 ~ Mangrove.system, data = metadata_with_hill)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-131.78  -90.32    8.03   70.63  150.27 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                       300.0       44.3    6.77  1.1e-06 ***\nMangrove.systemSan Pedro River    -45.6       55.5   -0.82   0.4209    \nMangrove.systemTérminos Lagoon   -221.2       67.6   -3.27   0.0037 ** \nMangrove.systemCelestún Lagoon    196.2       51.7    3.79   0.0011 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 88.6 on 21 degrees of freedom\nMultiple R-squared:  0.763, Adjusted R-squared:  0.729 \nF-statistic: 22.5 on 3 and 21 DF,  p-value: 9.24e-07\n\n#check model reliability\nshapiro.test(residuals(q1lm))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(q1lm)\nW = 0.9, p-value = 0.2\n\n# significance\nq1_lm_means &lt;- emmeans(q1lm, pairwise ~ Mangrove.system)\ncld_results &lt;- cld(object = q1_lm_means$emmeans, Letters = letters)\n\n# Convert to data frame\nq1_emmeans_df &lt;- as.data.frame(cld_results)\nq1_emmeans_df\n\n Mangrove.system emmean   SE df lower.CL upper.CL .group\n Términos Lagoon     79 51.1 21      -28      185  a    \n San Pedro River    254 33.5 21      185      324   b   \n Fossil Lagoon      300 44.3 21      208      392   b   \n Celestún Lagoon    496 26.7 21      441      552    c  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# boxplot\nq1plot &lt;- ggplot(metadata_with_hill, aes(x = Mangrove.system , y = q1, fill = Mangrove.system)) +\n  geom_boxplot() +\n  #geom_jitter(aes(fill = Mangrove.system), width = 0.1, alpha = 0.4) +\n  geom_text(data = q1_emmeans_df, aes(y = emmean, label = .group), vjust = -5,\n          color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +   labs(title = \"q1 = Exp Shannon\", y = NULL, x = NULL) + #,\n  #caption = \"letters by lm emmeans\") +\n  theme_classic() + scale_fill_manual(values = loc_colors) +\n  theme(legend.position = \"none\", axis.text.x = element_blank())\n\nq2 Dominance Inv Simpson\n\n# Model\nq2lm &lt;- lm(q2 ~ Mangrove.system, data = metadata_with_hill)\n\n# summary\nsummary(q2lm)\n\n\nCall:\nlm(formula = q2 ~ Mangrove.system, data = metadata_with_hill)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-54.83 -34.13  -3.61  19.39  88.13 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                        86.5       18.7    4.62  0.00015 ***\nMangrove.systemSan Pedro River    -14.8       23.5   -0.63  0.53567    \nMangrove.systemTérminos Lagoon    -35.4       28.6   -1.23  0.23063    \nMangrove.systemCelestún Lagoon    147.0       21.9    6.72  1.2e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 37.5 on 21 degrees of freedom\nMultiple R-squared:  0.847, Adjusted R-squared:  0.825 \nF-statistic: 38.8 on 3 and 21 DF,  p-value: 9.48e-09\n\n#check model reliability\nshapiro.test(residuals(q2lm))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(q2lm)\nW = 0.9, p-value = 0.2\n\n# get significance\nq2_lm_means &lt;- emmeans(q2lm, pairwise ~ Mangrove.system)\ncld_results &lt;- cld(object = q2_lm_means$emmeans, Letters = letters)\n\n# Convert to data frame\nq2_emmeans_df &lt;- as.data.frame(cld_results)\nq2_emmeans_df\n\n Mangrove.system emmean   SE df lower.CL upper.CL .group\n Términos Lagoon   51.2 21.6 21      6.1     96.2  a    \n San Pedro River   71.7 14.2 21     42.3    101.2  a    \n Fossil Lagoon     86.5 18.8 21     47.5    125.5  a    \n Celestún Lagoon  233.5 11.3 21    210.0    257.0   b   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# boxplot\nq2plot &lt;- ggplot(metadata_with_hill, aes(x = Mangrove.system, y = q2, fill = Mangrove.system)) +\n  geom_boxplot() +\n  #geom_jitter(aes(fill = Mangrove.system), width = 0.1, alpha = 0.4) +\n  geom_text(data = q2_emmeans_df, aes(y = emmean, label = .group), vjust = -5,\n            color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"q2 = Inv Simpson\", y = NULL, x = NULL,\n  caption = \"letters by lm emmeans\") +\n  theme_classic() + scale_fill_manual(values = loc_colors) +\n  theme(legend.position = \"none\")\n\nCombine plots\n\n#Combine alpha diversity plots\n# library(ggplot2)\n# library(cowplot)\n\nytitle &lt;- ggdraw() + draw_label(\"Effective number of ASVs\",\n                                angle = 90, size = 14 )\nq012plot &lt;- plot_grid(q0plot, q1plot, q2plot,\n                      labels = c(\"A)\", \"\", \"\"), ncol = 1)\nq012y_plot &lt;- plot_grid(ytitle, q012plot, ncol = 2, rel_widths = c(0.05, 1))\n\n# show\nq012y_plot\n\n\n\n\n\n\n# save\nggsave(\"Figures/SurfaceComparison/alphadiv_per_loc.pdf\",\n       q012y_plot, width = 6.3, height = 9.9)",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "02.1.AlphaDiversity.html#save-rds-alpha-diversity-plot",
    "href": "02.1.AlphaDiversity.html#save-rds-alpha-diversity-plot",
    "title": "Alpha diversity",
    "section": "Save rds alpha diversity plot",
    "text": "Save rds alpha diversity plot\n\nsaveRDS(q012y_plot, \"rds/compare_mangroves/alpha_diversity_surface_plot.rds\")",
    "crumbs": [
      "Interior and coastal mangroves compare",
      "How similar are coastal and inland mangroves?",
      "Analysis",
      "Alpha diversity"
    ]
  },
  {
    "objectID": "03.2.AlphaDiversity.html",
    "href": "03.2.AlphaDiversity.html",
    "title": "Alpha Diversity",
    "section": "",
    "text": "#Load libraries\nlibrary(phyloseq)\nlibrary(ape)\nlibrary(qiime2R)\nlibrary(hilldiv)\nlibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(vegan)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(lme4)\nlibrary(lmerTest)\nlibrary(easystats)\n\n\n#load data\nps &lt;- readRDS(\"rds/interior_mangroves/phyloseq.rds\")\n\n\n# Extract data from phyloseq object\n#library(phyloseq)\notu_table &lt;- otu_table(ps, taxa_are_rows = TRUE)\nmetadata &lt;- as(sample_data(ps), \"data.frame\")\n\n\n# Extract tree\n#libary(ape)\n#library(qiime2R)\ntree &lt;- read_qza(\"data/rooted-tree-iqtree.qza\")$data\ntree_umMPL &lt;- chronoMPL(tree)\n\n\n# color pallet\ndepth_colors &lt;- c(\"0-15\" = \"#f5e5c4\",\n                 \"16-30\" = \"#baa179\",\n                 \"31-45\" = \"#a67451\",\n                 \"50-75\" = \"#80673b\")\n\nloc_colors &lt;- c(\"Fossil Lagoon\"= \"#A3D9A8\",\n                \"Reforma Waterfalls\" = \"#44C17B\",\n                \"Miguelito Dike\" = \"#2E8B57\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Alpha Diversity"
    ]
  },
  {
    "objectID": "03.2.AlphaDiversity.html#by-depth",
    "href": "03.2.AlphaDiversity.html#by-depth",
    "title": "Alpha Diversity",
    "section": "By depth",
    "text": "By depth\nq0 Observed Richness\n\n# lmm\nq0lmer &lt;- lmer(q0 ~ log(Effective_reads) + Depths + Location + (1 | ID), data = metadata_with_hill)\n# summary\nsummary(q0lmer)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: q0 ~ log(Effective_reads) + Depths + Location + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 680\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.3093 -0.5309 -0.0431  0.4842  1.8144 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 210009   458     \n Residual             209059   457     \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error       df t value Pr(&gt;|t|)    \n(Intercept)                -5467.48    2792.66    37.52   -1.96  0.05772 .  \nlog(Effective_reads)         643.23     232.78    37.02    2.76  0.00886 ** \nDepths16-30                  444.48     180.16    32.87    2.47  0.01900 *  \nDepths31-45                  699.07     181.59    32.94    3.85  0.00052 ***\nDepths50-75                  547.05     189.70    33.13    2.88  0.00686 ** \nLocationReforma Waterfalls   752.10     394.68     9.85    1.91  0.08628 .  \nLocationMiguelito Dike       396.38     334.63     9.97    1.18  0.26366    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) lg(E_) D16-30 D31-45 D50-75 LctnRW\nlg(Effctv_) -0.995                                   \nDepths16-30  0.063 -0.095                            \nDepths31-45  0.124 -0.157  0.507                     \nDepths50-75  0.018 -0.045  0.475  0.474              \nLctnRfrmWtr -0.017 -0.044  0.004  0.007 -0.039       \nLoctnMgltDk -0.028 -0.044  0.004  0.007 -0.046  0.517\n\n\n\n# Permutation test con lmerTest\nperm_test &lt;- rand(q0lmer, nsim = 1000)\nperm_test\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nq0 ~ log(Effective_reads) + Depths + Location + (1 | ID)\n         npar logLik AIC  LRT Df Pr(&gt;Chisq)   \n&lt;none&gt;      9   -340 698                      \n(1 | ID)    8   -346 707 10.8  1      0.001 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#effects\nanova(q0lmer)\n\nType III Analysis of Variance Table with Satterthwaite's method\n                      Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)   \nlog(Effective_reads) 1596301 1596301     1  37.0    7.64 0.0089 **\nDepths               3412939 1137646     3  33.0    5.44 0.0037 **\nLocation              770456  385228     2   9.8    1.84 0.2094   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# check model reliability\nreport(q0lmer)\n\nFormula contains log- or sqrt-terms.\n  See help(\"standardize\") for how such terms are standardized.\nFormula contains log- or sqrt-terms.\n  See help(\"standardize\") for how such terms are standardized.\n\n\nWe fitted a linear mixed model (estimated using REML and nloptwrap optimizer)\nto predict q0 with Effective_reads, Depths and Location (formula: q0 ~\nlog(Effective_reads) + Depths + Location). The model included ID as random\neffect (formula: ~1 | ID). The model's total explanatory power is substantial\n(conditional R2 = 0.67) and the part related to the fixed effects alone\n(marginal R2) is of 0.34. The model's intercept, corresponding to\nEffective_reads = 0, Depths = 0-15 and Location = Fossil Lagoon, is at -5467.48\n(95% CI [-11107.37, 172.40], t(41) = -1.96, p = 0.057). Within this model:\n\n  - The effect of Effective reads [log] is statistically significant and positive\n(beta = 643.23, 95% CI [173.12, 1113.33], t(41) = 2.76, p = 0.009; Std. beta =\n0.89, 95% CI [0.23, 1.54])\n  - The effect of Depths [16-30] is statistically significant and positive (beta\n= 444.48, 95% CI [80.64, 808.32], t(41) = 2.47, p = 0.018; Std. beta = 0.57,\n95% CI [0.10, 1.04])\n  - The effect of Depths [31-45] is statistically significant and positive (beta\n= 699.07, 95% CI [332.34, 1065.79], t(41) = 3.85, p &lt; .001; Std. beta = 0.90,\n95% CI [0.43, 1.37])\n  - The effect of Depths [50-75] is statistically significant and positive (beta\n= 547.05, 95% CI [163.93, 930.16], t(41) = 2.88, p = 0.006; Std. beta = 0.69,\n95% CI [0.20, 1.19])\n  - The effect of Location [Reforma Waterfalls] is statistically non-significant\nand positive (beta = 752.10, 95% CI [-44.97, 1549.17], t(41) = 1.91, p = 0.064;\nStd. beta = 0.97, 95% CI [-0.06, 1.99])\n  - The effect of Location [Miguelito Dike] is statistically non-significant and\npositive (beta = 396.38, 95% CI [-279.41, 1072.18], t(41) = 1.18, p = 0.243;\nStd. beta = 0.51, 95% CI [-0.36, 1.38])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n\n\n\n# get differences with emmeans\nq0_lmer_means &lt;- emmeans(q0lmer, pairwise ~ Depths)\n\n# get significance letters\ncld_results &lt;- cld(object = q0_lmer_means$emmeans, Letters = letters)\n\n# Convert to data frame\nq0_emmeans_df &lt;- as.data.frame(cld_results)\nq0_emmeans_df\n\n Depths emmean  SE   df lower.CL upper.CL .group\n 0-15     2699 186 22.2     2313     3085  a    \n 16-30    3143 184 21.6     2760     3526  ab   \n 50-75    3246 196 25.3     2843     3648   b   \n 31-45    3398 184 21.5     3015     3780   b   \n\nResults are averaged over the levels of: Location \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# boxplot with significance\nq0plot &lt;- ggplot(metadata_with_hill, aes(x = Depths, y = q0, fill = Depths)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Depths), width = 0.1, alpha = 0.4) +\n  geom_text(data = q0_emmeans_df, aes(y = emmean, label = .group), vjust = -4, color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"Observed Richness\", y = NULL, x = NULL ) + #,\n       #caption = \"letters by lmer emmeans\") +\n    theme_classic() + scale_fill_manual(values = depth_colors) +\n    theme(legend.position = \"none\",\n          axis.text.y = element_text(size = 9),\n          axis.text.x = element_blank())\n\nq0plot\n\n\n\n\n\n\n\nq1 Diversity Exp Shannon\n\n# Fitted linear mixed model\nq1lmer &lt;- lmer(q1 ~ Depths+Location  + (1 | ID), data = metadata_with_hill)\n# summary\nsummary(q1lmer)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: q1 ~ Depths + Location + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 627\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.6697 -0.6187  0.0827  0.3962  2.4515 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 35546    189     \n Residual             47469    218     \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error    df t value Pr(&gt;|t|)    \n(Intercept)                   596.2      121.9  15.3    4.89  0.00019 ***\nDepths16-30                   214.1       85.5  34.2    2.51  0.01716 *  \nDepths31-45                   165.5       85.5  34.2    1.94  0.06116 .  \nDepths50-75                   131.8       90.3  34.5    1.46  0.15340    \nLocationReforma Waterfalls     98.3      168.0  10.3    0.59  0.57086    \nLocationMiguelito Dike         23.7      142.5  10.5    0.17  0.87137    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) D16-30 D31-45 D50-75 LctnRW\nDepths16-30 -0.351                            \nDepths31-45 -0.351  0.500                     \nDepths50-75 -0.289  0.473  0.473              \nLctnRfrmWtr -0.598  0.000  0.000 -0.045       \nLoctnMgltDk -0.704  0.000  0.000 -0.053  0.518\n\n\n\n# lmerTest\nperm_testq1 &lt;- rand(q1lmer, nsim = 1000)\n\n# Summary\nperm_testq1\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nq1 ~ Depths + Location + (1 | ID)\n         npar logLik AIC  LRT Df Pr(&gt;Chisq)   \n&lt;none&gt;      8   -313 643                      \n(1 | ID)    7   -318 650 8.94  1     0.0028 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Efects\nanova(q1lmer)\n\nType III Analysis of Variance Table with Satterthwaite's method\n         Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)  \nDepths   327747  109249     3  34.3    2.30  0.095 .\nLocation  17497    8749     2  10.2    0.18  0.834  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n#check_model(q1lmer)\nreport(q1lmer)\n\nWe fitted a linear mixed model (estimated using REML and nloptwrap optimizer)\nto predict q1 with Depths and Location (formula: q1 ~ Depths + Location). The\nmodel included ID as random effect (formula: ~1 | ID). The model's total\nexplanatory power is substantial (conditional R2 = 0.48) and the part related\nto the fixed effects alone (marginal R2) is of 0.09. The model's intercept,\ncorresponding to Depths = 0-15 and Location = Fossil Lagoon, is at 596.15 (95%\nCI [350.16, 842.15], t(42) = 4.89, p &lt; .001). Within this model:\n\n  - The effect of Depths [16-30] is statistically significant and positive (beta\n= 214.10, 95% CI [41.64, 386.56], t(42) = 2.51, p = 0.016; Std. beta = 0.76,\n95% CI [0.15, 1.38])\n  - The effect of Depths [31-45] is statistically non-significant and positive\n(beta = 165.46, 95% CI [-7.00, 337.92], t(42) = 1.94, p = 0.060; Std. beta =\n0.59, 95% CI [-0.02, 1.20])\n  - The effect of Depths [50-75] is statistically non-significant and positive\n(beta = 131.76, 95% CI [-50.39, 313.91], t(42) = 1.46, p = 0.152; Std. beta =\n0.47, 95% CI [-0.18, 1.12])\n  - The effect of Location [Reforma Waterfalls] is statistically non-significant\nand positive (beta = 98.34, 95% CI [-240.64, 437.32], t(42) = 0.59, p = 0.561;\nStd. beta = 0.35, 95% CI [-0.86, 1.56])\n  - The effect of Location [Miguelito Dike] is statistically non-significant and\npositive (beta = 23.65, 95% CI [-263.97, 311.27], t(42) = 0.17, p = 0.869; Std.\nbeta = 0.08, 95% CI [-0.94, 1.11])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n\n\n\n# Sig dif emmeans\nq1_lmer_means &lt;- emmeans(q1lmer, pairwise ~ Depths)\n\n# letters\ncld_resultsq1 &lt;- cld(object = q1_lmer_means$emmeans, Letters = letters)\n\n# Convert df\nemmeans_dfq1 &lt;- as.data.frame(cld_resultsq1)\nemmeans_dfq1\n\n Depths emmean   SE   df lower.CL upper.CL .group\n 0-15      637 81.8 24.7      468      805  a    \n 50-75     769 87.1 28.6      590      947  a    \n 31-45     802 81.8 24.7      634      971  a    \n 16-30     851 81.8 24.7      682     1019  a    \n\nResults are averaged over the levels of: Location \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# plot\nq1plot &lt;- ggplot(metadata_with_hill, aes(x = Depths, y = q1, fill = Depths)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Depths), width = 0.1, alpha = 0.4) +\n  geom_text(data = emmeans_dfq1, aes(y = emmean, label = .group), vjust = -9, color = \"black\", fontface = \"bold\",position = position_dodge(0.9)) +\n  labs(title = \"Exp Shannon\", y = NULL, x = NULL ) + #,\n       #caption = \"letters by lmer emmeans\") +\n    theme_bw() + scale_fill_manual(values = depth_colors) +\n    theme(legend.position = \"none\")\nq1plot\n\n\n\n\n\n\n\nq2 Dominance Inv Simpson\n\n# Fitted linear mixed model\nq2lmer &lt;- lmer(q2 ~ Depths+Location +(1 | ID), data = metadata_with_hill)\n#summary\nsummary(q2lmer)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: q2 ~ Depths + Location + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 542\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.7063 -0.6064  0.0468  0.5556  2.3862 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 2840     53.3    \n Residual             7832     88.5    \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error     df t value Pr(&gt;|t|)    \n(Intercept)                  166.94      41.16  18.56    4.06   0.0007 ***\nDepths16-30                   87.60      34.71  34.19    2.52   0.0164 *  \nDepths31-45                   31.89      34.71  34.19    0.92   0.3647    \nDepths50-75                   35.58      36.61  34.70    0.97   0.3378    \nLocationReforma Waterfalls    10.23      53.74  10.38    0.19   0.8527    \nLocationMiguelito Dike         1.72      45.70  10.62    0.04   0.9706    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) D16-30 D31-45 D50-75 LctnRW\nDepths16-30 -0.422                            \nDepths31-45 -0.422  0.500                     \nDepths50-75 -0.349  0.474  0.474              \nLctnRfrmWtr -0.570  0.000  0.000 -0.056       \nLoctnMgltDk -0.671  0.000  0.000 -0.066  0.525\n\n\n\n# lmerTest\nperm_testq2 &lt;- rand(q2lmer, nsim = 1000)\n\n# Summary\nperm_testq2\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nq2 ~ Depths + Location + (1 | ID)\n         npar logLik AIC LRT Df Pr(&gt;Chisq)  \n&lt;none&gt;      8   -271 559                    \n(1 | ID)    7   -273 560 3.5  1      0.061 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Efects\nanova(q2lmer)\n\nType III Analysis of Variance Table with Satterthwaite's method\n         Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)\nDepths    51262   17087     3  34.4    2.18   0.11\nLocation    326     163     2  10.2    0.02   0.98\n\n\n\n#check_model(q2lmer)\nreport(q2lmer)\n\nWe fitted a linear mixed model (estimated using REML and nloptwrap optimizer)\nto predict q2 with Depths and Location (formula: q2 ~ Depths + Location). The\nmodel included ID as random effect (formula: ~1 | ID). The model's total\nexplanatory power is substantial (conditional R2 = 0.33) and the part related\nto the fixed effects alone (marginal R2) is of 0.09. The model's intercept,\ncorresponding to Depths = 0-15 and Location = Fossil Lagoon, is at 166.94 (95%\nCI [83.88, 250.00], t(42) = 4.06, p &lt; .001). Within this model:\n\n  - The effect of Depths [16-30] is statistically significant and positive (beta\n= 87.60, 95% CI [17.55, 157.65], t(42) = 2.52, p = 0.015; Std. beta = 0.86, 95%\nCI [0.17, 1.55])\n  - The effect of Depths [31-45] is statistically non-significant and positive\n(beta = 31.89, 95% CI [-38.16, 101.94], t(42) = 0.92, p = 0.364; Std. beta =\n0.31, 95% CI [-0.38, 1.00])\n  - The effect of Depths [50-75] is statistically non-significant and positive\n(beta = 35.58, 95% CI [-38.29, 109.46], t(42) = 0.97, p = 0.337; Std. beta =\n0.35, 95% CI [-0.38, 1.08])\n  - The effect of Location [Reforma Waterfalls] is statistically non-significant\nand positive (beta = 10.23, 95% CI [-98.22, 118.68], t(42) = 0.19, p = 0.850;\nStd. beta = 0.10, 95% CI [-0.97, 1.17])\n  - The effect of Location [Miguelito Dike] is statistically non-significant and\npositive (beta = 1.72, 95% CI [-90.50, 93.94], t(42) = 0.04, p = 0.970; Std.\nbeta = 0.02, 95% CI [-0.89, 0.92])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n\n\n\n# Sig dif emmeans\nq2_lmer_means &lt;- emmeans(q2lmer, pairwise ~ Depths)\n\n# letters\ncld_resultsq2 &lt;- cld(object = q2_lmer_means$emmeans, Letters = letters)\n\n# Convert df\nemmeans_dfq2 &lt;- as.data.frame(cld_resultsq2)\nemmeans_dfq2\n\n Depths emmean   SE   df lower.CL upper.CL .group\n 0-15      171 29.2 32.4      112      230  a    \n 31-45     203 29.2 32.4      143      262  a    \n 50-75     206 31.6 36.2      142      271  a    \n 16-30     258 29.2 32.4      199      318  a    \n\nResults are averaged over the levels of: Location \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# plot\nq2plot &lt;- ggplot(metadata_with_hill, aes(x = Depths, y = q2, fill = Depths)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Depths), width = 0.1, alpha = 0.4) +\n  geom_text(data = emmeans_dfq2, aes(y = emmean, label = .group), vjust = -9, color = \"black\", fontface = \"bold\",position = position_dodge(0.9)) +\n  labs(title = \"q2 = Inv Simpson\", y = NULL, x = NULL ) + #,\n       #caption = \"letters by lmer emmeans\") +\n    theme_bw() + scale_fill_manual(values = depth_colors) +\n    theme(legend.position = \"none\")\nq2plot\n\n\n\n\n\n\n\nqf Faith Diversity\n\n# Fitted linear mixed model\nqflmer &lt;- lmer(qf ~ + log(Effective_reads) + Depths + Location  + (1 | ID), data = metadata_with_hill)\n#summary\nsummary(qflmer)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: qf ~ +log(Effective_reads) + Depths + Location + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 428\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.6973 -0.3974 -0.0189  0.5074  1.9272 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 620      24.9    \n Residual             589      24.3    \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)                 -152.26     148.43   37.39   -1.03  0.31157    \nlog(Effective_reads)          28.23      12.37   36.87    2.28  0.02836 *  \nDepths16-30                   26.14       9.56   32.85    2.73  0.01003 *  \nDepths31-45                   41.53       9.64   32.91    4.31  0.00014 ***\nDepths50-75                   32.48      10.07   33.10    3.23  0.00283 ** \nLocationReforma Waterfalls    25.37      21.34    9.83    1.19  0.26247    \nLocationMiguelito Dike        11.02      18.09    9.95    0.61  0.55613    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) lg(E_) D16-30 D31-45 D50-75 LctnRW\nlg(Effctv_) -0.995                                   \nDepths16-30  0.063 -0.095                            \nDepths31-45  0.125 -0.157  0.507                     \nDepths50-75  0.019 -0.045  0.475  0.474              \nLctnRfrmWtr -0.019 -0.043  0.004  0.007 -0.038       \nLoctnMgltDk -0.030 -0.043  0.004  0.007 -0.045  0.517\n\n\n\n# lmerTest\nperm_testqf &lt;- rand(qflmer, nsim = 1000)\n\n# Summary\nperm_testqf\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nqf ~ log(Effective_reads) + Depths + Location + (1 | ID)\n         npar logLik AIC  LRT Df Pr(&gt;Chisq)    \n&lt;none&gt;      9   -214 446                       \n(1 | ID)    8   -220 456 11.3  1    0.00078 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Efects\nanova(qflmer)\n\nType III Analysis of Variance Table with Satterthwaite's method\n                     Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)   \nlog(Effective_reads)   3067    3067     1  36.9    5.21 0.0284 * \nDepths                12031    4010     3  33.0    6.81 0.0011 **\nLocation                832     416     2   9.8    0.71 0.5169   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n#check_model(qflmer)\nreport(qflmer)\n\nFormula contains log- or sqrt-terms.\n  See help(\"standardize\") for how such terms are standardized.\nFormula contains log- or sqrt-terms.\n  See help(\"standardize\") for how such terms are standardized.\n\n\nWe fitted a linear mixed model (estimated using REML and nloptwrap optimizer)\nto predict qf with Effective_reads, Depths and Location (formula: qf ~\n+log(Effective_reads) + Depths + Location). The model included ID as random\neffect (formula: ~1 | ID). The model's total explanatory power is substantial\n(conditional R2 = 0.65) and the part related to the fixed effects alone\n(marginal R2) is of 0.28. The model's intercept, corresponding to\nEffective_reads = 0, Depths = 0-15 and Location = Fossil Lagoon, is at -152.26\n(95% CI [-452.03, 147.50], t(41) = -1.03, p = 0.311). Within this model:\n\n  - The effect of Effective reads [log] is statistically significant and positive\n(beta = 28.23, 95% CI [3.25, 53.21], t(41) = 2.28, p = 0.028; Std. beta = 0.76,\n95% CI [0.08, 1.44])\n  - The effect of Depths [16-30] is statistically significant and positive (beta\n= 26.14, 95% CI [6.82, 45.45], t(41) = 2.73, p = 0.009; Std. beta = 0.66, 95%\nCI [0.17, 1.14])\n  - The effect of Depths [31-45] is statistically significant and positive (beta\n= 41.53, 95% CI [22.06, 61.00], t(41) = 4.31, p &lt; .001; Std. beta = 1.04, 95%\nCI [0.55, 1.53])\n  - The effect of Depths [50-75] is statistically significant and positive (beta\n= 32.48, 95% CI [12.14, 52.82], t(41) = 3.23, p = 0.002; Std. beta = 0.81, 95%\nCI [0.30, 1.32])\n  - The effect of Location [Reforma Waterfalls] is statistically non-significant\nand positive (beta = 25.37, 95% CI [-17.73, 68.46], t(41) = 1.19, p = 0.241;\nStd. beta = 0.64, 95% CI [-0.44, 1.72])\n  - The effect of Location [Miguelito Dike] is statistically non-significant and\npositive (beta = 11.02, 95% CI [-25.52, 47.55], t(41) = 0.61, p = 0.546; Std.\nbeta = 0.28, 95% CI [-0.64, 1.20])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n\n\n\n# Sig dif emmeans\nqf_lmer_means &lt;- emmeans(qflmer, pairwise ~ Depths)\n\n# letters\ncld_resultsqf &lt;- cld(object = qf_lmer_means$emmeans, Letters = letters)\n\n# Convert df\nemmeans_dfqf &lt;- as.data.frame(cld_resultsqf)\nemmeans_dfqf\n\n Depths emmean    SE   df lower.CL upper.CL .group\n 0-15      202 10.01 21.7      181      222  a    \n 16-30     228  9.91 21.2      207      248   b   \n 50-75     234 10.50 24.8      212      256   b   \n 31-45     243  9.90 21.1      222      264   b   \n\nResults are averaged over the levels of: Location \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 4 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# plot\nqfplot &lt;- ggplot(metadata_with_hill, aes(x = Depths, y = qf, fill = Depths)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Depths), width = 0.1, alpha = 0.4) +\n  geom_text(data = emmeans_dfqf, aes(y = emmean, label = .group), vjust = -3, color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"PD Faith\", y = NULL, x = NULL,\n       caption = \"lmer (depth, location and sediment core)\") +\n    theme_classic() + scale_fill_manual(values = depth_colors) +\n    theme(legend.position = \"none\",\n          axis.text.y = element_text(size = 9),\n          axis.text.x = element_text(size = 9),\n    plot.caption = element_text(size = 7, face = \"italic\"))\nqfplot\n\n\n\n\n\n\n\nCombine plots\n\n\n\n\n\n\nNote\n\n\n\nA combined plot of the observed richness and phylogenetic diversity was created because the former two indices showed significant differences.\n\n\n\n#Combine plot\n\nytitle &lt;- ggdraw() + draw_label(\"Effective number of ASVs\", angle = 90, size = 12)\nalphaplots &lt;- plot_grid(q0plot, qfplot, ncol = 1, rel_heights = c(0.75, 1))\nalphaplots_y &lt;- plot_grid(ytitle, alphaplots, ncol = 2, rel_widths = c(0.05, 1), labels = c(\" \", \"A\"))    \nalphaplots_y\n\n\n\n\n\n\n# save\nggsave(\"Figures/interior_mangroves/alpha_per_depth.pdf\",alphaplots_y, width = 6, height = 8)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Alpha Diversity"
    ]
  },
  {
    "objectID": "03.2.AlphaDiversity.html#by-location",
    "href": "03.2.AlphaDiversity.html#by-location",
    "title": "Alpha Diversity",
    "section": "By location",
    "text": "By location\nq0 Observed Richness\n\n# lmm\nq0lmerloc &lt;- lmer(q0 ~ log(Effective_reads) + Location + Depths + (1 | ID), data = metadata_with_hill)\n# summary\nsummary(q0lmerloc)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: q0 ~ log(Effective_reads) + Location + Depths + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 680\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.3093 -0.5309 -0.0431  0.4842  1.8144 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 210009   458     \n Residual             209059   457     \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error       df t value Pr(&gt;|t|)    \n(Intercept)                -5467.48    2792.66    37.52   -1.96  0.05772 .  \nlog(Effective_reads)         643.23     232.78    37.02    2.76  0.00886 ** \nLocationReforma Waterfalls   752.10     394.68     9.85    1.91  0.08628 .  \nLocationMiguelito Dike       396.38     334.63     9.97    1.18  0.26366    \nDepths16-30                  444.48     180.16    32.87    2.47  0.01900 *  \nDepths31-45                  699.07     181.59    32.94    3.85  0.00052 ***\nDepths50-75                  547.05     189.70    33.13    2.88  0.00686 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) lg(E_) LctnRW LctnMD D16-30 D31-45\nlg(Effctv_) -0.995                                   \nLctnRfrmWtr -0.017 -0.044                            \nLoctnMgltDk -0.028 -0.044  0.517                     \nDepths16-30  0.063 -0.095  0.004  0.004              \nDepths31-45  0.124 -0.157  0.007  0.007  0.507       \nDepths50-75  0.018 -0.045 -0.039 -0.046  0.475  0.474\n\n\n\n# Permutation test \nperm_testloc &lt;- rand(q0lmerloc, nsim = 1000)\nperm_testloc\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nq0 ~ log(Effective_reads) + Location + Depths + (1 | ID)\n         npar logLik AIC  LRT Df Pr(&gt;Chisq)   \n&lt;none&gt;      9   -340 698                      \n(1 | ID)    8   -346 707 10.8  1      0.001 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#effects\nanova(q0lmerloc)\n\nType III Analysis of Variance Table with Satterthwaite's method\n                      Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)   \nlog(Effective_reads) 1596301 1596301     1  37.0    7.64 0.0089 **\nLocation              770456  385228     2   9.8    1.84 0.2094   \nDepths               3412939 1137646     3  33.0    5.44 0.0037 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# emmeans\nq0_lmer_means_loc &lt;- emmeans(q0lmerloc, pairwise ~ Location)\n\n# significance letters\nq0cld_results_loc &lt;- cld(object = q0_lmer_means_loc$emmeans, Letters = letters)\n\n# Convert to data frame\nq0emmeans_df_loc &lt;- as.data.frame(q0cld_results_loc)\nq0emmeans_df_loc\n\n Location           emmean  SE    df lower.CL upper.CL .group\n Fossil Lagoon        2739 262 10.58     2159     3318  a    \n Miguelito Dike       3135 209  9.72     2667     3603  a    \n Reforma Waterfalls   3491 296  9.69     2829     4152  a    \n\nResults are averaged over the levels of: Depths \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# boxplot with significance\nq0plotloc &lt;- ggplot(metadata_with_hill, aes(x = Location, y = q0, fill = Location)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Location), width = 0.1, alpha = 0.4) +\n  geom_text(data = q0emmeans_df_loc, aes(y = emmean, label = .group), vjust = -3, color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"Observed Richness\", y = NULL, x = NULL ) + #,\n       #caption = \"letters by lmer emmeans\") +\n    theme_classic() + scale_fill_manual(values = loc_colors) +\n    theme(legend.position = \"none\", axis.text.x = element_blank())\n\nq1 Exp Shannon diversity\n\n# lmm\nq1lmerloc &lt;- lmer(q1 ~ Location + Depths + (1 | ID), data = metadata_with_hill)\n# summary\nsummary(q1lmerloc)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: q1 ~ Location + Depths + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 627\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.6697 -0.6187  0.0827  0.3962  2.4515 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 35546    189     \n Residual             47469    218     \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error    df t value Pr(&gt;|t|)    \n(Intercept)                   596.2      121.9  15.3    4.89  0.00019 ***\nLocationReforma Waterfalls     98.3      168.0  10.3    0.59  0.57086    \nLocationMiguelito Dike         23.7      142.5  10.5    0.17  0.87137    \nDepths16-30                   214.1       85.5  34.2    2.51  0.01716 *  \nDepths31-45                   165.5       85.5  34.2    1.94  0.06116 .  \nDepths50-75                   131.8       90.3  34.5    1.46  0.15340    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) LctnRW LctnMD D16-30 D31-45\nLctnRfrmWtr -0.598                            \nLoctnMgltDk -0.704  0.518                     \nDepths16-30 -0.351  0.000  0.000              \nDepths31-45 -0.351  0.000  0.000  0.500       \nDepths50-75 -0.289 -0.045 -0.053  0.473  0.473\n\n\n\n# Permutation test \nperm_testlocq1 &lt;- rand(q1lmerloc, nsim = 1000)\nperm_testlocq1\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nq1 ~ Location + Depths + (1 | ID)\n         npar logLik AIC  LRT Df Pr(&gt;Chisq)   \n&lt;none&gt;      8   -313 643                      \n(1 | ID)    7   -318 650 8.94  1     0.0028 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#effects\nanova(q1lmerloc)\n\nType III Analysis of Variance Table with Satterthwaite's method\n         Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)  \nLocation  17497    8749     2  10.2    0.18  0.834  \nDepths   327747  109249     3  34.3    2.30  0.095 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# Differences emmeans\nq1lmer_means_loc &lt;- emmeans(q1lmerloc, pairwise ~ Location)\n\n# significance letters\nq1cld_results_loc &lt;- cld(object = q1lmer_means_loc$emmeans, Letters = letters)\n\n# Convert to data frame\nq1emmeans_df_loc &lt;- as.data.frame(q1cld_results_loc)\nq1emmeans_df_loc\n\n Location           emmean    SE    df lower.CL upper.CL .group\n Fossil Lagoon         724 111.5 10.65      478      970  a    \n Miguelito Dike        748  88.9  9.76      549      946  a    \n Reforma Waterfalls    822 125.7  9.76      541     1103  a    \n\nResults are averaged over the levels of: Depths \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# boxplot with significance\nq1plotloc &lt;- ggplot(metadata_with_hill, aes(x = Location, y = q1, fill = Location)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Location), width = 0.1, alpha = 0.4) +\n  geom_text(data = q1emmeans_df_loc, aes(y = emmean, label = .group), vjust = -3, color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"Exp Shannon\", y = NULL, x = NULL ) + #,\n       #caption = \"letters by lmer emmeans\") +\n    theme_classic() + scale_fill_manual(values = loc_colors) +\n    theme(legend.position = \"none\", axis.text.x = element_blank())\n\nq2 Dominance Inv Simpson\n\n# lmm\nq2lmerloc &lt;- lmer(q2 ~ Location + Depths + (1 | ID), data = metadata_with_hill)\n# summary\nsummary(q2lmerloc)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: q2 ~ Location + Depths + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 542\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.7063 -0.6064  0.0468  0.5556  2.3862 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 2840     53.3    \n Residual             7832     88.5    \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error     df t value Pr(&gt;|t|)    \n(Intercept)                  166.94      41.16  18.56    4.06   0.0007 ***\nLocationReforma Waterfalls    10.23      53.74  10.38    0.19   0.8527    \nLocationMiguelito Dike         1.72      45.70  10.62    0.04   0.9706    \nDepths16-30                   87.60      34.71  34.19    2.52   0.0164 *  \nDepths31-45                   31.89      34.71  34.19    0.92   0.3647    \nDepths50-75                   35.58      36.61  34.70    0.97   0.3378    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) LctnRW LctnMD D16-30 D31-45\nLctnRfrmWtr -0.570                            \nLoctnMgltDk -0.671  0.525                     \nDepths16-30 -0.422  0.000  0.000              \nDepths31-45 -0.422  0.000  0.000  0.500       \nDepths50-75 -0.349 -0.056 -0.066  0.474  0.474\n\n\nperm_testlocq2 &lt;- rand(q2lmerloc, nsim = 1000)\nperm_testlocq2\n\n#effects\nanova(q2lmerloc)\n\n# Differences  emmeans\nq2lmer_means_loc &lt;- emmeans(q2lmerloc, pairwise ~ Location)\n\n# Significance \nq2cld_results_loc &lt;- cld(object = q2lmer_means_loc$emmeans, Letters = letters)\n\n# Convertir a data frame\nq2emmeans_df_loc &lt;- as.data.frame(q2cld_results_loc)\nq2emmeans_df_loc\n\n Location           emmean   SE    df lower.CL upper.CL .group\n Fossil Lagoon         206 35.9 10.99      127      285  a    \n Miguelito Dike        207 28.3  9.63      144      271  a    \n Reforma Waterfalls    216 40.0  9.63      126      306  a    \n\nResults are averaged over the levels of: Depths \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# boxplot with significance\nq2plotloc &lt;- ggplot(metadata_with_hill, aes(x = Location, y = q2, fill = Location)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Location), width = 0.1, alpha = 0.4) +\n  geom_text(data = q2emmeans_df_loc, aes(y = emmean, label = .group), vjust = -3, color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"Exp Shannon\", y = NULL, x = NULL ) + #,\n       #caption = \"letters by lmer emmeans\") +\n    theme_classic() + scale_fill_manual(values = loc_colors) +\n    theme(legend.position = \"none\", axis.text.x = element_blank())\n\nqf Faith Diversity\n\n# lmm\nqflmerloc &lt;- lmer(qf ~ Location + Depths + (1 | ID), data = metadata_with_hill)\n# summary\nsummary(qflmerloc)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: qf ~ Location + Depths + (1 | ID)\n   Data: metadata_with_hill\n\nREML criterion at convergence: 440\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.8154 -0.5311  0.0331  0.5800  1.6075 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 796      28.2    \n Residual             621      24.9    \nNumber of obs: 50, groups:  ID, 13\n\nFixed effects:\n                           Estimate Std. Error     df t value Pr(&gt;|t|)    \n(Intercept)                  184.66      16.65  13.42   11.09  3.9e-08 ***\nLocationReforma Waterfalls    27.53      23.72  10.23    1.16   0.2722    \nLocationMiguelito Dike        12.86      20.10  10.33    0.64   0.5362    \nDepths16-30                   28.22       9.77  34.14    2.89   0.0067 ** \nDepths31-45                   44.98       9.77  34.14    4.60  5.5e-05 ***\nDepths50-75                   33.46      10.33  34.36    3.24   0.0027 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) LctnRW LctnMD D16-30 D31-45\nLctnRfrmWtr -0.615                            \nLoctnMgltDk -0.726  0.515                     \nDepths16-30 -0.293  0.000  0.000              \nDepths31-45 -0.293  0.000  0.000  0.500       \nDepths50-75 -0.241 -0.037 -0.044  0.473  0.473\n\n\n\n# Permutation test \nperm_testlocqf &lt;- rand(qflmerloc, nsim = 1000)\nperm_testlocqf\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nqf ~ Location + Depths + (1 | ID)\n         npar logLik AIC  LRT Df Pr(&gt;Chisq)    \n&lt;none&gt;      8   -220 456                       \n(1 | ID)    7   -228 470 15.9  1    6.6e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#effects\nanova(qflmerloc)\n\nType III Analysis of Variance Table with Satterthwaite's method\n         Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)    \nLocation    838     419     2  10.2    0.67 0.53066    \nDepths    14117    4706     3  34.2    7.58 0.00051 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# Differences emmeans\nqflmer_means_loc &lt;- emmeans(qflmerloc, pairwise ~ Location)\n\n# Significance\nqfcld_results_loc &lt;- cld(object = qflmer_means_loc$emmeans, Letters = letters)\n\n# Convert to data frame\nqfemmeans_df_loc &lt;- as.data.frame(qfcld_results_loc)\nqfemmeans_df_loc\n\n Location           emmean   SE    df lower.CL upper.CL .group\n Fossil Lagoon         211 15.7 10.44      177      246  a    \n Miguelito Dike        224 12.6  9.84      196      252  a    \n Reforma Waterfalls    239 17.8  9.84      199      279  a    \n\nResults are averaged over the levels of: Depths \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\nqfplotloc &lt;- ggplot(metadata_with_hill, aes(x = Location, y = qf, fill = Location)) +\n  geom_boxplot() +\n  geom_jitter(aes(fill = Location), width = 0.1, alpha = 0.4) +\n  geom_text(data = qfemmeans_df_loc, aes(y = emmean, label = .group), vjust = -3, color = \"black\", fontface = \"bold\", position = position_dodge(0.9)) +\n  labs(title = \"Exp Shannon\", y = NULL, x = NULL,\n       caption = \"letters by lmer emmeans\") +\n    theme_classic() + scale_fill_manual(values = loc_colors) +\n    theme(legend.position = \"none\", axis.text.x = element_blank())\n\nCombine plots\n\n#Combine plot\n\nloctitle &lt;- ggdraw() + draw_label(\"Effective number of ASVs\", angle = 90, size = 12)\nalphaplotsloc &lt;- plot_grid(q0plotloc, q1plotloc,\n                      q2plotloc, qfplotloc, \n                      ncol = 1)\nalphaplots_loc &lt;- plot_grid(ytitle, alphaplotsloc, ncol = 2, rel_widths = c(0.05, 1))    \n\nalphaplots_loc\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nA comparison of alpha diversity indices revealed no significant differences among the mangrove sites. Consequently, incorporation of these into the final plot was unnecessary.",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Alpha Diversity"
    ]
  },
  {
    "objectID": "01.Preprocessing.html",
    "href": "01.Preprocessing.html",
    "title": "Preprocessing",
    "section": "",
    "text": "Prior to conducting analyses that will elucidate the microbial dynamics associated with the mangroves under study, it is necessary to process the amplicon sequencing data. The following workflow was employed to achieve this purpose.\nFirst, the workspace was prepared:\nOnce the directories were prepared, the following steps were executed:",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#remove-adapters",
    "href": "01.Preprocessing.html#remove-adapters",
    "title": "Preprocessing",
    "section": "01. Remove adapters",
    "text": "01. Remove adapters\n#Remove primers\n\nmkdir -p results/02.cutadapt\nout=\"results/02.cutadapt\"\nFASTQ=$(ls data/*.gz | sed 's/_.*//' | sed 's/data\\///' | sort -u)\n\ndate\n\nfor FILE in ${FASTQ[@]}; do\n    echo -e \"Run cutadapt to $FILE sample\"\n        CUTADAPT='cutadapt -m 200 --pair-filter any --no-indels -g CCTACGGGNGGCWGCAG -G GACTACHVGGGTATCTAATCC -Z -j 80 -o '$out'/'$FILE'_1.fastq.gz -p '$out'/'$FILE'_2.fastq.gz data/'$FILE'_R1.fastq.gz  data/'$FILE'_R2.fastq.gz'\n        echo -e $CUTADAPT \"\\n\"\n        $CUTADAPT\ndone",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#get-asvs-with-dada2",
    "href": "01.Preprocessing.html#get-asvs-with-dada2",
    "title": "Preprocessing",
    "section": "02. Get ASVs with DADA2",
    "text": "02. Get ASVs with DADA2\n# Get path info\ngetwd()\n\n# Load packages\nlibrary(Rcpp)\nlibrary(dada2)\nlibrary(ggplot2)\nlibrary(gridExtra)\n\n##### 01. Prepare files -------------------------------------------------------\n\n#Load trim fastq files and list fastq_path content\nfastq_path &lt;- \"/axolote/diana/manglares/v0.2/results/02.cutadapt\"\nlist.files(fastq_path) \n\n#Sort file names\nFs &lt;- sort(list.files(fastq_path, pattern=\"_1.fastq\"))\nRs &lt;- sort(list.files(fastq_path, pattern=\"_2.fastq\"))\n\n# Extract sample names\nsampleNames &lt;- sapply(strsplit(Fs, \"_1\"), `[`, 1)\nsampleNames\n\n# Add complete path to remove ambiguities errors\nFs &lt;- file.path(fastq_path, Fs)\nRs &lt;- file.path(fastq_path, Rs)\n\n##### 02. Check Quality --------------------------------------------------------\n\n# Quality check plot with only the first fastq file\nQC_F1_15 &lt;- plotQualityProfile(Fs[1:15], aggregate = TRUE)\nQC_R1_15 &lt;- plotQualityProfile(Rs[1:15], aggregate = TRUE)\nQCsFR1_15 &lt;- grid.arrange(QC_F1_15, QC_R1_15, nrow = 1)\n\n#save in png format\nggsave(\"results/plots/01.QualityProfile_1-15.png\", QCsFR1_15, width = 7, height = 3)\n\n#save in pdf format\nQCsFR1_15 &lt;- grid.arrange(QC_F1_15, QC_R1_15, nrow = 1)\nggsave(\"results/plots/01.QualityProfile_1-15.pdf\", QCsFR1_15, width = 7, height = 3)\n\n##### 03.Quality control -------------------------------------------------------\n\n# Create directory for clean reads\nfilt_path &lt;- file.path(\"results/03.Dada2\" , \"01.filter_reads\") \nif(!file_test(\"-d\", filt_path)) \n  dir.create(filt_path)\nfiltFs &lt;- file.path(filt_path, paste0(sampleNames, \"_F_filt.fastq.gz\"))\nfiltRs &lt;- file.path(filt_path, paste0(sampleNames, \"_R_filt.fastq.gz\"))\n\n# Filter versions\n\n# V1 \nout1 &lt;- filterAndTrim(Fs, filtFs, Rs, filtRs,\n                      truncLen=c(250,200),\n                      maxN=0, maxEE=c(5,5), truncQ=2, rm.phix=TRUE,\n                      compress=TRUE, multithread=TRUE) \nhead(out1)\n\n#V2 extra permissive\nout2 &lt;- filterAndTrim(Fs, filtFs, Rs, filtRs,\n                      maxN=0, maxEE=c(5,5), truncQ=2, rm.phix=TRUE,\n                      compress=TRUE, multithread=TRUE) \nhead(out2)\n\n#V3\nout3 &lt;- filterAndTrim(Fs, filtFs, Rs, filtRs,\n                      truncLen=c(280,200),\n                      maxN=0, maxEE=c(5,5), truncQ=2, rm.phix=TRUE,\n                      compress=TRUE, multithread=TRUE) \nhead(out3)\n\n##v4\nout4 &lt;- filterAndTrim(Fs, filtFs, Rs, filtRs,\n                      truncLen=c(0,200),\n                      maxN=0, maxEE=c(5,5), truncQ=2, rm.phix=TRUE,\n                      compress=TRUE, multithread=TRUE) \nhead(out4)\n\n##v5\nout5 &lt;- filterAndTrim(Fs, filtFs, Rs, filtRs,\n                      truncLen=c(260,200),\n                      maxN=0, maxEE=c(5,5), truncQ=2, rm.phix=TRUE,\n                      compress=TRUE, multithread=TRUE)\nhead(out5)\n\n## compare trunc versions\nv1 &lt;- as.data.frame(out1)\nv2 &lt;- as.data.frame(out2)\nv3 &lt;- as.data.frame(out3)\nv4 &lt;- as.data.frame(out4)\nv5 &lt;- as.data.frame(out5)\n\n\n# Percentage function\ncalculate_percentage &lt;- function(df, group_name) {\n  df$percentage &lt;- (df$reads.out / df$reads.in) * 100\n  df$version &lt;- group_name\n  return(df)\n}\n\n# Get percentage\nout1_with_percentage &lt;- calculate_percentage(v1, 'v1:250-200')\nout2_with_percentage &lt;- calculate_percentage(v2, 'v2:0-0')\nout3_with_percentage &lt;- calculate_percentage(v3, 'v3:280-200')\nout4_with_percentage &lt;- calculate_percentage(v4, 'v4:0-200')\nout5_with_percentage &lt;- calculate_percentage(v5, 'v5:260-200')\n\n# Combine percentage versions\ncombined_data &lt;- rbind(out1_with_percentage, out2_with_percentage, \n                       out3_with_percentage, out4_with_percentage,\n                       out5_with_percentage)\n\n# Compare plot\nboxplot_versions &lt;- ggplot(combined_data, aes(x = version, y = percentage, \n                    fill = version)) + geom_boxplot() + theme_bw() +\n  labs(x = \"Filter version\", y = \"Percentage of reads after filter\") +\n  scale_fill_brewer(palette = \"Set2\")\n\nboxplot_versions\n\n#save plot as png\nggsave(\"results/plots/02.boxplot_trunc_versions.png\", boxplot_versions, width = 6)\n\n#save plot as pdf\nggsave(\"results/plots/02.boxplot_trunc_versions.pdf\", boxplot_versions, width = 6)\n\n#Save info of final version\n#We chose v5 \nwrite.table(out5_with_percentage, file=\"results/03.Dada2/Dada_clean_reads.tsv\", quote=F, sep=\"\\t\",col.names=NA) # Table with the totals before and after cleaning\n\n##### 04.Error Model -----------------------------------------------------------\n\n#De-replicate to reduce redundance \n\nderepFs &lt;- derepFastq(filtFs, verbose=TRUE)\nderepRs &lt;- derepFastq(filtRs, verbose=TRUE)\n\n# Add names to de-rep object\nnames(derepFs) &lt;- sampleNames\nnames(derepRs) &lt;- sampleNames\n\n#Generate Error model IMPORTANT\nerrF &lt;- learnErrors(derepFs, multithread=TRUE, verbose = TRUE)\nerrR &lt;- learnErrors(derepRs, multithread=TRUE, verbose=TRUE)\n\nsave.image(file = \"src/Dada2.RData\") # Save point to stop for now\n\n##### 0.5 Get ASVs -------------------------------------------------------------\n# ASVs inference\ndadaFs &lt;- dada(derepFs, err=errF, multithread=TRUE, pool = \"pseudo\", verbose=TRUE)\ndadaRs &lt;- dada(derepRs, err=errR, multithread=TRUE, pool = \"pseudo\", verbose = TRUE)\n\nsave.image(file = \"src/Dada2.RData\") # Save point to stop for now\n\n# Merge pairs\nmergers &lt;- mergePairs(dadaFs, derepFs, dadaRs, derepRs, minOverlap = 8, verbose=TRUE)\n\n# Create ASVs table \nseqtabAll &lt;- makeSequenceTable(mergers)\ntable(nchar(getSequences(seqtabAll)))\n\n# Remove chimeras\nseqtab_nochim &lt;- removeBimeraDenovo(seqtabAll, method=\"consensus\", multithread=TRUE, verbose=TRUE)\n\ndim(seqtab_nochim)\nsum(seqtab_nochim)/sum(seqtabAll)\n\n##### 0.6 info -----------------------------------------------------------------\n\n# create a new table with each ASV number and its representative sequence\nPE.table_tsv_output &lt;- seqtab_nochim\nPE.table_tsv_output[PE.table_tsv_output==1]=0 # Don't consider those values that have a single observation per sample, make them 0 (sample singletons)\nPE.table_tsv_output &lt;- PE.table_tsv_output[,colSums(PE.table_tsv_output)&gt;1] # filter singleton ASVs across the table\n\n# Export sequences as in fasta format\nuniquesToFasta(PE.table_tsv_output, fout=\"results/03.Dada2/ASVs.fasta\", ids=paste(\"ASV_\",1:ncol(PE.table_tsv_output), sep=\"\"))\nnochim=PE.table_tsv_output\nwrite.table(cbind(\"ASVs\"=1:nrow(t(PE.table_tsv_output)),\"rep_seq\"=rownames(t(PE.table_tsv_output))), file=\"results/03.Dada2/ASV_to_seqs-nochim.tsv\", quote=F, sep=\"\\t\",row.names=FALSE)\n\n# replace the rep_seq with an incremental ASV number\nPE.table_tsv_output &lt;- t(PE.table_tsv_output)\nrownames(PE.table_tsv_output) &lt;- paste0(\"ASV_\",1:nrow(PE.table_tsv_output))\n\n# and print the output ASV table\nwrite.table(PE.table_tsv_output, file=\"results/03.Dada2/ASV_to_seqs-nochim.tsv\", quote=F, sep=\"\\t\",col.names=NA)\n\n# evaluate the total table dimensions\ndim(nochim)\n\ntable(nchar(getSequences(nochim))) \n\n###Track reads lost per step ###\n\n# By using this, we can create a function to automate this for all samples in a set:\ngetN &lt;- function(x) sum(getUniques(x)) # Where getUniques gets non-repeated sequences from a dada2 object or merger object (joined reads)\ntrack &lt;- cbind(out1, sapply(derepFs, getN), sapply(dadaFs, getN), sapply(dadaRs, getN), rowSums(seqtabAll), rowSums(nochim))\ncolnames(track) &lt;- c(\"Raw\", \"Qual_filter\", \"Derep\", \"ASVs R1\", \"ASVs R2\", \"Merged\", \"nonchim\")\nrownames(track) &lt;- sampleNames\nwrite.table(track, \"results/03.Dada2/Seqs_lost_in_ASVs_processing.tsv\", col.names=NA, sep=\"\\t\")\n\n\n# Create a quick assesment of sequences lost throughout the process\npng(\"results/plots/03.preview_reads_passing_ASV_processing.png\")\n# And same thing for the percentage remaining\nmatplot(t(track[,-5]/track[,1]*100),type='l',xaxt='n', main=\"Sequences remaining after each step  - R1 (%)\", xlab=\"Step\", ylab=\" Percentage of Sequences remaining\")\naxis(1,at=1:ncol(track[,-5]),labels=colnames(track[,-5]))\n# R2\nmatplot(t(track[,-4]/track[,1]*100),type='l',xaxt='n', main=\"Sequences remaining after each step  - R2 (%)\", xlab=\"Step\", ylab=\" Percentage of Sequences remaining\")\naxis(1,at=1:ncol(track[,-4]),labels=colnames(track[,-4]))\ndev.off()\n\n##Add final table\ntrack2 &lt;- data.frame(track)\ntrack2$percentage_used &lt;-(track2$nonchim / track2$Raw) * 100\ntrack2\nwrite.table(track2, \"results/03.Dada2/Seqs_lost_in_ASVs_processing_percentage.tsv\", col.names=NA, sep=\"\\t\")\n\n# Save work so far\nsave.image(file = \"src/Dada2.RData\")",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#import-to-qiime2",
    "href": "01.Preprocessing.html#import-to-qiime2",
    "title": "Preprocessing",
    "section": "03. Import to QIIME2",
    "text": "03. Import to QIIME2\n#!/usr/bin/bash\n## DianaOaxaca\n## Import data to QIIME2\n\n#Run in qiime conda environment\n#conda activate qiime2-2023.5\n\n#import rep seqs\nqiime tools import --input-path results/03.Dada2/ASVs.fasta --type 'FeatureData[Sequence]' --output-path results/04.qiime/ASV_rep_seq.qza\n\n# append missing header to the table for import\ncat &lt;(echo -n \"#OTU Table\") results/03.Dada2/ASV_to_seqs-nochim.tsv &gt; temp.txt\n\n# convert to biom\nbiom convert -i temp.txt -o temp.biom --table-type=\"OTU table\" --to-hdf5\n\n# and create table-type qza\nqiime tools import --input-path temp.biom --type 'FeatureTable[Frequency]' --input-format BIOMV210Format --output-path results/04.qiime/ASV_table.qza\n\n# remove temporal files\nrm temp.*",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#taxonomic-assignment",
    "href": "01.Preprocessing.html#taxonomic-assignment",
    "title": "Preprocessing",
    "section": "04. Taxonomic assignment",
    "text": "04. Taxonomic assignment\n#!/usr/bin/bash\n## DianaOaxaca\n## Import data to QIIME2\n\n#Run in qiime conda environment\n#conda activate qiime2-2023.5\n\n#import rep seqs\nqiime tools import --input-path results/03.Dada2/ASVs.fasta --type 'FeatureData[Sequence]' --output-path results/04.qiime/ASV_rep_seq.qza\n\n# append missing header to the table for import\ncat &lt;(echo -n \"#OTU Table\") results/03.Dada2/ASV_to_seqs-nochim.tsv &gt; temp.txt\n\n# convert to biom\nbiom convert -i temp.txt -o temp.biom --table-type=\"OTU table\" --to-hdf5\n\n# and create table-type qza\nqiime tools import --input-path temp.biom --type 'FeatureTable[Frequency]' --input-format BIOMV210Format --output-path results/04.qiime/ASV_table.qza\n\n# remove temporal files\nrm temp.*",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#filters",
    "href": "01.Preprocessing.html#filters",
    "title": "Preprocessing",
    "section": "05. Filters",
    "text": "05. Filters\n#!/usr/bin/bash\n#DianaOaxaca\n#Filters\n\n#Summary of the qza table imported from R\nqiime feature-table summarize \\\n--i-table results/04.qiime/ASV_table.qza \\\n--o-visualization results/04.qiime/ASV_table.qzv\n\n#Filter by frequency\n#Here I removed all ASVs with a frequency of less than 0.1% of the mean sample depth. \n#This cut-off excludes ASVs that are likely due to MiSeq bleed-through between runs (reported by Illumina to be 0.1% of reads). \n#To calculate this cut-off I identified the mean sample depth, multiplied it by 0.001, and rounded to the nearest integer. \n#This step are describe in [this paper](https://journals.asm.org/doi/pdf/10.1128/msystems.00127-16)\n\nqiime feature-table filter-features --i-table  results/04.qiime/ASV_table.qza \\\n --p-min-samples 1 --p-min-frequency 218 --o-filtered-table results/04.qiime/ASV_table_filter_freq218.qza\n\nqiime feature-table summarize --i-table results/04.qiime/ASV_table_filter_freq218.qza \\\n --o-visualization results/04.qiime/ASV_table_filter_freq218.qzv\n\n#Filter Mitochondria, chloroplast and Eukaryota\n\nqiime taxa filter-table --i-table results/04.qiime/ASV_table_filter_freq218.qza \\\n --i-taxonomy results/04.qiime/taxonomy.qza --p-exclude Eukaryota,Mitochondria,Chloroplast \\\n --p-include p__ --o-filtered-table results/04.qiime/ASV_table_filter_freq218_emc.qza\n\nqiime feature-table summarize --i-table results/04.qiime/ASV_table_filter_freq218_emc.qza \\\n --o-visualization results/04.qiime/ASV_table_filter_freq218_emc.qzv\n\n#remove in fasta sequences\nqiime feature-table filter-seqs  --i-table results/04.qiime/ASV_table_filter_freq218_emc.qza \\\n --i-data results/04.qiime/ASV_rep_seq.qza --o-filtered-data results/04.qiime/ASV_rep_seq_filters.qza",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#phylogeny",
    "href": "01.Preprocessing.html#phylogeny",
    "title": "Preprocessing",
    "section": "06. Phylogeny",
    "text": "06. Phylogeny\n#!/usr/bin/bash\n#Get iqtree phylogeny\n\ndate\necho \"Start phylogeny\"\n\nqiime phylogeny align-to-tree-mafft-iqtree \\\n --p-n-threads auto --i-sequences results/04.qiime/ASV_rep_seq_filters.qza \\\n --o-alignment results/04.qiime/align.qza \\\n --o-masked-alignment results/04.qiime/masked-align.qza \\\n --o-tree results/04.qiime/unrooted-tree-iqtree.qza \\\n --o-rooted-tree results/04.qiime/rooted-tree-iqtree.qza --verbose\n\necho \"finish phylogeny!\"\n\ndate",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#get-public-data",
    "href": "01.Preprocessing.html#get-public-data",
    "title": "Preprocessing",
    "section": "07. Get public data",
    "text": "07. Get public data\n# Yaxche\n\n\n\n\n\n\nPublic data preprocessing\n\n\n\nThe public data obtained for comparative purposes was preprocessed in the same way as described in the previous steps.",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "01.Preprocessing.html#clustering-types-of-mangroves-for-comparative-analysis",
    "href": "01.Preprocessing.html#clustering-types-of-mangroves-for-comparative-analysis",
    "title": "Preprocessing",
    "section": "08. Clustering types of mangroves for comparative analysis",
    "text": "08. Clustering types of mangroves for comparative analysis\n#Run in qiime conda environment\nconda activate qiime2-2023.5\n\n#Repeat with every ASV_table (Celestún, Estero Pargo and San Pedro River)\n#import rep seqs\nqiime tools import --input-path results/03.Dada2/ASVs.fasta --type 'FeatureData[Sequence]' --output-path results/04.qiime/ASV_rep_seq.qza\n\n# append missing header to the table for import\ncat &lt;(echo -n \"#OTU Table\") results/03.Dada2/ASV_to_seqs-nochim.tsv &gt; temp.txt\n\n# convert to biom\nbiom convert -i temp.txt -o temp.biom --table-type=\"OTU table\" --to-hdf5\n\n# and create table-type qza\nqiime tools import --input-path temp.biom --type 'FeatureTable[Frequency]' --input-format BIOMV210Format --output-path results/04.qiime/ASV_table.qza\n\n# remove temporal files\nrm temp.*\n\n#Merge of the frequency tables from distinct analysis\nqiime feature-table merge \n--i-tables ASV_table_Celestun.qza ASV_table_Estero.qza ASV_table_SanPedro.qza --p-overlap-method sum \n--o-merged-table merged-table.qza\n\n#Merge of the Representative sequences from distinct analysis \nqiime feature-table merge-seqs \n--i-data ASV_Celestun_rep_seq.qza ASV_Estero_rep_seq.qza ASV_SanPedro_rep_seq.qza \n--o-merged-data merged-rep_seqs.qza\n\n#Closed reference clustering for Meta-Analysis\nqiime vsearch cluster-features-closed-reference   \n--i-table merged-table.qza   \n--i-sequences merged-rep_seqs.qza   \n--i-reference-sequences silva-138-99-seqs.qza   \n--p-perc-identity 0.97   \n--o-clustered-table table-cr-97.qza   \n--o-clustered-sequences rep-seqs-cr-97.qza   \n--o-unmatched-sequences unmatched-cr-97.qza\n\n#Taxonomic assignment with SILVA\n qiime feature-classifier classify-sklearn   \n--i-classifier classifier_silva_138_trained.qza   \n--i-reads rep-seqs-cr-97.qza    \n--o-classification taxonomyEstero.qza \n--p-n-jobs 40\n\n#Filter by frequency\nqiime feature-table filter-features --i-table  merged_table.qza \n--p-min-samples 1 \n--p-min-frequency 218 \n--o-filtered-table clustered_table_filter_freq218.qza\n\n#Filter Mitochondria, chloroplast and Eukaryota\nqiime taxa filter-table \n--i-table Clustered_table_filter_freq218.qza \n--i-taxonomy taxonomy.qza \n--p-exclude Eukaryota,Mitochondria,Chloroplast  \n--p-include p__ \n--o-filtered-table clustered_table_filter_freq218_emcEstero.qza",
    "crumbs": [
      "Preprocessing"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html",
    "href": "03.4.Coremicrobiome.html",
    "title": "Core Microbiome",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(UpSetR)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(RColorBrewer)\nlibrary(tibble)\nlibrary(ampvis2)\n\n\n#load data\nphyseq &lt;- readRDS(\"rds/interior_mangroves/phyloseq.rds\")\n\n\n# Convert Location to factor\nsample_data(physeq)$Location &lt;- as.factor(sample_data(physeq)$Location)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#load-libraries-and-prepare-data",
    "href": "03.4.Coremicrobiome.html#load-libraries-and-prepare-data",
    "title": "Core Microbiome",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(UpSetR)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(RColorBrewer)\nlibrary(tibble)\nlibrary(ampvis2)\n\n\n#load data\nphyseq &lt;- readRDS(\"rds/interior_mangroves/phyloseq.rds\")\n\n\n# Convert Location to factor\nsample_data(physeq)$Location &lt;- as.factor(sample_data(physeq)$Location)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#calculate-core",
    "href": "03.4.Coremicrobiome.html#calculate-core",
    "title": "Core Microbiome",
    "section": "01. Calculate core",
    "text": "01. Calculate core\n\n# Prevalence threshold\nprevalence_threshold &lt;- 0.8\n\n# Storage ASVs core list\ncore_list &lt;- list()\nlocations &lt;- levels(sample_data(physeq)$Location)\n\n# Calculate core\nfor (loc in locations) {\n  # Filter samples by mangrove system\n  physeq_loc &lt;- prune_samples(sample_data(physeq)$Location == loc, physeq)\n  n_samples_loc &lt;- nsamples(physeq_loc)\n\n  # Extract OTU table\n  otu &lt;- as(otu_table(physeq_loc), \"matrix\")\n\n  # Calc prevalence\n  prevalence &lt;- rowSums(otu &gt; 0) / n_samples_loc\n\n  # Identify ASVs with prevalence &gt;= umbral\n  core_taxa &lt;- names(prevalence)[prevalence &gt;= prevalence_threshold]\n\n  # Guardar en la lista\n  core_list[[loc]] &lt;- core_taxa\n}\n\n# Show ASVs core by mangrove system\nprint(lapply(core_list, length))\n\n$`Fossil Lagoon`\n[1] 1043\n\n$`Miguelito Dike`\n[1] 585\n\n$`Reforma Waterfalls`\n[1] 1454\n\n# checkpoint,if empty try threshold = 1\nif (all(sapply(core_list, length) == 0)) {\n  cat(\"Try prevalence = 1...\\n\")\n  prevalence_threshold &lt;- 1.0\n  core_list &lt;- list()\n  for (loc in locations) {\n    physeq_loc &lt;- prune_samples(sample_data(physeq)$Location == loc, physeq)\n    n_samples_loc &lt;- nsamples(physeq_loc)\n    otu &lt;- as(otu_table(physeq_loc), \"matrix\")\n    prevalence &lt;- rowSums(otu &gt; 0) / n_samples_loc\n    core_taxa &lt;- names(prevalence)[prevalence &gt;= prevalence_threshold]\n    core_list[[loc]] &lt;- core_taxa\n  }\n  print(lapply(core_list, length))\n}",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#extract-core-info",
    "href": "03.4.Coremicrobiome.html#extract-core-info",
    "title": "Core Microbiome",
    "section": "02. Extract core info",
    "text": "02. Extract core info\n\n# Unique core ASV list\nall_core_asvs &lt;- unique(unlist(core_list))\n\n# Create matrix presence/absence\ncore_matrix &lt;- matrix(0, nrow = length(all_core_asvs), ncol = length(locations),\n                      dimnames = list(all_core_asvs, locations))\n\n# fill matrix: \nfor (loc in locations) {\n  core_matrix[core_list[[loc]], loc] &lt;- 1\n}\n\n# Convert to data frame to UpSetR\ncore_df &lt;- as.data.frame(core_matrix)\n\n# Create intersection list\nqueries_list &lt;- list()",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#plot-aesthetics",
    "href": "03.4.Coremicrobiome.html#plot-aesthetics",
    "title": "Core Microbiome",
    "section": "03. plot aesthetics",
    "text": "03. plot aesthetics\n\n#library(UpSetR)\n# Fossil Lagoon\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\"), color = \"#A3D9A8\",\n       active = TRUE, query.name = \"Fossil Lagoon\")))\n\n# Reforma Waterfalls\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Reforma Waterfalls\"), color = \"#44C17B\",\n       active = TRUE, query.name = \"Reforma Waterfalls\")))\n\n# Miguelito Dike\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Miguelito Dike\"), color = \"#2E8B57\",\n       active = TRUE, query.name = \"Miguelito Dike\")))\n\n\n# Core\nqueries_list &lt;- append(queries_list, list(\n  list(query = intersects, params = list(\"Fossil Lagoon\", \n                                         \"Reforma Waterfalls\",\n                                         \"Miguelito Dike\"),\n       color = \"#8D3CA3\", active = TRUE, query.name = \"Core\")))",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#upset-plot",
    "href": "03.4.Coremicrobiome.html#upset-plot",
    "title": "Core Microbiome",
    "section": "04. UpSet plot",
    "text": "04. UpSet plot\n\n#library(UpSetR)\nupset_plot &lt;- upset(core_df,\n                    sets = colnames(core_df),\n                    order.by = \"freq\",\n                    mainbar.y.label = \"Shared ASVs\",\n                    sets.x.label = \"ASVs per Site\",\n                    text.scale = 1.3,\n                    point.size = 4,\n                    line.size = 1.5,\n                    query.legend = \"bottom\",\n                    sets.bar.color = \n                      c(\"#44C17B\",\"#A3D9A8\",\"#2E8B57\"),\n                    queries = queries_list)\n\n# show\nprint(upset_plot)\n\n\n\n\n\n\n\nsave plot\n\npdf(\"Figures/interior_mangroves/core_upset.pdf\", width = 5.8, height = 4)\nupset_plot\ndev.off()\n\nquartz_off_screen \n                2",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#get-unique-and-core-asv-info",
    "href": "03.4.Coremicrobiome.html#get-unique-and-core-asv-info",
    "title": "Core Microbiome",
    "section": "05. Get unique and core ASV info",
    "text": "05. Get unique and core ASV info\n\n### get unique ASVs per mangrove system\nunique_asvs &lt;- list()\nfor (loc in colnames(core_df)) {\n  unique_asvs[[loc]] &lt;- rownames(core_df)[rowSums(core_df == 1) == 1 & core_df[[loc]] == 1]\n  cat(loc, \": Unique ASVs:\", length(unique_asvs[[loc]]), \"\\n\")\n  print(head(unique_asvs[[loc]], 5))  # Show first 5\n}\n\nFossil Lagoon : Unique ASVs: 551 \n[1] \"ASV_1157\" \"ASV_2508\" \"ASV_7072\" \"ASV_3541\" \"ASV_2759\"\nMiguelito Dike : Unique ASVs: 199 \n[1] \"ASV_115\"  \"ASV_1676\" \"ASV_4663\" \"ASV_1294\" \"ASV_1092\"\nReforma Waterfalls : Unique ASVs: 867 \n[1] \"ASV_6234\" \"ASV_1191\" \"ASV_5039\" \"ASV_2114\" \"ASV_5289\"\n\n#unique_asvs\n\n\n# Verify taxonomy\nif (!is.null(tax_table(physeq))) {\n  tax_table_df &lt;- as.data.frame(tax_table(physeq))\n\n  # Get taxonomy function\n  get_taxonomy &lt;- function(asv_list) {\n    if (length(asv_list) &gt; 0) {\n      taxonomy &lt;- tax_table_df[asv_list, , drop = FALSE]\n      return(taxonomy)\n    } else {\n      return(NULL)\n    }\n  }\n\n  # Get taxonomy\n  taxonomy_unique &lt;- lapply(unique_asvs, get_taxonomy)\n\n  # show first 5  unique ASVs\n  for (loc in names(taxonomy_unique)) {\n    cat(\"\\nFirst unique ASVs taxonomy\", loc, \":\\n\")\n    if (!is.null(taxonomy_unique[[loc]])) {\n      print(head(taxonomy_unique[[loc]], 5))\n    } else {\n      cat(\"There are no unique ASV to\", loc, \"\\n\")\n    }\n  }\n} else {\n  cat(\"Please import taxonomy.\\n\")\n}\n\n\nFirst unique ASVs taxonomy Fossil Lagoon :\n            Kingdom        Phylum         Class         Order        Family\nASV_1157 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_2508 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_7072 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_3541 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_2759 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\n                 Genus                 Species\nASV_1157 Bathyarchaeia                    &lt;NA&gt;\nASV_2508 Bathyarchaeia                    &lt;NA&gt;\nASV_7072 Bathyarchaeia                    &lt;NA&gt;\nASV_3541 Bathyarchaeia                    &lt;NA&gt;\nASV_2759 Bathyarchaeia uncultured_methanogenic\n\nFirst unique ASVs taxonomy Miguelito Dike :\n            Kingdom           Phylum          Class\nASV_115  d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_1676 d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_4663 d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_1294 d__Archaea    Crenarchaeota  Bathyarchaeia\nASV_1092 d__Archaea Thermoplasmatota Thermoplasmata\n                                      Order                             Family\nASV_115                       Bathyarchaeia                      Bathyarchaeia\nASV_1676                      Bathyarchaeia                      Bathyarchaeia\nASV_4663                      Bathyarchaeia                      Bathyarchaeia\nASV_1294                      Bathyarchaeia                      Bathyarchaeia\nASV_1092 Marine_Benthic_Group_D_and_DHVEG-1 Marine_Benthic_Group_D_and_DHVEG-1\n                                      Genus                   Species\nASV_115                       Bathyarchaeia      uncultured_bacterium\nASV_1676                      Bathyarchaeia   uncultured_methanogenic\nASV_4663                      Bathyarchaeia   uncultured_methanogenic\nASV_1294                      Bathyarchaeia                      &lt;NA&gt;\nASV_1092 Marine_Benthic_Group_D_and_DHVEG-1 uncultured_Thermoplasmata\n\nFirst unique ASVs taxonomy Reforma Waterfalls :\n            Kingdom        Phylum         Class         Order        Family\nASV_6234 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_1191 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_5039 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_2114 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\nASV_5289 d__Archaea Crenarchaeota Bathyarchaeia Bathyarchaeia Bathyarchaeia\n                 Genus                   Species\nASV_6234 Bathyarchaeia   uncultured_methanogenic\nASV_1191 Bathyarchaeia                      &lt;NA&gt;\nASV_5039 Bathyarchaeia   uncultured_methanogenic\nASV_2114 Bathyarchaeia  uncultured_crenarchaeote\nASV_5289 Bathyarchaeia uncultured_Bathyarchaeota\n\n# Confirm the total number of unique ASVs\nlapply(taxonomy_unique, function(x) if (!is.null(x)) nrow(x) else 0)\n\n$`Fossil Lagoon`\n[1] 551\n\n$`Miguelito Dike`\n[1] 199\n\n$`Reforma Waterfalls`\n[1] 867\n\n\nGet taxonomy\nPhylum level\n\n# Create a list to store unique asv to Phylum level\nphylum_unique &lt;- list()\n\n# Iterate on each Mangrove system\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy phylum\n    tax_df &lt;- taxonomy_unique[[loc]]\n    if (\"Phylum\" %in% colnames(tax_df)) {\n      phylum &lt;- tax_df$Phylum\n      phylum &lt;- phylum[!is.na(phylum)]  # Exclude NA\n      phylum_unique[[loc]] &lt;- unique(phylum)\n    } else {\n      cat(\"Phylum is not available to\", loc, \"\\n\")\n      phylum_unique[[loc]] &lt;- character(0)\n    }\n  } else {\n    phylum_unique[[loc]] &lt;- character(0)\n  }\n}\n\n# Identify exclusive phylum for Mangrove system\nall_phylums &lt;- unique(unlist(phylum_unique))\nphylum_exclusive &lt;- list()\nfor (loc in names(phylum_unique)) {\n  other_locations &lt;- setdiff(names(phylum_unique), loc)\n  other_phylum &lt;- unique(unlist(phylum_unique[other_locations]))\n  exclusive_phylum &lt;- setdiff(phylum_unique[[loc]], other_phylum)\n  phylum_exclusive[[loc]] &lt;- exclusive_phylum\n  cat(\"Exclusive phylum in\", loc, \":\", length(exclusive_phylum), \"\\n\")\n  if (length(exclusive_phylum) &gt; 0) {\n    print(exclusive_phylum)\n  } else {\n    cat(\"There are not exclusive phylum.\\n\")\n  }\n}\n\nExclusive phylum in Fossil Lagoon : 1 \n[1] \"Hydrogenedentes\"\nExclusive phylum in Miguelito Dike : 2 \n[1] \"Thermoplasmatota\" \"Fibrobacterota\"  \nExclusive phylum in Reforma Waterfalls : 9 \n[1] \"WPS-2\"             \"10bav-F6\"          \"RCP2-54\"          \n[4] \"Bdellovibrionota\"  \"Deferrisomatota\"   \"Campilobacterota\" \n[7] \"WS2\"               \"Entotheonellaeota\" \"Nitrospinota\"     \n\n\nClass level\n\n# Create a list to store unique asv to Class level\nclass_unique &lt;- list()\n\n# Iterate on each Location\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy class\n    tax_df &lt;- taxonomy_unique[[loc]]\n    if (\"Class\" %in% colnames(tax_df)) {\n      class &lt;- tax_df$Class\n      class &lt;- class[!is.na(class)]  # Exclude NA\n      class_unique[[loc]] &lt;- unique(class)\n    } else {\n      cat(\"Class is not available to\", loc, \"\\n\")\n      class_unique[[loc]] &lt;- character(0)\n    }\n  } else {\n    class_unique[[loc]] &lt;- character(0)\n  }\n}\n\n# Identify exclusive phylum for Mangrove system\nall_class &lt;- unique(unlist(class_unique))\nclass_exclusive &lt;- list()\nfor (loc in names(class_unique)) {\n  other_locations &lt;- setdiff(names(class_unique), loc)\n  other_class &lt;- unique(unlist(class_unique[other_locations]))\n  exclusive_class &lt;- setdiff(class_unique[[loc]], other_class)\n  class_exclusive[[loc]] &lt;- exclusive_class\n  cat(\"Exclusive class in\", loc, \":\", length(exclusive_class), \"\\n\")\n  if (length(exclusive_class) &gt; 0) {\n    print(exclusive_class)\n  } else {\n    cat(\"There are not exclusive class.\\n\")\n  }\n}\n\nExclusive class in Fossil Lagoon : 10 \n [1] \"Chlamydiae\"      \"ABY1\"            \"Kazania\"         \"MD2902-B12\"     \n [5] \"Kapabacteria\"    \"Microgenomatia\"  \"Hydrogenedentia\" \"OC31\"           \n [9] \"WCHB1-81\"        \"OLB14\"          \nExclusive class in Miguelito Dike : 3 \n[1] \"Thermoplasmata\"   \"Chitinivibrionia\" \"Leptospirae\"     \nExclusive class in Reforma Waterfalls : 17 \n [1] \"vadinHA49\"       \"Saccharimonadia\" \"AKAU4049\"        \"WPS-2\"          \n [5] \"DG-56\"           \"10bav-F6\"        \"RCP2-54\"         \"Bdellovibrionia\"\n [9] \"Defferrisomatia\" \"bacteriap25\"     \"Campylobacteria\" \"WS2\"            \n[13] \"Holophagae\"      \"Entotheonellia\"  \"Subgroup_25\"     \"Subgroup_11\"    \n[17] \"P9X2b3D02\"      \n\n\nFamily level\n\n# Create a list to store unique asv to specific taxonomy level\nfamilies_unique &lt;- list()\n\n# Iterate on each Mangrove system\nfor (loc in names(taxonomy_unique)) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    # Extract taxonomy families\n    tax_df &lt;- taxonomy_unique[[loc]]\n    if (\"Family\" %in% colnames(tax_df)) {\n      families &lt;- tax_df$Family\n      families &lt;- families[!is.na(families)]  # Exclude NA\n      families_unique[[loc]] &lt;- unique(families)\n    } else {\n      cat(\"Family is not available to\", loc, \"\\n\")\n      families_unique[[loc]] &lt;- character(0)\n    }\n  } else {\n    families_unique[[loc]] &lt;- character(0)\n  }\n}\n\n# Identify exclusive family for Mangrove system\nall_families &lt;- unique(unlist(families_unique))\nfamilies_exclusive &lt;- list()\nfor (loc in names(families_unique)) {\n  other_locations &lt;- setdiff(names(families_unique), loc)\n  other_families &lt;- unique(unlist(families_unique[other_locations]))\n  exclusive_families &lt;- setdiff(families_unique[[loc]], other_families)\n  families_exclusive[[loc]] &lt;- exclusive_families\n  cat(\"Exclusive family in\", loc, \":\", length(exclusive_families), \"\\n\")\n  if (length(exclusive_families) &gt; 0) {\n    print(exclusive_families)\n  } else {\n    cat(\"There are not exclusive family.\\n\")\n  }\n}\n\nExclusive family in Fossil Lagoon : 37 \n [1] \"mle1-8\"                     \"AKAU3564_sediment_group\"   \n [3] \"Pirellulaceae\"              \"Methylacidiphilaceae\"      \n [5] \"Simkaniaceae\"               \"Candidatus_Moranbacteria\"  \n [7] \"Candidatus_Komeilibacteria\" \"Kazania\"                   \n [9] \"MD2902-B12\"                 \"Gammaproteobacteria\"       \n[11] \"EC3\"                        \"Diplorickettsiaceae\"       \n[13] \"Rhodanobacteraceae\"         \"Methylococcaceae\"          \n[15] \"Beggiatoaceae\"              \"A0839\"                     \n[17] \"Micropepsaceae\"             \"Haliangiaceae\"             \n[19] \"UASB-TL25\"                  \"Polyangiaceae\"             \n[21] \"Eel-36e1D6\"                 \"BIrii41\"                   \n[23] \"Myxococcaceae\"              \"Paludibacteraceae\"         \n[25] \"37-13\"                      \"Kapabacteriales\"           \n[27] \"Candidatus_Collierbacteria\" \"Candidatus_Levybacteria\"   \n[29] \"Hydrogenedensaceae\"         \"OC31\"                      \n[31] \"WCHB1-81\"                   \"OLB14\"                     \n[33] \"MSB-5E12\"                   \"Bryobacteraceae\"           \n[35] \"Hungateiclostridiaceae\"     \"Ruminococcaceae\"           \n[37] \"Streptococcaceae\"          \nExclusive family in Miguelito Dike : 9 \n[1] \"Marine_Benthic_Group_D_and_DHVEG-1\" \"Alteromonadaceae\"                  \n[3] \"Bacteroidetes_BD2-2\"                \"Bifidobacteriaceae\"                \n[5] \"Napoli-4B-65\"                       \"t0.6.f\"                            \n[7] \"Sh765B-AG-111\"                      \"SAR202_clade\"                      \n[9] \"Leptospiraceae\"                    \nExclusive family in Reforma Waterfalls : 63 \n [1] \"vadinHA49\"              \"CCM11a\"                 \"Gemmataceae\"           \n [4] \"Rubritaleaceae\"         \"LWQ8\"                   \"WX65\"                  \n [7] \"Methylomirabilaceae\"    \"AKAU4049\"               \"WPS-2\"                 \n[10] \"DG-56\"                  \"Enterobacteriaceae\"     \"Succinivibrionaceae\"   \n[13] \"KI89A_clade\"            \"Xanthomonadaceae\"       \"Spongiibacteraceae\"    \n[16] \"EPR3968-O8a-Bc78\"       \"PLTA13\"                 \"CCD24\"                 \n[19] \"JG36-GS-52\"             \"Chromatiaceae\"          \"Ectothiorhodospiraceae\"\n[22] \"WN-HWB-116\"             \"Sutterellaceae\"         \"SC-I-84\"               \n[25] \"Chitinimonadaceae\"      \"Oxalobacteraceae\"       \"Gallionellaceae\"       \n[28] \"MBMPE27\"                \"Rhizobiaceae\"           \"Sphingomonadaceae\"     \n[31] \"Reyranellaceae\"         \"Geminicoccaceae\"        \"Ferrovibrionales\"      \n[34] \"10bav-F6\"               \"RCP2-54\"                \"Bdellovibrionaceae\"    \n[37] \"Defferrisomataceae\"     \"bacteriap25\"            \"Dysgonomonadaceae\"     \n[40] \"Sphingobacteriaceae\"    \"Flavobacteriaceae\"      \"Saprospiraceae\"        \n[43] \"LD-RB-34\"               \"Sulfurimonadaceae\"      \"WS2\"                   \n[46] \"Subgroup_7\"             \"Entotheonellaceae\"      \"Subgroup_25\"           \n[49] \"Subgroup_9\"             \"Subgroup_11\"            \"Geodermatophilaceae\"   \n[52] \"IMCC26256\"              \"vadinBA26\"              \"FS117-23B-02\"          \n[55] \"SJA-15\"                 \"DS-100\"                 \"Pyrinomonadaceae\"      \n[58] \"Solibacteraceae\"        \"P9X2b3D02\"              \"Peptostreptococcaceae\" \n[61] \"Clostridiaceae\"         \"Alicyclobacillaceae\"    \"Enterococcaceae\"       \n\n\nGet core table\n\n# Combine taxonomy in data.frame\ntaxonomy_unique_df &lt;- do.call(rbind, lapply(names(taxonomy_unique), function(loc) {\n  if (!is.null(taxonomy_unique[[loc]])) {\n    df &lt;- taxonomy_unique[[loc]]\n    df$Location &lt;- loc\n    df$ASV &lt;- rownames(df)# add name asv column\n    return(df)\n  } else {\n    return(NULL)\n  }\n}))\n\n# Move columns\ntaxonomy_unique_df &lt;- taxonomy_unique_df[, c(\"ASV\", \"Location\", setdiff(names(taxonomy_unique_df), c(\"ASV\", \"Location\")))]\n\n# show first rows of data.frame to verify\nprint(head(taxonomy_unique_df))\n\n              ASV      Location    Kingdom        Phylum         Class\nASV_1157 ASV_1157 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_2508 ASV_2508 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_7072 ASV_7072 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_3541 ASV_3541 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_2759 ASV_2759 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\nASV_2092 ASV_2092 Fossil Lagoon d__Archaea Crenarchaeota Bathyarchaeia\n                 Order        Family         Genus                 Species\nASV_1157 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    &lt;NA&gt;\nASV_2508 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    &lt;NA&gt;\nASV_7072 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    &lt;NA&gt;\nASV_3541 Bathyarchaeia Bathyarchaeia Bathyarchaeia                    &lt;NA&gt;\nASV_2759 Bathyarchaeia Bathyarchaeia Bathyarchaeia uncultured_methanogenic\nASV_2092 Bathyarchaeia Bathyarchaeia Bathyarchaeia uncultured_methanogenic\n\n\n\n# save data.frame\nwrite.csv(taxonomy_unique_df, file = \"Tables/interior_mangroves/unique_asvs_taxonomy.csv\", row.names = FALSE)",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#get-core-taxonomy",
    "href": "03.4.Coremicrobiome.html#get-core-taxonomy",
    "title": "Core Microbiome",
    "section": "06. Get core taxonomy",
    "text": "06. Get core taxonomy\n\nshared_asvs &lt;- Reduce(intersect, core_list)\nprint(shared_asvs)\n\n  [1] \"ASV_120\"  \"ASV_1769\" \"ASV_513\"  \"ASV_537\"  \"ASV_2449\" \"ASV_167\" \n  [7] \"ASV_480\"  \"ASV_2782\" \"ASV_1291\" \"ASV_1967\" \"ASV_4990\" \"ASV_1489\"\n [13] \"ASV_231\"  \"ASV_3\"    \"ASV_551\"  \"ASV_645\"  \"ASV_9\"    \"ASV_10\"  \n [19] \"ASV_20\"   \"ASV_48\"   \"ASV_506\"  \"ASV_913\"  \"ASV_2363\" \"ASV_18\"  \n [25] \"ASV_85\"   \"ASV_97\"   \"ASV_798\"  \"ASV_253\"  \"ASV_198\"  \"ASV_1302\"\n [31] \"ASV_1518\" \"ASV_3187\" \"ASV_802\"  \"ASV_969\"  \"ASV_2829\" \"ASV_1443\"\n [37] \"ASV_1523\" \"ASV_19\"   \"ASV_24\"   \"ASV_35\"   \"ASV_501\"  \"ASV_1093\"\n [43] \"ASV_1322\" \"ASV_1865\" \"ASV_1344\" \"ASV_25\"   \"ASV_376\"  \"ASV_51\"  \n [49] \"ASV_977\"  \"ASV_1375\" \"ASV_1514\" \"ASV_1853\" \"ASV_2591\" \"ASV_6\"   \n [55] \"ASV_33\"   \"ASV_16\"   \"ASV_1987\" \"ASV_2604\" \"ASV_160\"  \"ASV_1189\"\n [61] \"ASV_1873\" \"ASV_4157\" \"ASV_2866\" \"ASV_3516\" \"ASV_39\"   \"ASV_41\"  \n [67] \"ASV_68\"   \"ASV_1042\" \"ASV_1246\" \"ASV_3880\" \"ASV_2297\" \"ASV_511\" \n [73] \"ASV_1356\" \"ASV_4894\" \"ASV_743\"  \"ASV_1573\" \"ASV_746\"  \"ASV_1089\"\n [79] \"ASV_1116\" \"ASV_118\"  \"ASV_58\"   \"ASV_62\"   \"ASV_204\"  \"ASV_3227\"\n [85] \"ASV_3698\" \"ASV_2303\" \"ASV_1041\" \"ASV_2235\" \"ASV_2317\" \"ASV_3225\"\n [91] \"ASV_130\"  \"ASV_300\"  \"ASV_692\"  \"ASV_552\"  \"ASV_7\"    \"ASV_250\" \n [97] \"ASV_103\"  \"ASV_114\"  \"ASV_197\"  \"ASV_36\"   \"ASV_109\"  \"ASV_79\"  \n[103] \"ASV_61\"   \"ASV_256\"  \"ASV_196\"  \"ASV_321\"  \"ASV_123\"  \"ASV_105\" \n[109] \"ASV_162\"  \"ASV_166\"  \"ASV_395\"  \"ASV_3212\" \"ASV_246\"  \"ASV_8\"   \n[115] \"ASV_15\"   \"ASV_12\"   \"ASV_11\"   \"ASV_71\"   \"ASV_568\"  \"ASV_487\" \n[121] \"ASV_689\"  \"ASV_892\"  \"ASV_584\"  \"ASV_362\"  \"ASV_1595\" \"ASV_1786\"\n[127] \"ASV_329\"  \"ASV_2126\" \"ASV_3984\" \"ASV_643\"  \"ASV_557\"  \"ASV_781\" \n[133] \"ASV_1254\" \"ASV_1032\" \"ASV_23\"   \"ASV_93\"   \"ASV_86\"   \"ASV_147\" \n[139] \"ASV_1080\" \"ASV_297\"  \"ASV_331\"  \"ASV_4\"    \"ASV_230\"  \"ASV_653\" \n[145] \"ASV_396\"  \"ASV_21\"   \"ASV_2616\" \"ASV_3087\" \"ASV_450\"  \"ASV_3338\"\n[151] \"ASV_516\"  \"ASV_1911\" \"ASV_2747\" \"ASV_141\"  \"ASV_784\"  \"ASV_771\" \n[157] \"ASV_2787\" \"ASV_1075\" \"ASV_2600\" \"ASV_2301\" \"ASV_345\"  \"ASV_942\" \n[163] \"ASV_558\"  \"ASV_92\"   \"ASV_283\"  \"ASV_289\"  \"ASV_221\"  \"ASV_434\" \n[169] \"ASV_239\"  \"ASV_341\"  \"ASV_148\"  \"ASV_116\"  \"ASV_747\"  \"ASV_127\" \n[175] \"ASV_4434\" \"ASV_3540\" \"ASV_1256\" \"ASV_1264\" \"ASV_1124\" \"ASV_2786\"\n[181] \"ASV_3411\" \"ASV_29\"   \"ASV_59\"   \"ASV_60\"   \"ASV_505\"  \"ASV_163\" \n[187] \"ASV_2082\" \"ASV_1751\" \"ASV_3218\" \"ASV_317\"  \"ASV_1487\" \"ASV_1552\"\n[193] \"ASV_935\"  \"ASV_1370\" \"ASV_1408\" \"ASV_280\"  \"ASV_473\"  \"ASV_40\"  \n[199] \"ASV_399\"  \"ASV_110\"  \"ASV_201\"  \"ASV_383\"  \"ASV_1646\" \"ASV_227\" \n[205] \"ASV_278\"  \"ASV_668\"  \"ASV_1208\" \"ASV_921\"  \"ASV_1020\" \"ASV_14\"  \n[211] \"ASV_249\"  \"ASV_453\"  \"ASV_4485\" \"ASV_22\"   \"ASV_622\"  \"ASV_65\"  \n[217] \"ASV_2949\" \"ASV_3929\" \"ASV_275\"  \"ASV_451\"  \"ASV_155\"  \"ASV_548\" \n[223] \"ASV_3387\" \"ASV_3539\" \"ASV_1062\" \"ASV_2653\" \"ASV_774\"  \"ASV_1081\"\n[229] \"ASV_1727\" \"ASV_2603\" \"ASV_3016\" \"ASV_222\"  \"ASV_2448\" \"ASV_243\" \n[235] \"ASV_470\"  \"ASV_1839\" \"ASV_215\"  \"ASV_226\"  \"ASV_944\"  \"ASV_286\" \n[241] \"ASV_442\"  \"ASV_4817\" \"ASV_1163\" \"ASV_493\"  \"ASV_150\"  \"ASV_2\"   \n[247] \"ASV_412\"  \"ASV_475\"  \"ASV_157\"  \"ASV_415\"  \"ASV_776\"  \"ASV_494\" \n[253] \"ASV_125\"  \"ASV_13\"   \"ASV_1\"   \n\n\n\nshared_taxonomy &lt;- get_taxonomy(shared_asvs)\nprint(shared_taxonomy)\n\n             Kingdom            Phylum                  Class\nASV_120   d__Archaea     Crenarchaeota          Bathyarchaeia\nASV_1769 d__Bacteria   Planctomycetota         Planctomycetes\nASV_513  d__Bacteria       Sumerlaeota             Sumerlaeia\nASV_537  d__Bacteria Verrucomicrobiota       Verrucomicrobiae\nASV_2449 d__Bacteria Verrucomicrobiota       Verrucomicrobiae\nASV_167  d__Bacteria      Deinococcota             Deinococci\nASV_480  d__Bacteria   Patescibacteria        Saccharimonadia\nASV_2782 d__Bacteria   Patescibacteria        Saccharimonadia\nASV_1291 d__Bacteria   Patescibacteria          Parcubacteria\nASV_1967 d__Bacteria   Patescibacteria          Parcubacteria\nASV_4990 d__Bacteria   Patescibacteria          Parcubacteria\nASV_1489 d__Bacteria   Patescibacteria                   ABY1\nASV_231  d__Bacteria   Acidobacteriota          Aminicenantia\nASV_3    d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_551  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_645  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_9    d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_10   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_20   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_48   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_506  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_913  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2363 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_18   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_85   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_97   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_798  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_253  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_198  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1302 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1518 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_3187 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_802  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_969  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2829 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1443 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1523 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_19   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_24   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_35   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_501  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1093 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1322 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1865 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1344 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_25   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_376  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_51   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_977  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1375 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1514 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1853 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2591 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_6    d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_33   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_16   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1987 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2604 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_160  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1189 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1873 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_4157 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2866 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_3516 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_39   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_41   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_68   d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1042 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1246 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_3880 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_2297 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_511  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1356 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_4894 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_743  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1573 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_746  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1089 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_1116 d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_118  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_58   d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_62   d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_204  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_3227 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_3698 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_2303 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_1041 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_2235 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_2317 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_3225 d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_130  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_300  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_692  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_552  d__Bacteria    Proteobacteria    Alphaproteobacteria\nASV_7    d__Bacteria           Sva0485                Sva0485\nASV_250  d__Bacteria           Sva0485                Sva0485\nASV_103  d__Bacteria           Sva0485                Sva0485\nASV_114  d__Bacteria           Sva0485                Sva0485\nASV_197  d__Bacteria           Sva0485                Sva0485\nASV_36   d__Bacteria           Sva0485                Sva0485\nASV_109  d__Bacteria           Sva0485                Sva0485\nASV_79   d__Bacteria           Sva0485                Sva0485\nASV_61   d__Bacteria           Sva0485                Sva0485\nASV_256  d__Bacteria           Sva0485                Sva0485\nASV_196  d__Bacteria           Sva0485                Sva0485\nASV_321  d__Bacteria           Sva0485                Sva0485\nASV_123  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_105  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_162  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_166  d__Bacteria  Desulfobacterota        Desulfobacteria\nASV_395  d__Bacteria  Desulfobacterota             uncultured\nASV_3212 d__Bacteria       Myxococcota              Polyangia\nASV_246  d__Bacteria            MBNT15                 MBNT15\nASV_8    d__Bacteria      Bacteroidota            Bacteroidia\nASV_15   d__Bacteria      Bacteroidota            Bacteroidia\nASV_12   d__Bacteria      Bacteroidota            Bacteroidia\nASV_11   d__Bacteria      Bacteroidota            Bacteroidia\nASV_71   d__Bacteria      Bacteroidota            Bacteroidia\nASV_568  d__Bacteria      Bacteroidota            Bacteroidia\nASV_487  d__Bacteria      Bacteroidota            Bacteroidia\nASV_689  d__Bacteria      Bacteroidota            Bacteroidia\nASV_892  d__Bacteria      Bacteroidota            Bacteroidia\nASV_584  d__Bacteria      Bacteroidota            Bacteroidia\nASV_362  d__Bacteria      Bacteroidota            Bacteroidia\nASV_1595 d__Bacteria      Bacteroidota            Bacteroidia\nASV_1786 d__Bacteria      Bacteroidota            Bacteroidia\nASV_329  d__Bacteria      Bacteroidota            Bacteroidia\nASV_2126 d__Bacteria      Bacteroidota            Bacteroidia\nASV_3984 d__Bacteria      Bacteroidota            Bacteroidia\nASV_643  d__Bacteria      Bacteroidota         Ignavibacteria\nASV_557  d__Bacteria      Bacteroidota         Ignavibacteria\nASV_781  d__Bacteria      Bacteroidota              Kryptonia\nASV_1254 d__Bacteria  Campilobacterota        Campylobacteria\nASV_1032 d__Bacteria     Spirochaetota           Spirochaetia\nASV_23   d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_93   d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_86   d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_147  d__Bacteria      Nitrospirota Thermodesulfovibrionia\nASV_1080 d__Bacteria   Acidobacteriota            Subgroup_18\nASV_297  d__Bacteria     Calditrichota           Calditrichia\nASV_331  d__Bacteria      Zixibacteria           Zixibacteria\nASV_4    d__Bacteria  Actinobacteriota         Actinobacteria\nASV_230  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_653  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_396  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_21   d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2616 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_3087 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_450  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_3338 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_516  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_1911 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2747 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_141  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_784  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_771  d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2787 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_1075 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2600 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_2301 d__Bacteria  Actinobacteriota         Actinobacteria\nASV_345  d__Bacteria  Actinobacteriota         Coriobacteriia\nASV_942  d__Bacteria  Actinobacteriota         Coriobacteriia\nASV_558  d__Bacteria       Chloroflexi                   &lt;NA&gt;\nASV_92   d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_283  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_289  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_221  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_434  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_239  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_341  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_148  d__Bacteria       Chloroflexi        Dehalococcoidia\nASV_116  d__Bacteria       Chloroflexi           Anaerolineae\nASV_747  d__Bacteria       Chloroflexi           Anaerolineae\nASV_127  d__Bacteria       Chloroflexi           Anaerolineae\nASV_4434 d__Bacteria       Chloroflexi           Chloroflexia\nASV_3540 d__Bacteria   Acidobacteriota         Acidobacteriae\nASV_1256 d__Bacteria     Cyanobacteria      Sericytochromatia\nASV_1264 d__Bacteria    Fusobacteriota          Fusobacteriia\nASV_1124 d__Bacteria        Firmicutes             Clostridia\nASV_2786 d__Bacteria        Firmicutes             Clostridia\nASV_3411 d__Bacteria        Firmicutes             Clostridia\nASV_29   d__Bacteria        Firmicutes          Negativicutes\nASV_59   d__Bacteria        Firmicutes          Negativicutes\nASV_60   d__Bacteria        Firmicutes          Negativicutes\nASV_505  d__Bacteria        Firmicutes          Negativicutes\nASV_163  d__Bacteria        Firmicutes          Negativicutes\nASV_2082 d__Bacteria        Firmicutes          Negativicutes\nASV_1751 d__Bacteria        Firmicutes          Negativicutes\nASV_3218 d__Bacteria        Firmicutes          Negativicutes\nASV_317  d__Bacteria        Firmicutes          Negativicutes\nASV_1487 d__Bacteria        Firmicutes          Negativicutes\nASV_1552 d__Bacteria        Firmicutes          Negativicutes\nASV_935  d__Bacteria        Firmicutes          Negativicutes\nASV_1370 d__Bacteria        Firmicutes          Negativicutes\nASV_1408 d__Bacteria        Firmicutes          Negativicutes\nASV_280  d__Bacteria        Firmicutes          Negativicutes\nASV_473  d__Bacteria        Firmicutes          Negativicutes\nASV_40   d__Bacteria        Firmicutes          Negativicutes\nASV_399  d__Bacteria    Proteobacteria    Gammaproteobacteria\nASV_110  d__Bacteria        Firmicutes                Bacilli\nASV_201  d__Bacteria        Firmicutes                Bacilli\nASV_383  d__Bacteria        Firmicutes                Bacilli\nASV_1646 d__Bacteria        Firmicutes                Bacilli\nASV_227  d__Bacteria        Firmicutes                Bacilli\nASV_278  d__Bacteria        Firmicutes                Bacilli\nASV_668  d__Bacteria        Firmicutes                Bacilli\nASV_1208 d__Bacteria        Firmicutes                Bacilli\nASV_921  d__Bacteria        Firmicutes                Bacilli\nASV_1020 d__Bacteria        Firmicutes                Bacilli\nASV_14   d__Bacteria        Firmicutes                Bacilli\nASV_249  d__Bacteria        Firmicutes                Bacilli\nASV_453  d__Bacteria        Firmicutes                Bacilli\nASV_4485 d__Bacteria        Firmicutes                Bacilli\nASV_22   d__Bacteria        Firmicutes                Bacilli\nASV_622  d__Bacteria        Firmicutes                Bacilli\nASV_65   d__Bacteria        Firmicutes                Bacilli\nASV_2949 d__Bacteria        Firmicutes                Bacilli\nASV_3929 d__Bacteria        Firmicutes                Bacilli\nASV_275  d__Bacteria        Firmicutes                Bacilli\nASV_451  d__Bacteria        Firmicutes                Bacilli\nASV_155  d__Bacteria        Firmicutes                Bacilli\nASV_548  d__Bacteria        Firmicutes                Bacilli\nASV_3387 d__Bacteria        Firmicutes                Bacilli\nASV_3539 d__Bacteria        Firmicutes                Bacilli\nASV_1062 d__Bacteria        Firmicutes                Bacilli\nASV_2653 d__Bacteria        Firmicutes                Bacilli\nASV_774  d__Bacteria        Firmicutes                Bacilli\nASV_1081 d__Bacteria        Firmicutes                Bacilli\nASV_1727 d__Bacteria        Firmicutes                Bacilli\nASV_2603 d__Bacteria        Firmicutes                Bacilli\nASV_3016 d__Bacteria        Firmicutes                Bacilli\nASV_222  d__Bacteria        Firmicutes                Bacilli\nASV_2448 d__Bacteria        Firmicutes                Bacilli\nASV_243  d__Bacteria        Firmicutes                Bacilli\nASV_470  d__Bacteria        Firmicutes                Bacilli\nASV_1839 d__Bacteria        Firmicutes                Bacilli\nASV_215  d__Bacteria        Firmicutes                Bacilli\nASV_226  d__Bacteria        Firmicutes                Bacilli\nASV_944  d__Bacteria        Firmicutes                Bacilli\nASV_286  d__Bacteria        Firmicutes                Bacilli\nASV_442  d__Bacteria        Firmicutes                Bacilli\nASV_4817 d__Bacteria        Firmicutes                Bacilli\nASV_1163 d__Bacteria        Firmicutes                Bacilli\nASV_493  d__Bacteria        Firmicutes                Bacilli\nASV_150  d__Bacteria        Firmicutes                Bacilli\nASV_2    d__Bacteria        Firmicutes                Bacilli\nASV_412  d__Bacteria        Firmicutes                Bacilli\nASV_475  d__Bacteria        Firmicutes                Bacilli\nASV_157  d__Bacteria        Firmicutes                Bacilli\nASV_415  d__Bacteria        Firmicutes                Bacilli\nASV_776  d__Bacteria        Firmicutes                Bacilli\nASV_494  d__Bacteria        Firmicutes                Bacilli\nASV_125  d__Bacteria        Firmicutes                Bacilli\nASV_13   d__Bacteria        Firmicutes                Bacilli\nASV_1    d__Bacteria        Firmicutes                Bacilli\n                                  Order                       Family\nASV_120                   Bathyarchaeia                Bathyarchaeia\nASV_1769                  Isosphaerales               Isosphaeraceae\nASV_513                    Sumerlaeales                Sumerlaeaceae\nASV_537                  Pedosphaerales              Pedosphaeraceae\nASV_2449                 Pedosphaerales              Pedosphaeraceae\nASV_167                   Deinococcales               Deinococcaceae\nASV_480               Saccharimonadales           Saccharimonadaceae\nASV_2782              Saccharimonadales            Saccharimonadales\nASV_1291                  Parcubacteria                Parcubacteria\nASV_1967      Candidatus_Kaiserbacteria    Candidatus_Kaiserbacteria\nASV_4990                           &lt;NA&gt;                         &lt;NA&gt;\nASV_1489   Candidatus_Magasanikbacteria Candidatus_Magasanikbacteria\nASV_231                 Aminicenantales              Aminicenantales\nASV_3                  Enterobacterales           Enterobacteriaceae\nASV_551                Enterobacterales           Enterobacteriaceae\nASV_645                Enterobacterales           Enterobacteriaceae\nASV_9                  Enterobacterales           Enterobacteriaceae\nASV_10                 Enterobacterales           Enterobacteriaceae\nASV_20                 Enterobacterales           Enterobacteriaceae\nASV_48                 Enterobacterales           Enterobacteriaceae\nASV_506                Enterobacterales           Enterobacteriaceae\nASV_913                Enterobacterales           Enterobacteriaceae\nASV_2363               Enterobacterales           Enterobacteriaceae\nASV_18                 Enterobacterales           Enterobacteriaceae\nASV_85                 Enterobacterales           Enterobacteriaceae\nASV_97                 Enterobacterales               Morganellaceae\nASV_798                Enterobacterales               Morganellaceae\nASV_253                Enterobacterales               Morganellaceae\nASV_198                Enterobacterales                 Yersiniaceae\nASV_1302               Enterobacterales                 Yersiniaceae\nASV_1518               Enterobacterales           Enterobacteriaceae\nASV_3187               Enterobacterales           Enterobacteriaceae\nASV_802                Enterobacterales           Enterobacteriaceae\nASV_969                Enterobacterales           Enterobacteriaceae\nASV_2829               Enterobacterales           Enterobacteriaceae\nASV_1443               Enterobacterales           Enterobacteriaceae\nASV_1523               Enterobacterales           Enterobacteriaceae\nASV_19                 Enterobacterales           Enterobacteriaceae\nASV_24                 Enterobacterales           Enterobacteriaceae\nASV_35                 Enterobacterales           Enterobacteriaceae\nASV_501                Enterobacterales               Morganellaceae\nASV_1093               Enterobacterales               Morganellaceae\nASV_1322               Enterobacterales               Morganellaceae\nASV_1865               Enterobacterales               Morganellaceae\nASV_1344               Enterobacterales               Morganellaceae\nASV_25                    Aeromonadales               Aeromonadaceae\nASV_376                   Aeromonadales               Aeromonadaceae\nASV_51                  Pseudomonadales                Moraxellaceae\nASV_977                 Pseudomonadales                Moraxellaceae\nASV_1375                Pseudomonadales                Moraxellaceae\nASV_1514                Pseudomonadales                Moraxellaceae\nASV_1853                Pseudomonadales                Moraxellaceae\nASV_2591                Pseudomonadales                Moraxellaceae\nASV_6                   Pseudomonadales             Pseudomonadaceae\nASV_33                  Pseudomonadales             Pseudomonadaceae\nASV_16                  Pseudomonadales             Pseudomonadaceae\nASV_1987                Pseudomonadales             Pseudomonadaceae\nASV_2604                Pseudomonadales             Pseudomonadaceae\nASV_160                     KF-JG30-C25                  KF-JG30-C25\nASV_1189                Xanthomonadales             Xanthomonadaceae\nASV_1873                Xanthomonadales             Xanthomonadaceae\nASV_4157                Xanthomonadales             Xanthomonadaceae\nASV_2866                Xanthomonadales             Xanthomonadaceae\nASV_3516                Xanthomonadales             Xanthomonadaceae\nASV_39             Acidiferrobacterales        Acidiferrobacteraceae\nASV_41                  Burkholderiales                       B1-7BS\nASV_68                  Burkholderiales                       B1-7BS\nASV_1042                Burkholderiales               Comamonadaceae\nASV_1246                Burkholderiales               Comamonadaceae\nASV_3880                Burkholderiales               Comamonadaceae\nASV_2297                Burkholderiales               Comamonadaceae\nASV_511                 Burkholderiales             Burkholderiaceae\nASV_1356                Burkholderiales             Burkholderiaceae\nASV_4894                Burkholderiales             Burkholderiaceae\nASV_743                 Burkholderiales               Alcaligenaceae\nASV_1573                Burkholderiales                Neisseriaceae\nASV_746                 Burkholderiales             Oxalobacteraceae\nASV_1089                Burkholderiales             Oxalobacteraceae\nASV_1116                Burkholderiales            Nitrosomonadaceae\nASV_118                 Burkholderiales            Nitrosomonadaceae\nASV_58                      Rhizobiales            Xanthobacteraceae\nASV_62                      Rhizobiales            Xanthobacteraceae\nASV_204                     Rhizobiales             Beijerinckiaceae\nASV_3227                    Rhizobiales             Beijerinckiaceae\nASV_3698                    Rhizobiales             Beijerinckiaceae\nASV_2303                    Rhizobiales            Xanthobacteraceae\nASV_1041                    Rhizobiales                 Rhizobiaceae\nASV_2235                    Rhizobiales                 Rhizobiaceae\nASV_2317                    Rhizobiales                 Rhizobiaceae\nASV_3225               Sphingomonadales            Sphingomonadaceae\nASV_130                 Acetobacterales             Acetobacteraceae\nASV_300                 Acetobacterales             Acetobacteraceae\nASV_692                 Acetobacterales             Acetobacteraceae\nASV_552                 Acetobacterales             Acetobacteraceae\nASV_7                           Sva0485                      Sva0485\nASV_250                         Sva0485                      Sva0485\nASV_103                         Sva0485                      Sva0485\nASV_114                         Sva0485                      Sva0485\nASV_197                         Sva0485                      Sva0485\nASV_36                          Sva0485                      Sva0485\nASV_109                         Sva0485                      Sva0485\nASV_79                          Sva0485                      Sva0485\nASV_61                          Sva0485                      Sva0485\nASV_256                         Sva0485                      Sva0485\nASV_196                         Sva0485                      Sva0485\nASV_321                         Sva0485                      Sva0485\nASV_123              Desulfatiglandales          Desulfatiglandaceae\nASV_105               Desulfobacterales           Desulfosarcinaceae\nASV_162               Desulfobacterales           Desulfosarcinaceae\nASV_166               Desulfobacterales           Desulfosarcinaceae\nASV_395                      uncultured                   uncultured\nASV_3212                   Polyangiales                      BIrii41\nASV_246                          MBNT15                       MBNT15\nASV_8                     Bacteroidales               Prevotellaceae\nASV_15                    Bacteroidales               Prevotellaceae\nASV_12                    Bacteroidales               Prevotellaceae\nASV_11                    Bacteroidales               Prevotellaceae\nASV_71                    Bacteroidales               Prevotellaceae\nASV_568                   Bacteroidales               Prevotellaceae\nASV_487                   Bacteroidales               Prevotellaceae\nASV_689                   Bacteroidales               Prevotellaceae\nASV_892                   Bacteroidales            Dysgonomonadaceae\nASV_584                   Bacteroidales            Dysgonomonadaceae\nASV_362                   Bacteroidales            Dysgonomonadaceae\nASV_1595                  Bacteroidales            Dysgonomonadaceae\nASV_1786                  Bacteroidales            Dysgonomonadaceae\nASV_329                   Bacteroidales            Paludibacteraceae\nASV_2126               Flavobacteriales                Weeksellaceae\nASV_3984               Flavobacteriales                Weeksellaceae\nASV_643               Ignavibacteriales           Ignavibacteriaceae\nASV_557               Ignavibacteriales                         &lt;NA&gt;\nASV_781                    Kryptoniales                        BSV26\nASV_1254              Campylobacterales              Arcobacteraceae\nASV_1032                 Spirochaetales              Spirochaetaceae\nASV_23                       uncultured                   uncultured\nASV_93                       uncultured                   uncultured\nASV_86                       uncultured                   uncultured\nASV_147                      uncultured                   uncultured\nASV_1080                    Subgroup_18                  Subgroup_18\nASV_297                  Calditrichales              Calditrichaceae\nASV_331                    Zixibacteria                 Zixibacteria\nASV_4                 Bifidobacteriales           Bifidobacteriaceae\nASV_230               Bifidobacteriales           Bifidobacteriaceae\nASV_653               Bifidobacteriales           Bifidobacteriaceae\nASV_396               Bifidobacteriales           Bifidobacteriaceae\nASV_21                    Micrococcales               Micrococcaceae\nASV_2616                  Micrococcales               Dermacoccaceae\nASV_3087                  Micrococcales           Intrasporangiaceae\nASV_450                   Micrococcales             Dermabacteraceae\nASV_3338                  Micrococcales               Micrococcaceae\nASV_516             Streptosporangiales              Nocardiopsaceae\nASV_1911            Streptosporangiales              Nocardiopsaceae\nASV_2747            Propionibacteriales         Propionibacteriaceae\nASV_141               Corynebacteriales           Corynebacteriaceae\nASV_784               Corynebacteriales           Corynebacteriaceae\nASV_771               Corynebacteriales           Corynebacteriaceae\nASV_2787              Corynebacteriales           Corynebacteriaceae\nASV_1075              Corynebacteriales                 Nocardiaceae\nASV_2600              Corynebacteriales                 Nocardiaceae\nASV_2301               Streptomycetales            Streptomycetaceae\nASV_345                Coriobacteriales              Eggerthellaceae\nASV_942                Coriobacteriales                 Atopobiaceae\nASV_558                            &lt;NA&gt;                         &lt;NA&gt;\nASV_92                             GIF3                         GIF3\nASV_283                            GIF3                         GIF3\nASV_289                            &lt;NA&gt;                         &lt;NA&gt;\nASV_221                       vadinBA26                    vadinBA26\nASV_434                            GIF9                         GIF9\nASV_239                            GIF9                         GIF9\nASV_341                            GIF9                         GIF9\nASV_148                            S085                         S085\nASV_116                  Anaerolineales              Anaerolineaceae\nASV_747                  Anaerolineales              Anaerolineaceae\nASV_127                  Anaerolineales              Anaerolineaceae\nASV_4434              Thermomicrobiales           Thermomicrobiaceae\nASV_3540                 Solibacterales              Solibacteraceae\nASV_1256              Sericytochromatia            Sericytochromatia\nASV_1264                Fusobacteriales             Leptotrichiaceae\nASV_1124                Oscillospirales              Ruminococcaceae\nASV_2786                Oscillospirales              Ruminococcaceae\nASV_3411                Oscillospirales              Ruminococcaceae\nASV_29   Veillonellales-Selenomonadales              Veillonellaceae\nASV_59   Veillonellales-Selenomonadales             Selenomonadaceae\nASV_60   Veillonellales-Selenomonadales             Selenomonadaceae\nASV_505  Veillonellales-Selenomonadales             Selenomonadaceae\nASV_163  Veillonellales-Selenomonadales             Selenomonadaceae\nASV_2082 Veillonellales-Selenomonadales             Selenomonadaceae\nASV_1751 Veillonellales-Selenomonadales             Selenomonadaceae\nASV_3218 Veillonellales-Selenomonadales             Selenomonadaceae\nASV_317  Veillonellales-Selenomonadales              Veillonellaceae\nASV_1487 Veillonellales-Selenomonadales              Veillonellaceae\nASV_1552 Veillonellales-Selenomonadales              Veillonellaceae\nASV_935  Veillonellales-Selenomonadales              Veillonellaceae\nASV_1370 Veillonellales-Selenomonadales              Veillonellaceae\nASV_1408 Veillonellales-Selenomonadales              Veillonellaceae\nASV_280  Veillonellales-Selenomonadales              Veillonellaceae\nASV_473  Veillonellales-Selenomonadales              Veillonellaceae\nASV_40   Veillonellales-Selenomonadales              Veillonellaceae\nASV_399                Enterobacterales           Enterobacteriaceae\nASV_110              Erysipelotrichales          Erysipelotrichaceae\nASV_201               Entomoplasmatales           Entomoplasmataceae\nASV_383              Erysipelotrichales    Erysipelatoclostridiaceae\nASV_1646             Erysipelotrichales    Erysipelatoclostridiaceae\nASV_227                Staphylococcales            Staphylococcaceae\nASV_278                Staphylococcales            Staphylococcaceae\nASV_668                Staphylococcales            Staphylococcaceae\nASV_1208                     Bacillales                  Bacillaceae\nASV_921                      Bacillales                  Bacillaceae\nASV_1020                Lactobacillales              Enterococcaceae\nASV_14                  Lactobacillales              Enterococcaceae\nASV_249                 Lactobacillales              Enterococcaceae\nASV_453                 Lactobacillales              Enterococcaceae\nASV_4485                Lactobacillales                Vagococcaceae\nASV_22                  Lactobacillales             Lactobacillaceae\nASV_622                 Lactobacillales             Lactobacillaceae\nASV_65                  Lactobacillales             Lactobacillaceae\nASV_2949                Lactobacillales             Lactobacillaceae\nASV_3929                Lactobacillales             Lactobacillaceae\nASV_275                 Lactobacillales             Lactobacillaceae\nASV_451                 Lactobacillales             Lactobacillaceae\nASV_155                 Lactobacillales             Lactobacillaceae\nASV_548                 Lactobacillales             Lactobacillaceae\nASV_3387                Lactobacillales             Lactobacillaceae\nASV_3539                Lactobacillales             Lactobacillaceae\nASV_1062                Lactobacillales             Lactobacillaceae\nASV_2653                Lactobacillales             Lactobacillaceae\nASV_774                 Lactobacillales             Lactobacillaceae\nASV_1081                Lactobacillales             Lactobacillaceae\nASV_1727                Lactobacillales             Lactobacillaceae\nASV_2603                Lactobacillales             Lactobacillaceae\nASV_3016                Lactobacillales             Lactobacillaceae\nASV_222                 Lactobacillales             Lactobacillaceae\nASV_2448                Lactobacillales             Lactobacillaceae\nASV_243                 Lactobacillales             Lactobacillaceae\nASV_470                 Lactobacillales             Leuconostocaceae\nASV_1839                Lactobacillales             Leuconostocaceae\nASV_215                 Lactobacillales              Enterococcaceae\nASV_226                 Lactobacillales             Streptococcaceae\nASV_944                 Lactobacillales             Streptococcaceae\nASV_286                 Lactobacillales             Streptococcaceae\nASV_442                 Lactobacillales             Streptococcaceae\nASV_4817                Lactobacillales              Enterococcaceae\nASV_1163                Lactobacillales              Enterococcaceae\nASV_493                 Lactobacillales              Enterococcaceae\nASV_150                 Lactobacillales              Enterococcaceae\nASV_2                   Lactobacillales              Enterococcaceae\nASV_412                 Lactobacillales              Enterococcaceae\nASV_475                 Lactobacillales              Enterococcaceae\nASV_157                 Lactobacillales              Enterococcaceae\nASV_415                 Lactobacillales              Enterococcaceae\nASV_776                 Lactobacillales              Enterococcaceae\nASV_494                 Lactobacillales              Enterococcaceae\nASV_125                 Lactobacillales              Enterococcaceae\nASV_13                  Lactobacillales              Enterococcaceae\nASV_1                   Lactobacillales              Enterococcaceae\n                                                      Genus\nASV_120                                       Bathyarchaeia\nASV_1769                                         uncultured\nASV_513                                           Sumerlaea\nASV_537                                          uncultured\nASV_2449                                         uncultured\nASV_167                                         Deinococcus\nASV_480                                                TM7a\nASV_2782                                  Saccharimonadales\nASV_1291                                      Parcubacteria\nASV_1967                          Candidatus_Kaiserbacteria\nASV_4990                                               &lt;NA&gt;\nASV_1489                       Candidatus_Magasanikbacteria\nASV_231                                     Aminicenantales\nASV_3                                          Enterobacter\nASV_551                                        Enterobacter\nASV_645                                        Enterobacter\nASV_9                                                  &lt;NA&gt;\nASV_10                                                 &lt;NA&gt;\nASV_20                                                 &lt;NA&gt;\nASV_48                                                 &lt;NA&gt;\nASV_506                                                &lt;NA&gt;\nASV_913                                                &lt;NA&gt;\nASV_2363                                       Enterobacter\nASV_18                                                 &lt;NA&gt;\nASV_85                                                 &lt;NA&gt;\nASV_97                                           Morganella\nASV_798                                          Morganella\nASV_253                                          Morganella\nASV_198                                            Serratia\nASV_1302                                           Serratia\nASV_1518                                         Shimwellia\nASV_3187                                         Raoultella\nASV_802                                          Raoultella\nASV_969                                          Raoultella\nASV_2829                                               &lt;NA&gt;\nASV_1443                                               &lt;NA&gt;\nASV_1523                                               &lt;NA&gt;\nASV_19                                                 &lt;NA&gt;\nASV_24                                 Escherichia-Shigella\nASV_35                                                 &lt;NA&gt;\nASV_501                                             Proteus\nASV_1093                                        Providencia\nASV_1322                                        Providencia\nASV_1865                                        Providencia\nASV_1344                                            Proteus\nASV_25                                            Aeromonas\nASV_376                                           Aeromonas\nASV_51                                        Enhydrobacter\nASV_977                                       Acinetobacter\nASV_1375                                      Acinetobacter\nASV_1514                                      Acinetobacter\nASV_1853                                      Acinetobacter\nASV_2591                                      Acinetobacter\nASV_6                                           Pseudomonas\nASV_33                                          Pseudomonas\nASV_16                                          Pseudomonas\nASV_1987                                        Pseudomonas\nASV_2604                                        Pseudomonas\nASV_160                                         KF-JG30-C25\nASV_1189                                         Luteimonas\nASV_1873                                   Stenotrophomonas\nASV_4157                                   Stenotrophomonas\nASV_2866                                   Stenotrophomonas\nASV_3516                                         Lysobacter\nASV_39                                        Sulfurifustis\nASV_41                                               B1-7BS\nASV_68                                               B1-7BS\nASV_1042                                               &lt;NA&gt;\nASV_1246                                            Delftia\nASV_3880                                         uncultured\nASV_2297                                       Schlegelella\nASV_511          Burkholderia-Caballeronia-Paraburkholderia\nASV_1356                                          Ralstonia\nASV_4894                                          Ralstonia\nASV_743                                                &lt;NA&gt;\nASV_1573                                         uncultured\nASV_746                                            Massilia\nASV_1089                                           Massilia\nASV_1116                                          Ellin6067\nASV_118                                                MND1\nASV_58                                       Bradyrhizobium\nASV_62                                       Bradyrhizobium\nASV_204                      Methylobacterium-Methylorubrum\nASV_3227                     Methylobacterium-Methylorubrum\nASV_3698                     Methylobacterium-Methylorubrum\nASV_2303                                       Pseudolabrys\nASV_1041                                      Mesorhizobium\nASV_2235                                            Ensifer\nASV_2317 Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\nASV_3225                                        Sphingobium\nASV_130                                         Acetobacter\nASV_300                                         Acetobacter\nASV_692                                         Acetobacter\nASV_552                                         Acetobacter\nASV_7                                               Sva0485\nASV_250                                             Sva0485\nASV_103                                             Sva0485\nASV_114                                             Sva0485\nASV_197                                             Sva0485\nASV_36                                              Sva0485\nASV_109                                             Sva0485\nASV_79                                              Sva0485\nASV_61                                              Sva0485\nASV_256                                             Sva0485\nASV_196                                             Sva0485\nASV_321                                             Sva0485\nASV_123                                      Desulfatiglans\nASV_105                              Sva0081_sediment_group\nASV_162                              Sva0081_sediment_group\nASV_166                              Sva0081_sediment_group\nASV_395                                          uncultured\nASV_3212                                            BIrii41\nASV_246                                              MBNT15\nASV_8                                            Prevotella\nASV_15                                           Prevotella\nASV_12                                           Prevotella\nASV_11                                           Prevotella\nASV_71                                           Prevotella\nASV_568                                          Prevotella\nASV_487                                          Prevotella\nASV_689                                          Prevotella\nASV_892                                        Dysgonomonas\nASV_584                                        Dysgonomonas\nASV_362                                        Dysgonomonas\nASV_1595                                               &lt;NA&gt;\nASV_1786                                               &lt;NA&gt;\nASV_329                                                &lt;NA&gt;\nASV_2126                                    Cloacibacterium\nASV_3984                                         uncultured\nASV_643                                     Ignavibacterium\nASV_557                                                &lt;NA&gt;\nASV_781                                               BSV26\nASV_1254                                         Arcobacter\nASV_1032                                        Spirochaeta\nASV_23                                           uncultured\nASV_93                                           uncultured\nASV_86                                           uncultured\nASV_147                                          uncultured\nASV_1080                                        Subgroup_18\nASV_297                                         Calorithrix\nASV_331                                        Zixibacteria\nASV_4                                       Bifidobacterium\nASV_230                                     Bifidobacterium\nASV_653                                     Bifidobacterium\nASV_396                                     Bifidobacterium\nASV_21                                          Micrococcus\nASV_2616                                         Kytococcus\nASV_3087                                               &lt;NA&gt;\nASV_450                                     Brachybacterium\nASV_3338                                   Paenarthrobacter\nASV_516                                        Nocardiopsis\nASV_1911                                       Nocardiopsis\nASV_2747                                      Cutibacterium\nASV_141                                     Corynebacterium\nASV_784                                     Corynebacterium\nASV_771                                     Corynebacterium\nASV_2787                                    Corynebacterium\nASV_1075                                        Rhodococcus\nASV_2600                                        Rhodococcus\nASV_2301                                       Streptomyces\nASV_345                                          uncultured\nASV_942                                           Olsenella\nASV_558                                                &lt;NA&gt;\nASV_92                                                 GIF3\nASV_283                                                GIF3\nASV_289                                                &lt;NA&gt;\nASV_221                                           vadinBA26\nASV_434                                                GIF9\nASV_239                                                GIF9\nASV_341                                                GIF9\nASV_148                                                S085\nASV_116                                          uncultured\nASV_747                                          uncultured\nASV_127                                          uncultured\nASV_4434                                        Nitrolancea\nASV_3540                              Candidatus_Solibacter\nASV_1256                                  Sericytochromatia\nASV_1264                                       Leptotrichia\nASV_1124                                   Faecalibacterium\nASV_2786                                   Faecalibacterium\nASV_3411                                   Faecalibacterium\nASV_29                                           uncultured\nASV_59                                           Pectinatus\nASV_60                                           Pectinatus\nASV_505                                          Pectinatus\nASV_163                                          Pectinatus\nASV_2082                                         Pectinatus\nASV_1751                                         Pectinatus\nASV_3218                                         Pectinatus\nASV_317                                         Megasphaera\nASV_1487                                        Megasphaera\nASV_1552                                        Megasphaera\nASV_935                                           Dialister\nASV_1370                                         uncultured\nASV_1408                                         uncultured\nASV_280                                          uncultured\nASV_473                                          uncultured\nASV_40                                           uncultured\nASV_399                                                &lt;NA&gt;\nASV_110                                             ZOR0006\nASV_201                                        Entomoplasma\nASV_383                                      Asteroleplasma\nASV_1646                                            UCG-004\nASV_227                                      Staphylococcus\nASV_278                                      Staphylococcus\nASV_668                                      Staphylococcus\nASV_1208                                           Bacillus\nASV_921                                      Oceanobacillus\nASV_1020                                       Enterococcus\nASV_14                                         Enterococcus\nASV_249                                        Enterococcus\nASV_453                                        Enterococcus\nASV_4485                                         Vagococcus\nASV_22                                        Lactobacillus\nASV_622                                       Lactobacillus\nASV_65                                        Lactobacillus\nASV_2949                                      Lactobacillus\nASV_3929                                      Lactobacillus\nASV_275                                       Lactobacillus\nASV_451                                       Lactobacillus\nASV_155                                       Lactobacillus\nASV_548                                       Lactobacillus\nASV_3387                                      Lactobacillus\nASV_3539                                      Lactobacillus\nASV_1062                                      Lactobacillus\nASV_2653                                        Pediococcus\nASV_774                                                &lt;NA&gt;\nASV_1081                                      Lactobacillus\nASV_1727                                      Lactobacillus\nASV_2603                                      Lactobacillus\nASV_3016                                      Lactobacillus\nASV_222                                       Lactobacillus\nASV_2448                                      Lactobacillus\nASV_243                                       Lactobacillus\nASV_470                                           Weissella\nASV_1839                                        Leuconostoc\nASV_215                                        Enterococcus\nASV_226                                       Streptococcus\nASV_944                                       Streptococcus\nASV_286                                         Lactococcus\nASV_442                                         Lactococcus\nASV_4817                                       Enterococcus\nASV_1163                                       Enterococcus\nASV_493                                        Enterococcus\nASV_150                                        Enterococcus\nASV_2                                          Enterococcus\nASV_412                                        Enterococcus\nASV_475                                        Enterococcus\nASV_157                                        Enterococcus\nASV_415                                        Enterococcus\nASV_776                                        Enterococcus\nASV_494                                        Enterococcus\nASV_125                                        Enterococcus\nASV_13                                         Enterococcus\nASV_1                                          Enterococcus\n                                    Species\nASV_120                                &lt;NA&gt;\nASV_1769                               &lt;NA&gt;\nASV_513                 uncultured_organism\nASV_537                                &lt;NA&gt;\nASV_2449               uncultured_bacterium\nASV_167                     Deinococcus_sp.\nASV_480                uncultured_bacterium\nASV_2782                               &lt;NA&gt;\nASV_1291                               &lt;NA&gt;\nASV_1967               uncultured_bacterium\nASV_4990                               &lt;NA&gt;\nASV_1489               uncultured_bacterium\nASV_231            uncultured_Aminicenantes\nASV_3                                  &lt;NA&gt;\nASV_551                                &lt;NA&gt;\nASV_645                                &lt;NA&gt;\nASV_9                                  &lt;NA&gt;\nASV_10                                 &lt;NA&gt;\nASV_20                                 &lt;NA&gt;\nASV_48                                 &lt;NA&gt;\nASV_506                                &lt;NA&gt;\nASV_913                                &lt;NA&gt;\nASV_2363                               &lt;NA&gt;\nASV_18                                 &lt;NA&gt;\nASV_85                                 &lt;NA&gt;\nASV_97                                 &lt;NA&gt;\nASV_798                                &lt;NA&gt;\nASV_253                                &lt;NA&gt;\nASV_198                                &lt;NA&gt;\nASV_1302                               &lt;NA&gt;\nASV_1518             Cronobacter_muytjensii\nASV_3187                               &lt;NA&gt;\nASV_802                                &lt;NA&gt;\nASV_969                                &lt;NA&gt;\nASV_2829                               &lt;NA&gt;\nASV_1443                               &lt;NA&gt;\nASV_1523                               &lt;NA&gt;\nASV_19                                 &lt;NA&gt;\nASV_24                   Citrobacter_koseri\nASV_35                                 &lt;NA&gt;\nASV_501                                &lt;NA&gt;\nASV_1093                               &lt;NA&gt;\nASV_1322                               &lt;NA&gt;\nASV_1865                               &lt;NA&gt;\nASV_1344                               &lt;NA&gt;\nASV_25                                 &lt;NA&gt;\nASV_376                                &lt;NA&gt;\nASV_51                                 &lt;NA&gt;\nASV_977              Acinetobacter_ursingii\nASV_1375             Acinetobacter_ursingii\nASV_1514           Acinetobacter_schindleri\nASV_1853           Acinetobacter_schindleri\nASV_2591           Acinetobacter_schindleri\nASV_6                                  &lt;NA&gt;\nASV_33                                 &lt;NA&gt;\nASV_16                                 &lt;NA&gt;\nASV_1987        Pseudomonas_psychrotolerans\nASV_2604                  Pseudomonas_fragi\nASV_160                 uncultured_organism\nASV_1189                               &lt;NA&gt;\nASV_1873                               &lt;NA&gt;\nASV_4157                               &lt;NA&gt;\nASV_2866                               &lt;NA&gt;\nASV_3516                               &lt;NA&gt;\nASV_39           uncultured_proteobacterium\nASV_41                 uncultured_bacterium\nASV_68                 uncultured_bacterium\nASV_1042                               &lt;NA&gt;\nASV_1246                               &lt;NA&gt;\nASV_3880                     Leptothrix_sp.\nASV_2297                               &lt;NA&gt;\nASV_511                                &lt;NA&gt;\nASV_1356                               &lt;NA&gt;\nASV_4894                Ralstonia_insidiosa\nASV_743                                &lt;NA&gt;\nASV_1573               uncultured_bacterium\nASV_746                                &lt;NA&gt;\nASV_1089                               &lt;NA&gt;\nASV_1116                               &lt;NA&gt;\nASV_118                uncultured_bacterium\nASV_58                                 &lt;NA&gt;\nASV_62                                 &lt;NA&gt;\nASV_204                                &lt;NA&gt;\nASV_3227                               &lt;NA&gt;\nASV_3698        Methylobacterium_isbiliense\nASV_2303                               &lt;NA&gt;\nASV_1041                               &lt;NA&gt;\nASV_2235                               &lt;NA&gt;\nASV_2317                               &lt;NA&gt;\nASV_3225             Sphingobium_yanoikuyae\nASV_130                                &lt;NA&gt;\nASV_300                                &lt;NA&gt;\nASV_692                                &lt;NA&gt;\nASV_552                                &lt;NA&gt;\nASV_7             uncultured_Spirochaetales\nASV_250           uncultured_Spirochaetales\nASV_103                                &lt;NA&gt;\nASV_114                                &lt;NA&gt;\nASV_197                                &lt;NA&gt;\nASV_36                     uncultured_delta\nASV_109                    uncultured_delta\nASV_79                                 &lt;NA&gt;\nASV_61                                 &lt;NA&gt;\nASV_256                    uncultured_delta\nASV_196                    uncultured_delta\nASV_321                    uncultured_delta\nASV_123                                &lt;NA&gt;\nASV_105                                &lt;NA&gt;\nASV_162                                &lt;NA&gt;\nASV_166                                &lt;NA&gt;\nASV_395                    uncultured_delta\nASV_3212                               &lt;NA&gt;\nASV_246                    uncultured_delta\nASV_8                          unidentified\nASV_15                         unidentified\nASV_12                         unidentified\nASV_11                         unidentified\nASV_71                         unidentified\nASV_568                        unidentified\nASV_487                                &lt;NA&gt;\nASV_689                                &lt;NA&gt;\nASV_892                                &lt;NA&gt;\nASV_584     Dysgonomonas_capnocytophagoides\nASV_362                                &lt;NA&gt;\nASV_1595                               &lt;NA&gt;\nASV_1786                               &lt;NA&gt;\nASV_329                                &lt;NA&gt;\nASV_2126                               &lt;NA&gt;\nASV_3984               uncultured_bacterium\nASV_643                uncultured_bacterium\nASV_557                                &lt;NA&gt;\nASV_781                 uncultured_Chlorobi\nASV_1254           Arcobacter_cryaerophilus\nASV_1032               uncultured_bacterium\nASV_23               uncultured_Nitrospirae\nASV_93               uncultured_Nitrospirae\nASV_86                uncultured_prokaryote\nASV_147               uncultured_prokaryote\nASV_1080                               &lt;NA&gt;\nASV_297                uncultured_bacterium\nASV_331                uncultured_bacterium\nASV_4                                  &lt;NA&gt;\nASV_230                                &lt;NA&gt;\nASV_653            Bifidobacterium_animalis\nASV_396                                &lt;NA&gt;\nASV_21                                 &lt;NA&gt;\nASV_2616                               &lt;NA&gt;\nASV_3087                               &lt;NA&gt;\nASV_450                                &lt;NA&gt;\nASV_3338                               &lt;NA&gt;\nASV_516                                &lt;NA&gt;\nASV_1911                               &lt;NA&gt;\nASV_2747                               &lt;NA&gt;\nASV_141                                &lt;NA&gt;\nASV_784  Corynebacterium_tuberculostearicum\nASV_771                                &lt;NA&gt;\nASV_2787    Corynebacterium_lipophiloflavum\nASV_1075     Rhodococcus_corynebacterioides\nASV_2600                               &lt;NA&gt;\nASV_2301                               &lt;NA&gt;\nASV_345                                &lt;NA&gt;\nASV_942                       Olsenella_sp.\nASV_558                                &lt;NA&gt;\nASV_92                 uncultured_bacterium\nASV_283                uncultured_bacterium\nASV_289                                &lt;NA&gt;\nASV_221                uncultured_bacterium\nASV_434                uncultured_bacterium\nASV_239              uncultured_Chloroflexi\nASV_341                uncultured_bacterium\nASV_148                uncultured_bacterium\nASV_116          uncultured_Anaerolineaceae\nASV_747              uncultured_Chloroflexi\nASV_127                 uncultured_Chlorobi\nASV_4434               uncultured_bacterium\nASV_3540                  uncultured_forest\nASV_1256               uncultured_bacterium\nASV_1264                               &lt;NA&gt;\nASV_1124                               &lt;NA&gt;\nASV_2786                               &lt;NA&gt;\nASV_3411                               &lt;NA&gt;\nASV_29                 uncultured_bacterium\nASV_59           Pectinatus_cerevisiiphilus\nASV_60           Pectinatus_cerevisiiphilus\nASV_505          Pectinatus_cerevisiiphilus\nASV_163          Pectinatus_cerevisiiphilus\nASV_2082         Pectinatus_cerevisiiphilus\nASV_1751         Pectinatus_cerevisiiphilus\nASV_3218         Pectinatus_cerevisiiphilus\nASV_317                uncultured_bacterium\nASV_1487               uncultured_bacterium\nASV_1552               uncultured_bacterium\nASV_935                uncultured_bacterium\nASV_1370               uncultured_bacterium\nASV_1408               uncultured_bacterium\nASV_280                uncultured_bacterium\nASV_473                uncultured_bacterium\nASV_40                 uncultured_bacterium\nASV_399                                &lt;NA&gt;\nASV_110                Firmicutes_bacterium\nASV_201               Entomoplasma_somnilux\nASV_383                uncultured_bacterium\nASV_1646                               &lt;NA&gt;\nASV_227         Staphylococcaceae_bacterium\nASV_278                                &lt;NA&gt;\nASV_668                                &lt;NA&gt;\nASV_1208                    Bacillus_kochii\nASV_921               Compostibacillus_humi\nASV_1020                               &lt;NA&gt;\nASV_14                                 &lt;NA&gt;\nASV_249                                &lt;NA&gt;\nASV_453                                &lt;NA&gt;\nASV_4485                               &lt;NA&gt;\nASV_22              Lactobacillus_ghanensis\nASV_622             Lactobacillus_ghanensis\nASV_65              Lactobacillus_kimchicus\nASV_2949            Lactobacillus_hilgardii\nASV_3929            Lactobacillus_kimchicus\nASV_275             Lactobacillus_kimchicus\nASV_451             Lactobacillus_kimchicus\nASV_155       Lactobacillus_paracollinoides\nASV_548                                &lt;NA&gt;\nASV_3387                               &lt;NA&gt;\nASV_3539                               &lt;NA&gt;\nASV_1062       Lactobacillus_vaccinostercus\nASV_2653           Pediococcus_argentinicus\nASV_774                                &lt;NA&gt;\nASV_1081            Lactobacillus_camelliae\nASV_1727            Lactobacillus_camelliae\nASV_2603                               &lt;NA&gt;\nASV_3016            Lactobacillus_pantheris\nASV_222                                &lt;NA&gt;\nASV_2448          Lactobacillus_delbrueckii\nASV_243     Lactobacillus_ginsenosidimutans\nASV_470         Weissella_paramesenteroides\nASV_1839                               &lt;NA&gt;\nASV_215                                &lt;NA&gt;\nASV_226                                &lt;NA&gt;\nASV_944                                &lt;NA&gt;\nASV_286                Lactococcus_garvieae\nASV_442                  Lactococcus_lactis\nASV_4817                               &lt;NA&gt;\nASV_1163                               &lt;NA&gt;\nASV_493                                &lt;NA&gt;\nASV_150                                &lt;NA&gt;\nASV_2                                  &lt;NA&gt;\nASV_412                                &lt;NA&gt;\nASV_475                                &lt;NA&gt;\nASV_157                                &lt;NA&gt;\nASV_415                                &lt;NA&gt;\nASV_776                                &lt;NA&gt;\nASV_494                                &lt;NA&gt;\nASV_125                                &lt;NA&gt;\nASV_13                                 &lt;NA&gt;\nASV_1                  Enterococcus_mundtii\n\n\n\nshared_family &lt;- unique(shared_taxonomy$Family[!is.na(shared_taxonomy$Family)])\nprint(shared_family)\n\n [1] \"Bathyarchaeia\"                \"Isosphaeraceae\"              \n [3] \"Sumerlaeaceae\"                \"Pedosphaeraceae\"             \n [5] \"Deinococcaceae\"               \"Saccharimonadaceae\"          \n [7] \"Saccharimonadales\"            \"Parcubacteria\"               \n [9] \"Candidatus_Kaiserbacteria\"    \"Candidatus_Magasanikbacteria\"\n[11] \"Aminicenantales\"              \"Enterobacteriaceae\"          \n[13] \"Morganellaceae\"               \"Yersiniaceae\"                \n[15] \"Aeromonadaceae\"               \"Moraxellaceae\"               \n[17] \"Pseudomonadaceae\"             \"KF-JG30-C25\"                 \n[19] \"Xanthomonadaceae\"             \"Acidiferrobacteraceae\"       \n[21] \"B1-7BS\"                       \"Comamonadaceae\"              \n[23] \"Burkholderiaceae\"             \"Alcaligenaceae\"              \n[25] \"Neisseriaceae\"                \"Oxalobacteraceae\"            \n[27] \"Nitrosomonadaceae\"            \"Xanthobacteraceae\"           \n[29] \"Beijerinckiaceae\"             \"Rhizobiaceae\"                \n[31] \"Sphingomonadaceae\"            \"Acetobacteraceae\"            \n[33] \"Sva0485\"                      \"Desulfatiglandaceae\"         \n[35] \"Desulfosarcinaceae\"           \"uncultured\"                  \n[37] \"BIrii41\"                      \"MBNT15\"                      \n[39] \"Prevotellaceae\"               \"Dysgonomonadaceae\"           \n[41] \"Paludibacteraceae\"            \"Weeksellaceae\"               \n[43] \"Ignavibacteriaceae\"           \"BSV26\"                       \n[45] \"Arcobacteraceae\"              \"Spirochaetaceae\"             \n[47] \"Subgroup_18\"                  \"Calditrichaceae\"             \n[49] \"Zixibacteria\"                 \"Bifidobacteriaceae\"          \n[51] \"Micrococcaceae\"               \"Dermacoccaceae\"              \n[53] \"Intrasporangiaceae\"           \"Dermabacteraceae\"            \n[55] \"Nocardiopsaceae\"              \"Propionibacteriaceae\"        \n[57] \"Corynebacteriaceae\"           \"Nocardiaceae\"                \n[59] \"Streptomycetaceae\"            \"Eggerthellaceae\"             \n[61] \"Atopobiaceae\"                 \"GIF3\"                        \n[63] \"vadinBA26\"                    \"GIF9\"                        \n[65] \"S085\"                         \"Anaerolineaceae\"             \n[67] \"Thermomicrobiaceae\"           \"Solibacteraceae\"             \n[69] \"Sericytochromatia\"            \"Leptotrichiaceae\"            \n[71] \"Ruminococcaceae\"              \"Veillonellaceae\"             \n[73] \"Selenomonadaceae\"             \"Erysipelotrichaceae\"         \n[75] \"Entomoplasmataceae\"           \"Erysipelatoclostridiaceae\"   \n[77] \"Staphylococcaceae\"            \"Bacillaceae\"                 \n[79] \"Enterococcaceae\"              \"Vagococcaceae\"               \n[81] \"Lactobacillaceae\"             \"Leuconostocaceae\"            \n[83] \"Streptococcaceae\"            \n\n\n\nshared_phyla &lt;- unique(shared_taxonomy$Phylum[!is.na(shared_taxonomy$Phylum)])\nprint(shared_phyla)\n\n [1] \"Crenarchaeota\"     \"Planctomycetota\"   \"Sumerlaeota\"      \n [4] \"Verrucomicrobiota\" \"Deinococcota\"      \"Patescibacteria\"  \n [7] \"Acidobacteriota\"   \"Proteobacteria\"    \"Sva0485\"          \n[10] \"Desulfobacterota\"  \"Myxococcota\"       \"MBNT15\"           \n[13] \"Bacteroidota\"      \"Campilobacterota\"  \"Spirochaetota\"    \n[16] \"Nitrospirota\"      \"Calditrichota\"     \"Zixibacteria\"     \n[19] \"Actinobacteriota\"  \"Chloroflexi\"       \"Cyanobacteria\"    \n[22] \"Fusobacteriota\"    \"Firmicutes\"",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#relative-abundance-of-core-asv",
    "href": "03.4.Coremicrobiome.html#relative-abundance-of-core-asv",
    "title": "Core Microbiome",
    "section": "07. Relative abundance of core asv",
    "text": "07. Relative abundance of core asv\n\n# Filter\nphyseq_shared &lt;- prune_taxa(shared_asvs, physeq)\nhead(otu_table(physeq_shared))\n\nOTU Table:          [6 taxa and 50 samples]\n                     taxa are rows\n         S1A015 S1A1530 S1A3050 S1A5075 S1B07 S1B2230 S1B3040 S1B6575 S2A1727\nASV_120      11     286     140     200    55     242     111     119     383\nASV_1769     14       0       0      15    29      31      20       5      22\nASV_513      37     115      81     105    32      13       2       8      41\nASV_537      78      52      17       7   155      20       0       2      21\nASV_2449      9       3       4      18    20      15      10      11      10\nASV_167     106     107      55      66   262     115     151      68      65\n         S2A3545 S2A5060 S2A515 S2B07 S2B1522 S2B3040 S2B5565 S3A07 S3A1522\nASV_120       67     126    154    91     521     104      78   133      35\nASV_1769       8      15      6    16       0      23      10    29       8\nASV_513      106      48     32    90      34      21      19    31       2\nASV_537       67      38     22   123      20      39      10    69       0\nASV_2449      11      22     12     9      13       6       8     9      13\nASV_167      128     164     65    91      72     133      89   113     122\n         S3A3040 S3A6070 S3B2030 S3B3545 S3B515 S3B6070 S4B07 S4B1522 S4B3040\nASV_120       96      57     179     143    105     311    35     212     292\nASV_1769      21       7      16      15     15      59    18       3      17\nASV_513       19       0      14      46      9      18   138      67      75\nASV_537       39       0       0       4     18      21    95      13       8\nASV_2449      15       6      27      17     12      40    14       0      12\nASV_167       59     120     183      98     80     346   141      83     125\n         S4B5565 S5A07 S5A1522 S5A3040 S5A5565 S5B07 S5B1522 S5B3040 S5B5060\nASV_120      324     0       0     166     203     4     139     760     525\nASV_1769      14    33      33      29      10    20      15      27      13\nASV_513       64     5      50      98       8    64      11      73       8\nASV_537       21    38      15      26       0    66      40      79      10\nASV_2449       2    42       7      11       0    10      10      17      15\nASV_167       90   262     165     222      68   189     112     137      96\n         S6A07 S6A1522 S6A3040 S6B07 S6B1522 S6B3040 S7A07 S7A1522 S7A3040\nASV_120      9     205     129     0      69     242     6     208     243\nASV_1769    18       0      29    75      34      19    24       9      16\nASV_513     21     122     109     0       0      35    25      85     142\nASV_537    173      92       0   208      74      98   284      22      22\nASV_2449    11       6      21    24      14      19    11       3      25\nASV_167     72      88     138   201     167     116   136      71     115\n         S7A5060 S7B07 S7B1522 S7B3040 S7B5060\nASV_120      121     3      82      50      99\nASV_1769       0     9      30      17      15\nASV_513       12    53     130     161      70\nASV_537        6    95      77      28      20\nASV_2449       5    18      10      16      24\nASV_167       28   110     107     151     151\n\n# rel abundance\nphyseq_rel &lt;- transform_sample_counts(physeq_shared, function(x){x / sum(x)})\nhead(otu_table(physeq_shared))\n\nOTU Table:          [6 taxa and 50 samples]\n                     taxa are rows\n         S1A015 S1A1530 S1A3050 S1A5075 S1B07 S1B2230 S1B3040 S1B6575 S2A1727\nASV_120      11     286     140     200    55     242     111     119     383\nASV_1769     14       0       0      15    29      31      20       5      22\nASV_513      37     115      81     105    32      13       2       8      41\nASV_537      78      52      17       7   155      20       0       2      21\nASV_2449      9       3       4      18    20      15      10      11      10\nASV_167     106     107      55      66   262     115     151      68      65\n         S2A3545 S2A5060 S2A515 S2B07 S2B1522 S2B3040 S2B5565 S3A07 S3A1522\nASV_120       67     126    154    91     521     104      78   133      35\nASV_1769       8      15      6    16       0      23      10    29       8\nASV_513      106      48     32    90      34      21      19    31       2\nASV_537       67      38     22   123      20      39      10    69       0\nASV_2449      11      22     12     9      13       6       8     9      13\nASV_167      128     164     65    91      72     133      89   113     122\n         S3A3040 S3A6070 S3B2030 S3B3545 S3B515 S3B6070 S4B07 S4B1522 S4B3040\nASV_120       96      57     179     143    105     311    35     212     292\nASV_1769      21       7      16      15     15      59    18       3      17\nASV_513       19       0      14      46      9      18   138      67      75\nASV_537       39       0       0       4     18      21    95      13       8\nASV_2449      15       6      27      17     12      40    14       0      12\nASV_167       59     120     183      98     80     346   141      83     125\n         S4B5565 S5A07 S5A1522 S5A3040 S5A5565 S5B07 S5B1522 S5B3040 S5B5060\nASV_120      324     0       0     166     203     4     139     760     525\nASV_1769      14    33      33      29      10    20      15      27      13\nASV_513       64     5      50      98       8    64      11      73       8\nASV_537       21    38      15      26       0    66      40      79      10\nASV_2449       2    42       7      11       0    10      10      17      15\nASV_167       90   262     165     222      68   189     112     137      96\n         S6A07 S6A1522 S6A3040 S6B07 S6B1522 S6B3040 S7A07 S7A1522 S7A3040\nASV_120      9     205     129     0      69     242     6     208     243\nASV_1769    18       0      29    75      34      19    24       9      16\nASV_513     21     122     109     0       0      35    25      85     142\nASV_537    173      92       0   208      74      98   284      22      22\nASV_2449    11       6      21    24      14      19    11       3      25\nASV_167     72      88     138   201     167     116   136      71     115\n         S7A5060 S7B07 S7B1522 S7B3040 S7B5060\nASV_120      121     3      82      50      99\nASV_1769       0     9      30      17      15\nASV_513       12    53     130     161      70\nASV_537        6    95      77      28      20\nASV_2449       5    18      10      16      24\nASV_167       28   110     107     151     151\n\n\n\n# Aggregate data by Location\nphyseq_agg &lt;- merge_samples(physeq_rel, \"Location\")\n\n# Convert to relative abundance\nphyseq_agg_rel &lt;- transform_sample_counts(physeq_agg, function(x) x / sum(x))\n\n# Location names\nlocations &lt;- unique(sample_data(physeq_rel)$Location)\nsample_names(physeq_agg_rel) &lt;- locations\nsample_data(physeq_agg_rel)$Location &lt;- factor(locations, levels = locations)\n\nBarplot of core by Phylum level\n\n# Numbers of ASV\nn_asvs &lt;- length(unique(tax_table(physeq_agg_rel)[, \"Phylum\"]))\n\n# color palette\nbase_colors &lt;- c(\n  \"#4B0082\",\n  \"cyan4\",\n  \"#FF1493\",  \n  \"#FFD700\",  \n  \"#8A2BE6\",  \n  \"#74F3D3FF\",\n  \"#F3E33ABA\",\n  \"#AC9ECEFF\",\n  \"#6EC5ABFF\",\n  \"#8D3CA3\")\ncustom_palette &lt;- colorRampPalette(base_colors)(n_asvs)\n\n# Create the bar plot with facet by Mangrove_type\nbarplot_core &lt;- phyloseq::plot_bar(physeq_agg_rel, fill = \"Phylum\") +\n    geom_bar(aes(color = Phylum, fill = Phylum), \n               stat = \"identity\", position = \"stack\") +\n    labs(x = \"\", y = \"Relative Abundance\", element_text(size = 12)) +\n    facet_wrap(~ Location, scales = \"free_x\", nrow = 1) +\n    scale_fill_manual(values = custom_palette) +\n    scale_color_manual(values = custom_palette) +\n  theme_minimal() +\n  theme(axis.text = element_text(colour = \"black\", size = 10),\n        axis.title = element_text(colour = \"black\", size = 10),\n        legend.text = element_text(size = 10),\n        legend.title = element_text(size = 11),\n        legend.position = \"bottom\",\n        axis.text.x = element_text(size = 10, angle = 0, \n                        hjust = 0.5, color = \"black\"),\n      axis.text.y = element_text(size = 10, color = \"black\"),\n      strip.text = element_text(size = 12, \n                                color = \"black\"),\n      panel.background = element_blank())\n\nbarplot_core\n\n\n\n\n\n\n\n\npdf(\"Figures/interior_mangroves/rel_abun_core.pdf\")\nbarplot_core\ndev.off()\n\nquartz_off_screen \n                2 \n\n\n07.2 Ampvis heatmap\n\n# create and extract otu table\notu_table_ampvis &lt;- data.frame(OTU = rownames(phyloseq::otu_table(physeq_shared)@.Data),\n                                 phyloseq::otu_table(physeq_shared)@.Data,\n                                 phyloseq::tax_table(physeq_shared)@.Data,\n                                 check.names = FALSE)\n\n# Metadata\nmeta_data_ampvis &lt;- data.frame(phyloseq::sample_data(physeq_shared),\n                                 check.names = FALSE)\n\n# change index by SampleID\nmeta_data_ampvis &lt;- meta_data_ampvis %&gt;% rownames_to_column(var = \"SampleID\")\n\n# ampvis object\nav2 &lt;- amp_load(otu_table_ampvis, meta_data_ampvis)\n\n\nampv_heatmap_abundances_phylum_core &lt;- amp_heatmap(av2,\n            group_by = \"Location\",\n            #facet_by = \"Location\",\n            plot_values = TRUE,\n            tax_show = 23,\n            showRemainingTaxa = TRUE,\n            tax_aggregate = \"Phylum\",\n            plot_colorscale = \"log10\",\n            plot_values_size = 3,\n            min_abundance = 0.001,\n            round = 2,\n            color_vector = c(\"#703AF5\",\"#DADAEB\" ,\"#75157a\")) + #\"#DADAEB\"\n  theme(axis.text.x = element_text(angle = 0, size=11, \n                                   vjust = 1, hjust = 0.5),\n        axis.text.y = element_text(size=12),\n        legend.position=\"right\")\n\nampv_heatmap_abundances_phylum_core\n\n\n\n\n\n\n\n\n# save\nggsave(\"Figures/interior_mangroves/Core_RelativeAbundance_heatmap.pdf\",\n       ampv_heatmap_abundances_phylum_core, bg='transparent', \n       width = 4, height = 5.5)\n\n07.3 Extract relative abundance info\n\notu_rel_df &lt;- psmelt(physeq_agg_rel)\n\nWarning in psmelt(physeq_agg_rel): The sample variables: \nSample\n have been renamed to: \nsample_Sample\nto avoid conflicts with special phyloseq plot attribute names.\n\notu_rel_df_agg &lt;- aggregate(Abundance ~ Sample + Phylum, data = otu_rel_df, sum)\nprint(otu_rel_df_agg)\n\n               Sample            Phylum Abundance\n1       Fossil Lagoon   Acidobacteriota  0.003576\n2      Miguelito Dike   Acidobacteriota  0.002371\n3  Reforma Waterfalls   Acidobacteriota  0.002469\n4       Fossil Lagoon  Actinobacteriota  0.079636\n5      Miguelito Dike  Actinobacteriota  0.075970\n6  Reforma Waterfalls  Actinobacteriota  0.084031\n7       Fossil Lagoon      Bacteroidota  0.102028\n8      Miguelito Dike      Bacteroidota  0.097611\n9  Reforma Waterfalls      Bacteroidota  0.106167\n10      Fossil Lagoon     Calditrichota  0.001953\n11     Miguelito Dike     Calditrichota  0.002084\n12 Reforma Waterfalls     Calditrichota  0.001117\n13      Fossil Lagoon  Campilobacterota  0.000440\n14     Miguelito Dike  Campilobacterota  0.000389\n15 Reforma Waterfalls  Campilobacterota  0.000410\n16      Fossil Lagoon       Chloroflexi  0.024488\n17     Miguelito Dike       Chloroflexi  0.029684\n18 Reforma Waterfalls       Chloroflexi  0.021331\n19      Fossil Lagoon     Crenarchaeota  0.004505\n20     Miguelito Dike     Crenarchaeota  0.002274\n21 Reforma Waterfalls     Crenarchaeota  0.003313\n22      Fossil Lagoon     Cyanobacteria  0.000372\n23     Miguelito Dike     Cyanobacteria  0.000457\n24 Reforma Waterfalls     Cyanobacteria  0.000450\n25      Fossil Lagoon      Deinococcota  0.002327\n26     Miguelito Dike      Deinococcota  0.002014\n27 Reforma Waterfalls      Deinococcota  0.002149\n28      Fossil Lagoon  Desulfobacterota  0.014731\n29     Miguelito Dike  Desulfobacterota  0.017633\n30 Reforma Waterfalls  Desulfobacterota  0.007691\n31      Fossil Lagoon        Firmicutes  0.332269\n32     Miguelito Dike        Firmicutes  0.331807\n33 Reforma Waterfalls        Firmicutes  0.338907\n34      Fossil Lagoon    Fusobacteriota  0.000395\n35     Miguelito Dike    Fusobacteriota  0.000377\n36 Reforma Waterfalls    Fusobacteriota  0.000478\n37      Fossil Lagoon            MBNT15  0.002557\n38     Miguelito Dike            MBNT15  0.001361\n39 Reforma Waterfalls            MBNT15  0.001685\n40      Fossil Lagoon       Myxococcota  0.000173\n41     Miguelito Dike       Myxococcota  0.000161\n42 Reforma Waterfalls       Myxococcota  0.000192\n43      Fossil Lagoon      Nitrospirota  0.023630\n44     Miguelito Dike      Nitrospirota  0.040794\n45 Reforma Waterfalls      Nitrospirota  0.012895\n46      Fossil Lagoon   Patescibacteria  0.002097\n47     Miguelito Dike   Patescibacteria  0.002273\n48 Reforma Waterfalls   Patescibacteria  0.002529\n49      Fossil Lagoon   Planctomycetota  0.000314\n50     Miguelito Dike   Planctomycetota  0.000321\n51 Reforma Waterfalls   Planctomycetota  0.000288\n52      Fossil Lagoon    Proteobacteria  0.321910\n53     Miguelito Dike    Proteobacteria  0.314589\n54 Reforma Waterfalls    Proteobacteria  0.337182\n55      Fossil Lagoon     Spirochaetota  0.000696\n56     Miguelito Dike     Spirochaetota  0.000646\n57 Reforma Waterfalls     Spirochaetota  0.000490\n58      Fossil Lagoon       Sumerlaeota  0.000977\n59     Miguelito Dike       Sumerlaeota  0.001240\n60 Reforma Waterfalls       Sumerlaeota  0.000796\n61      Fossil Lagoon           Sva0485  0.079575\n62     Miguelito Dike           Sva0485  0.071257\n63 Reforma Waterfalls           Sva0485  0.073804\n64      Fossil Lagoon Verrucomicrobiota  0.000753\n65     Miguelito Dike Verrucomicrobiota  0.001750\n66 Reforma Waterfalls Verrucomicrobiota  0.000884\n67      Fossil Lagoon      Zixibacteria  0.000599\n68     Miguelito Dike      Zixibacteria  0.002938\n69 Reforma Waterfalls      Zixibacteria  0.000743",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.4.Coremicrobiome.html#save-rds-core-plot",
    "href": "03.4.Coremicrobiome.html#save-rds-core-plot",
    "title": "Core Microbiome",
    "section": "Save rds core plot",
    "text": "Save rds core plot\n\nsaveRDS(upset_plot, \"rds/interior_mangroves/upset_plot.rds\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Core Microbiome"
    ]
  },
  {
    "objectID": "03.5.DifferentialAbundance.html",
    "href": "03.5.DifferentialAbundance.html",
    "title": "Differential Abundance",
    "section": "",
    "text": "# load libraries\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ANCOMBC)\nlibrary(tidyverse)\nlibrary(cowplot)\nlibrary(DT)\noptions(DT.options = list(\n  initComplete = JS(\"function(settings, json) {\",\n                    \"$(this.api().table().header()).css({'background-color':\n  '#000', 'color': '#fff'});\",\"}\")))\n\n\n#load data\nps &lt;- readRDS(\"rds/interior_mangroves/phyloseq.rds\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "03.5.DifferentialAbundance.html#by-depth",
    "href": "03.5.DifferentialAbundance.html#by-depth",
    "title": "Differential Abundance",
    "section": "01. By Depth",
    "text": "01. By Depth\n01.1 Prepare data\n\n# phyloseq to TreeSummarizedExperiment\ntse &lt;- mia::convertFromPhyloseq(ps)\n\n# contrast matrix\ncontrast_matrices &lt;- list(\n  matrix(c(1, -1, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, -1,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, -1, 0,\n           0, 1, 0,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE))\n\n# nodes\nnodes &lt;- list(1, 1, 1, 1)\n\n01.2 Run ANCOM-BC2\n# ANCOMBC2\noutput &lt;- ancombc2(\n  data = tse,\n  assay_name = \"counts\",\n  tax_level = \"Phylum\",\n  fix_formula = \"Location + Depth_cm\",\n  rand_formula = \"(1 | ID)\",\n  p_adj_method = \"holm\",\n  pseudo_sens = TRUE,\n  prv_cut = 0.10,\n  lib_cut = 1000,\n  s0_perc = 0.05,\n  group = \"Depth_cm\",\n  struc_zero = TRUE,\n  neg_lb = TRUE,\n  alpha = 0.05,\n  n_cl = 2,\n  verbose = TRUE,\n  global = TRUE,\n  pairwise = TRUE,\n  dunnet = TRUE,\n  trend = TRUE,\n  iter_control = list(tol = 1e-2, max_iter = 20, verbose = TRUE),\n  em_control = list(tol = 1e-5, max_iter = 100),\n  lme_control = lme4::lmerControl(),\n  mdfdr_control = list(fwer_ctrl_method = \"holm\", B = 100),\n  trend_control = list(\n    contrast = contrast_matrices,\n    node = nodes,\n    solver = \"ECOS\",\n    B = 100))\n\n#See results\nres_pair &lt;- output$res_pair\n\nhead(res_pair)\n\n              taxon lfc_Depth_cm16-30 lfc_Depth_cm31-45 lfc_Depth_cm50-75\n1    Proteobacteria           -0.2127            -0.196            -0.337\n2       Chloroflexi            1.0161             1.094             1.482\n3  Latescibacterota           -0.0353            -0.348            -0.782\n4       Myxococcota           -0.0741            -0.477            -0.737\n5      Zixibacteria            0.6524             0.567             0.886\n6 Methylomirabilota           -0.2690            -0.977            -1.240\n  lfc_Depth_cm31-45_Depth_cm16-30 lfc_Depth_cm50-75_Depth_cm16-30\n1                          0.0164                          -0.124\n2                          0.0774                           0.465\n3                         -0.3130                          -0.747\n4                         -0.4030                          -0.663\n5                         -0.0857                           0.234\n6                         -0.7075                          -0.971\n  lfc_Depth_cm50-75_Depth_cm31-45 se_Depth_cm16-30 se_Depth_cm31-45\n1                          -0.140            0.246            0.245\n2                           0.388            0.186            0.184\n3                          -0.434            0.233            0.232\n4                          -0.260            0.232            0.231\n5                           0.320            0.214            0.212\n6                          -0.263            0.288            0.286\n  se_Depth_cm50-75 se_Depth_cm31-45_Depth_cm16-30\n1            0.256                          0.276\n2            0.194                          0.223\n3            0.244                          0.265\n4            0.243                          0.263\n5            0.223                          0.247\n6            0.310                          0.314\n  se_Depth_cm50-75_Depth_cm16-30 se_Depth_cm50-75_Depth_cm31-45 W_Depth_cm16-30\n1                          0.286                          0.285          -0.864\n2                          0.231                          0.230           5.474\n3                          0.275                          0.274          -0.151\n4                          0.274                          0.273          -0.319\n5                          0.256                          0.255           3.055\n6                          0.336                          0.335          -0.935\n  W_Depth_cm31-45 W_Depth_cm50-75 W_Depth_cm31-45_Depth_cm16-30\n1          -0.802           -1.31                        0.0594\n2           5.937            7.65                        0.3476\n3          -1.501           -3.20                       -1.1833\n4          -2.069           -3.04                       -1.5306\n5           2.671            3.98                       -0.3471\n6          -3.412           -4.00                       -2.2538\n  W_Depth_cm50-75_Depth_cm16-30 W_Depth_cm50-75_Depth_cm31-45 p_Depth_cm16-30\n1                        -0.433                        -0.492        1.00e+00\n2                         2.017                         1.690        4.13e-06\n3                        -2.714                        -1.583        8.81e-01\n4                        -2.422                        -0.955        7.51e-01\n5                         0.913                         1.253        4.35e-03\n6                        -2.891                        -0.787        3.56e-01\n  p_Depth_cm31-45 p_Depth_cm50-75 p_Depth_cm31-45_Depth_cm16-30\n1        1.00e+00        1.00e+00                         1.000\n2        1.03e-06        6.59e-09                         0.730\n3        1.42e-01        2.90e-03                         0.245\n4        4.62e-02        4.49e-03                         0.135\n5        1.15e-02        3.41e-04                         0.731\n6        1.73e-03        3.35e-04                         0.031\n  p_Depth_cm50-75_Depth_cm16-30 p_Depth_cm50-75_Depth_cm31-45 q_Depth_cm16-30\n1                       1.00000                         1.000        1.00e+00\n2                       0.05159                         0.100        3.63e-05\n3                       0.01033                         0.122        1.00e+00\n4                       0.02085                         0.346        1.00e+00\n5                       0.36788                         0.219        4.26e-02\n6                       0.00674                         0.437        1.00e+00\n  q_Depth_cm31-45 q_Depth_cm50-75 q_Depth_cm31-45_Depth_cm16-30\n1        1.00e+00        1.00e+00                         1.000\n2        1.01e-05        7.12e-08                         1.000\n3        1.00e+00        3.14e-02                         1.000\n4        4.06e-01        4.84e-02                         1.000\n5        1.01e-01        3.68e-03                         1.000\n6        1.69e-02        3.62e-03                         0.242\n  q_Depth_cm50-75_Depth_cm16-30 q_Depth_cm50-75_Depth_cm31-45\n1                        1.0000                         1.000\n2                        0.4024                         0.681\n3                        0.1012                         1.000\n4                        0.2043                         1.000\n5                        1.0000                         1.000\n6                        0.0594                         1.000\n  diff_Depth_cm16-30 diff_Depth_cm31-45 diff_Depth_cm50-75\n1              FALSE              FALSE              FALSE\n2               TRUE               TRUE               TRUE\n3              FALSE              FALSE               TRUE\n4              FALSE              FALSE               TRUE\n5               TRUE              FALSE               TRUE\n6              FALSE               TRUE               TRUE\n  diff_Depth_cm31-45_Depth_cm16-30 diff_Depth_cm50-75_Depth_cm16-30\n1                            FALSE                            FALSE\n2                            FALSE                            FALSE\n3                            FALSE                            FALSE\n4                            FALSE                            FALSE\n5                            FALSE                            FALSE\n6                            FALSE                            FALSE\n  diff_Depth_cm50-75_Depth_cm31-45 passed_ss_Depth_cm16-30\n1                            FALSE                    TRUE\n2                            FALSE                    TRUE\n3                            FALSE                    TRUE\n4                            FALSE                    TRUE\n5                            FALSE                    TRUE\n6                            FALSE                    TRUE\n  passed_ss_Depth_cm31-45 passed_ss_Depth_cm50-75\n1                    TRUE                    TRUE\n2                    TRUE                    TRUE\n3                    TRUE                    TRUE\n4                    TRUE                    TRUE\n5                   FALSE                    TRUE\n6                   FALSE                    TRUE\n  passed_ss_Depth_cm31-45_Depth_cm16-30 passed_ss_Depth_cm50-75_Depth_cm16-30\n1                                  TRUE                                  TRUE\n2                                  TRUE                                  TRUE\n3                                  TRUE                                 FALSE\n4                                  TRUE                                 FALSE\n5                                  TRUE                                  TRUE\n6                                  TRUE                                 FALSE\n  passed_ss_Depth_cm50-75_Depth_cm31-45\n1                                  TRUE\n2                                  TRUE\n3                                  TRUE\n4                                  TRUE\n5                                  TRUE\n6                                  TRUE\n\n\n01.3 Get differential data\n\n# Create dataframe df_fig_pair1 to log-fold change (LFC) values\ndf_fig_pair1 &lt;- res_pair %&gt;%\n  dplyr::filter(`diff_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm31-45` == 1 |\n                  `diff_Depth_cm50-75` == 1 |\n                  `diff_Depth_cm31-45_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm31-45` == 1) %&gt;%\n  dplyr::mutate(lfc1 = ifelse(`diff_Depth_cm16-30` == 1, round(`lfc_Depth_cm16-30`, 2), NA),\n                lfc2 = ifelse(`diff_Depth_cm31-45` == 1, round(`lfc_Depth_cm31-45`, 2), NA),\n                lfc3 = ifelse(`diff_Depth_cm50-75` == 1, round(`lfc_Depth_cm50-75`, 2), NA),\n                lfc4 = ifelse(`diff_Depth_cm31-45_Depth_cm16-30` == 1, \n                      round(`lfc_Depth_cm31-45_Depth_cm16-30`, 2), NA),\n                lfc5 = ifelse(`diff_Depth_cm50-75_Depth_cm16-30` == 1, \n                      round(`lfc_Depth_cm50-75_Depth_cm16-30`, 2), NA),\n                lfc6 = ifelse(`diff_Depth_cm50-75_Depth_cm31-45` == 1, \n                      round(`lfc_Depth_cm50-75_Depth_cm31-45`, 2), NA)) %&gt;%\n  tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", \n                      values_to = \"value\") %&gt;% dplyr::arrange(taxon)\n\n\n# Create dataframe df_fig_pair2 to significant values\n\ndf_fig_pair2 &lt;- res_pair %&gt;%\n  dplyr::filter(`diff_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm31-45` == 1 |\n                  `diff_Depth_cm50-75` == 1 |\n                  `diff_Depth_cm31-45_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm31-45` == 1) %&gt;%\n  dplyr::mutate(lfc1 = ifelse(`passed_ss_Depth_cm16-30` == 1 & `diff_Depth_cm16-30` == 1, \"darkblue\", \"black\"),\n                lfc2 = ifelse(`passed_ss_Depth_cm31-45` == 1 & `diff_Depth_cm31-45` == 1, \"darkblue\", \"black\"),\n                lfc3 = ifelse(`passed_ss_Depth_cm50-75` == 1 & `diff_Depth_cm50-75` == 1, \"darkblue\", \"black\"),\n                lfc4 = ifelse(`passed_ss_Depth_cm31-45_Depth_cm16-30` == 1 & `diff_Depth_cm31-45_Depth_cm16-30` == 1, \"darkblue\", \"black\"),\n                lfc5 = ifelse(`passed_ss_Depth_cm50-75_Depth_cm16-30` == 1 & `diff_Depth_cm50-75_Depth_cm16-30` == 1, \"darkblue\", \"black\"),\n                lfc6 = ifelse(`passed_ss_Depth_cm50-75_Depth_cm31-45` == 1 & `diff_Depth_cm50-75_Depth_cm31-45` == 1, \"darkblue\", \"black\")) %&gt;%\n  tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", values_to = \"color\") %&gt;%\n  dplyr::arrange(taxon)\n\n\n# Combine dataframes df_fig_pair1 and df_fig_pair2\ndf_fig_pair &lt;- df_fig_pair1 %&gt;%\n  dplyr::left_join(df_fig_pair2, by = c(\"taxon\", \"group\"))\n\n# Rename groups\ndf_fig_pair$group &lt;- recode(df_fig_pair$group,\n                            `lfc1` = \"16-30 vs 0-15\",\n                            `lfc2` = \"31-45 vs 0-15\",\n                            `lfc3` = \"50-75 vs 0-15\",\n                            `lfc4` = \"31-45 vs 16-30\",\n                            `lfc5` = \"50-75 vs 16-30\",\n                            `lfc6` = \"50-75 vs 31-45\")\n\ndf_fig_pair$group &lt;- factor(df_fig_pair$group,\n                            levels = c(\"16-30 vs 0-15\",\n                                       \"31-45 vs 0-15\",\n                                       \"50-75 vs 0-15\",\n                                       \"31-45 vs 16-30\",\n                                       \"50-75 vs 16-30\",\n                                       \"50-75 vs 31-45\"))\n\n# Filter comparisons with significant values\ndf_fig_pair &lt;- df_fig_pair %&gt;%\n  group_by(group) %&gt;%\n  filter(any(!is.na(value))) %&gt;%\n  ungroup()\n\n# Calculate limits\nlo &lt;- floor(min(df_fig_pair$value, na.rm = TRUE))\nup &lt;- ceiling(max(df_fig_pair$value, na.rm = TRUE))\nmid &lt;- (lo + up) / 2\n\n01.4 Heatmap Plot\n\nfig_pair &lt;- df_fig_pair %&gt;%\n  ggplot(aes(x = group, y = taxon, fill = value)) +\n  geom_tile(color = \"gray40\") +\n  scale_fill_gradient2(low = \"#c05098\", high = \"#3FB6AFFF\", mid = \"gray90\",\n                       na.value = \"white\", midpoint = mid, \n                       limit = c(lo, up),name = \"LFC\") +\n  geom_text(aes(label = round(value, 2), color = color), \n            size = 3.5, na.rm = TRUE) + \n  scale_color_identity(guide = FALSE) +\n  labs(x = NULL, y = NULL) + theme_classic() +\n  theme(plot.title = element_text(hjust = 0.5, size = 12),\n        axis.text.y = element_text(size = 12, color = \"black\"),\n        axis.text.x = element_text(size = 10, color = \"black\"))\n\nfig_pair\n\nWarning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in\nggplot2 3.3.4.\nℹ Please use \"none\" instead.\n\n\n\n\n\n\n\n\n01.5 Relative abundance of differential Phyla\n01.5.1 Filter and prepare data\n\n# Filter da phyla\ndifferential_phyla &lt;- c(\"Zixibacteria\", \"WS2\", \"uncultured\",\n                        \"Thermoplasmatota\", \"TA06\", \"Sva0485\",\n                        \"Spirochaetota\", \"RCP2-54\", \"Nitrospinota\", \n                        \"NB1-j\", \"Myxococcota\", \"Modulibacteria\", \n                        \"Methylomirabilota\", \"MBNT15\", \"LCP-89\",\n                        \"Latescibacterota\", \"Fibrobacterota\", \n                        \"Crenarchaeota\", \"Chloroflexi\", \n                        \"Calditrichota\", \"Armatimonadota\")\n\n# Filter in phyloseq\nps_da &lt;- subset_taxa(ps, Phylum %in% differential_phyla)\n\n# Depth aggregation\nps_da_agg &lt;- merge_samples(ps_da, \"Depths\")\n\n# relative abundance\nps_da_agg_rel &lt;- transform_sample_counts(ps_da_agg, function(x) x / sum(x))\n\n# check value and names Depths\ndepths &lt;- unique(sample_data(ps)$Depths)\nsample_names(ps_da_agg_rel) &lt;- depths\nsample_data(ps_da_agg_rel)$Depths &lt;- factor(depths, levels = depths)\n\n# Convert to data frame\ndf_abundance &lt;- psmelt(ps_da_agg_rel)\n\n# summary by depth and phylum\ndf_abundance_summary &lt;- df_abundance %&gt;%\n  group_by(Phylum, Depths) %&gt;%\n  summarise(Abundance = mean(Abundance, na.rm = TRUE)) %&gt;%\n  ungroup()\n\n# Replace NA with 0\ndf_abundance_summary$Abundance[is.na(df_abundance_summary$Abundance)] &lt;- 0\n\n01.5.2 Bubble plot\n\n# Define colors\ndepth_colors &lt;- c(\"0-15\" = \"#f5e5c4\",\n                  \"16-30\" = \"#baa179\",\n                  \"31-45\" = \"#a67451\",\n                  \"50-75\" = \"#80673b\")\n\n# bubble plot\nbubble_plot &lt;- ggplot(df_abundance_summary, \n                      aes(x = Depths, y = Phylum, size = Abundance,\n                          fill = Depths)) +\n  geom_point(shape = 21, color = \"gray40\") +\n  scale_size_continuous(range = c(1, 12), guide = \"none\") +\n  scale_fill_manual(values = depth_colors) +\n  labs(y = NULL, x=NULL , fill = NULL) +\n  theme_classic() +\n  theme(\n    axis.text.x = element_text(angle = 0, hjust = 0.5, \n                               size = 8.5, color = \"black\"),\n    axis.text.y = element_text(size = 12, color = \"black\"),\n    legend.position = \"none\")\n\n# show\nbubble_plot\n\n\n\n\n\n\n\n01.6 Join relative and differential abundance plots\n\nfig_pair &lt;- fig_pair +\n  theme(\n    axis.text.y = element_blank(),\n    axis.text.x = element_text(size = 8.5 , color = \"black\"),\n    axis.line.y = element_blank(),\n    axis.line.x = element_line(color = \"black\"))\n\n\ndepth_abundances &lt;- plot_grid(bubble_plot, fig_pair, ncol = 2, rel_widths = c(0.95, 1.1))\n\ndepth_abundances\n\n\n\n\n\n\n\n\n# save\nggsave(\"Figures/interior_mangroves/DA_and_RA_BubbleHeatmap_depth.pdf\",\n       depth_abundances, bg='transparent', \n       width = 6.7, height = 8)\n\n01.7 Save RDS plot\n\nsaveRDS(depth_abundances, \"rds/interior_mangroves/da_ra_depth_plot.rds\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Differential Abundance"
    ]
  },
  {
    "objectID": "03.6.MetabolicInference.html",
    "href": "03.6.MetabolicInference.html",
    "title": "Metabolic Inference",
    "section": "",
    "text": "01. Load libraries and prepare data\n\n# load libraries\nlibrary(tibble)\nlibrary(phyloseq)\nlibrary(dplyr)\nlibrary(ANCOMBC)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(DT)\noptions(DT.options = list(\n  initComplete = JS(\"function(settings, json) {\",\n                    \"$(this.api().table().header()).css({'background-color':\n  '#000', 'color': '#fff'});\",\"}\")))\n\n#read ko data\notu_table &lt;- read_delim(\"data/ko.txt\",\n                        delim = \"\\t\", escape_double = FALSE, trim_ws = TRUE,\n                        comment = \"#\", show_col_types = FALSE)\n\n# convert first column to row names\notu_table &lt;- otu_table %&gt;% column_to_rownames(\"FeatureID\")\n\n# convert otu_table to physeq\notu_table_phyloseq &lt;- otu_table(otu_table, taxa_are_rows = TRUE)\n\nmetadata &lt;- read_tsv(\"data/metadata.tsv\") %&gt;% column_to_rownames(\"SampleID\")\nsample_data_phyloseq &lt;- sample_data(metadata)\nps &lt;- phyloseq(otu_table_phyloseq, sample_data_phyloseq)\n\ntse &lt;- mia::convertFromPhyloseq(ps)\n\n#matrix\nassay(tse, \"counts\") &lt;- as.matrix(assay(tse, \"counts\")@.Data)\n\n#depth_cm to factor\nstr(colData(tse)$Depth_cm)\nlevels(colData(tse)$Depth_cm)\n# contrast matrix\ncontrast_matrices &lt;- list(\n  matrix(c(1, -1, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, -1,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, 0, 0,\n           0, 1, -1,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE),\n  matrix(c(1, -1, 0,\n           0, 1, 0,\n           0, 0, 1),\n         nrow = 3, byrow = TRUE))\n\n# nodes\nnodes &lt;- list(1, 1, 1, 1)\n02. Run ANCOM-BC2\noutput &lt;- ancombc2(\n  data = tse,\n  assay_name = \"counts\",\n  tax_lev = NULL,\n  fix_formula = \"Location + Depth_cm\",\n  rand_formula = \"(1 | ID)\",\n  p_adj_method = \"holm\",\n  pseudo_sens = TRUE,\n  prv_cut = 0.10,\n  lib_cut = 1000,\n  s0_perc = 0.05,\n  group = \"Depth_cm\",\n  struc_zero = TRUE,\n  neg_lb = TRUE,\n  alpha = 0.05,\n  n_cl = 2,\n  verbose = TRUE,\n  global = TRUE,\n  pairwise = TRUE,\n  dunnet = TRUE,\n  trend = TRUE,\n  iter_control = list(tol = 1e-2, max_iter = 20, verbose = TRUE),\n  em_control = list(tol = 1e-5, max_iter = 100),\n  lme_control = lme4::lmerControl(),\n  mdfdr_control = list(fwer_ctrl_method = \"holm\", B = 100),\n  trend_control = list(\n    contrast = contrast_matrices,\n    node = nodes,\n    solver = \"ECOS\",\n    B = 100\n  )\n)\n\n# save RDS\n03. Get differential data\n\n# Extract results\nres_pair &lt;- output$res_pair\n\n# Create dataframe df_fig_pair1\ndf_fig_pair1 &lt;- res_pair %&gt;%\n  dplyr::filter(`diff_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm31-45` == 1 |\n                  `diff_Depth_cm50-75` == 1 |\n                  `diff_Depth_cm31-45_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm31-45` == 1) %&gt;%\n  dplyr::mutate(lfc1 = ifelse(`diff_Depth_cm16-30` == 1, round(`lfc_Depth_cm16-30`, 2), NA),\n                lfc2 = ifelse(`diff_Depth_cm31-45` == 1, round(`lfc_Depth_cm31-45`, 2), NA),\n                lfc3 = ifelse(`diff_Depth_cm50-75` == 1, round(`lfc_Depth_cm50-75`, 2), NA),\n                lfc4 = ifelse(`diff_Depth_cm31-45_Depth_cm16-30` == 1, round(`lfc_Depth_cm31-45_Depth_cm16-30`, 2), NA),\n                lfc5 = ifelse(`diff_Depth_cm50-75_Depth_cm16-30` == 1, round(`lfc_Depth_cm50-75_Depth_cm16-30`, 2), NA),\n                lfc6 = ifelse(`diff_Depth_cm50-75_Depth_cm31-45` == 1, round(`lfc_Depth_cm50-75_Depth_cm31-45`, 2), NA)) %&gt;%\n  tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", values_to = \"value\") %&gt;%\n  dplyr::arrange(taxon)\n\n\n# Create dataframe fig_pair2\ndf_fig_pair2 &lt;- res_pair %&gt;%\n  dplyr::filter(`diff_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm31-45` == 1 |\n                  `diff_Depth_cm50-75` == 1 |\n                  `diff_Depth_cm31-45_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm16-30` == 1 |\n                  `diff_Depth_cm50-75_Depth_cm31-45` == 1) %&gt;%\n  dplyr::mutate(lfc1 = ifelse(`passed_ss_Depth_cm16-30` == 1 & `diff_Depth_cm16-30` == 1, \"blue3\", \"black\"),\n                lfc2 = ifelse(`passed_ss_Depth_cm31-45` == 1 & `diff_Depth_cm31-45` == 1, \"blue3\", \"black\"),\n                lfc3 = ifelse(`passed_ss_Depth_cm50-75` == 1 & `diff_Depth_cm50-75` == 1, \"blue3\", \"black\"),\n                lfc4 = ifelse(`passed_ss_Depth_cm31-45_Depth_cm16-30` == 1 & `diff_Depth_cm31-45_Depth_cm16-30` == 1, \"#00CCFF\", \"black\"),\n                lfc5 = ifelse(`passed_ss_Depth_cm50-75_Depth_cm16-30` == 1 & `diff_Depth_cm50-75_Depth_cm16-30` == 1, \"#00CCFF\", \"black\"),\n                lfc6 = ifelse(`passed_ss_Depth_cm50-75_Depth_cm31-45` == 1 & `diff_Depth_cm50-75_Depth_cm31-45` == 1, \"#00CCFF\", \"black\")) %&gt;%\n  tidyr::pivot_longer(cols = lfc1:lfc6, names_to = \"group\", values_to = \"color\") %&gt;%\n  dplyr::arrange(taxon)\n\n\n# Combine dataframes df_fig_pair1 and df_fig_pair2\ndf_fig_pair &lt;- df_fig_pair1 %&gt;%\n  dplyr::left_join(df_fig_pair2, by = c(\"taxon\", \"group\"))\n\n# Rename groups\ndf_fig_pair$group &lt;- recode(df_fig_pair$group,\n                            `lfc1` = \"16-30 vs 0-15\",\n                            `lfc2` = \"31-45 vs 0-15\",\n                            `lfc3` = \"50-75 vs 0-15\",\n                            `lfc4` = \"31-45 vs 16-30\",\n                            `lfc5` = \"50-75 vs 16-30\",\n                            `lfc6` = \"50-75 vs 31-45\")\n\ndf_fig_pair$group &lt;- factor(df_fig_pair$group,\n                            levels = c(\"16-30 vs 0-15\",\n                                       \"31-45 vs 0-15\",\n                                       \"50-75 vs 0-15\",\n                                       \"31-45 vs 16-30\",\n                                       \"50-75 vs 16-30\",\n                                       \"50-75 vs 31-45\"))\n\n# Filter comparisons with significant values\ndf_fig_pair &lt;- df_fig_pair %&gt;%\n  group_by(group) %&gt;%\n  filter(any(!is.na(value))) %&gt;%\n  ungroup()\n\n04. Merge with KO DiTing cycles info\n\n# Read data \nDiTing_cycles&lt;-suppressMessages(read_delim(\n  \"https://raw.githubusercontent.com/xuechunxu/DiTing/master/table/KO_affilated_to_biogeochemical_cycle.tab\",\n  delim=\"\\t\") %&gt;%\n    fill(Cycle) %&gt;%\n     fill(Pathway) %&gt;%\n    rename_with(~ c(\"Cycle\", \"Pathway_cycle\", \"KO\", \"Detail_cycle\")))\n\n\n# Get KO description\nko_list &lt;- KEGGREST::keggList(\"ko\") %&gt;%\n  enframe() %&gt;%\n  rename_with(~ c(\"KO\", \"KO_description\")) %&gt;%\n  separate(KO_description, c(\"Genes\", \"Gene_description\"), sep=\"; \", extra=\"merge\") %&gt;%\n  mutate(KO = str_remove_all(KO, \"ko:\"))\n\n\n# convert to data.frame\ndf_fig_pair &lt;- as.data.frame(df_fig_pair)\nDiTing_cycles &lt;- as.data.frame(DiTing_cycles)\n\n\n# rename ko ids\ndf_fig_pair &lt;- df_fig_pair %&gt;%\n  rename_with(~ ifelse(. == \"taxon\", \"KO\", .)) %&gt;%\n  mutate(KO = str_remove_all(KO, \"ko:\"))\n\nDiTing_cycles &lt;- DiTing_cycles %&gt;%\n  mutate(KO = str_remove_all(KO, \"ko:\"))\n\n# force KO to character df\ndf_fig_pair$KO &lt;- as.character(df_fig_pair$KO)\nDiTing_cycles$KO &lt;- as.character(DiTing_cycles$KO)\n\n# Select cycles\nkegg_abundance_depth_DT &lt;- df_fig_pair %&gt;%\n  dplyr::left_join(DiTing_cycles, by = \"KO\",relationship = \"many-to-many\") %&gt;%\n  drop_na(Cycle) %&gt;%\n  filter(Cycle %in% c(\"Nitrogen metabolism\", \"Methane metabolism\", \n                      \"Sulfur metabolism\")) %&gt;% distinct() \n\n# join\nkegg_abundance_depth_DT &lt;- kegg_abundance_depth_DT %&gt;%\n  merge(ko_list, by = \"KO\")\n\n\n# filter informative comparisons\nkegg_abundance_depth_DT &lt;- kegg_abundance_depth_DT %&gt;%\n  filter(!group %in% c(\"31-45 vs 16-30\", \"50-75 vs 16-30\", \"50-75 vs 31-45\"))\n\n\n# limits\nlo &lt;- floor(min(df_fig_pair$value, na.rm = TRUE))\nup &lt;- ceiling(max(df_fig_pair$value, na.rm = TRUE))\nmid &lt;- (lo + up) / 2\n\n# # join gene names\nkegg_abundance_depth_DT &lt;- kegg_abundance_depth_DT %&gt;%\n  mutate(Gene_label = paste0(Genes, \" (\", Gene_description, \")\"))\n\n05. Heatmap\n\n# check heatmap_matrix format\nheatmap_matrix &lt;- kegg_abundance_depth_DT %&gt;%\n  select(group, value, Genes) %&gt;%\n  pivot_wider(names_from = group, values_from = value, values_fn = mean) %&gt;%\n  column_to_rownames(\"Genes\") %&gt;%\n  as.matrix()\n\n# Create row Cycle annotations\nannotation_row &lt;- kegg_abundance_depth_DT %&gt;%\n  select(Genes, Cycle) %&gt;%\n  distinct(Genes, Cycle, .keep_all = TRUE) %&gt;%\n  column_to_rownames(\"Genes\")\n\n# check that Cycle is sort factor\nannotation_row &lt;- annotation_row %&gt;%\n  arrange(Cycle)\n\n# Reorder heatmap_matrix same of annotation_row\nheatmap_matrix &lt;- heatmap_matrix[rownames(annotation_row), ]\n\n# Define colors to row annotation\ncycle_colors &lt;- setNames(\n  brewer.pal(length(unique(annotation_row$Cycle)), \"Blues\"),\n  unique(annotation_row$Cycle))\n\n# Create row annotation sorted\nha_row &lt;- rowAnnotation(\n  Cycle = annotation_row$Cycle,\n  col = list(Cycle = cycle_colors),\n  annotation_legend_param = list(title = \"Cycle\"))\n\n\n# heatmap\nht &lt;- Heatmap(\n  heatmap_matrix,\n  name = \"LFC\",\n  col = colorRamp2(c(-2,0,4), c(\"#D7bAfEfF\",\"white\",\"#011c50FF\")),\n  left_annotation = ha_row,\n  cluster_rows = FALSE,  \n  cluster_columns = FALSE,\n  row_names_gp = gpar(fontsize = 12),  \n  column_names_gp = gpar(fontsize = 12),\n  column_names_rot = 0,\n  column_title_gp = gpar(fontsize = 10),\n  rect_gp = gpar(col = \"white\", lwd = 0.5),\n  heatmap_legend_param = list(title = \"LFC\", direction = \"horizontal\"))\n\n# Draw with bottom legend\nht_bottom &lt;- draw(ht, heatmap_legend_side = \"bottom\", \n                  annotation_legend_side = \"bottom\")\n\n\n\n\n\n\n\n\n# save\npdf(\"Figures/interior_mangroves/DA_picrust_Heatmap_depth.pdf\",  width = 6, height = 8)\nht\ndev.off()\n\nquartz_off_screen \n                2 \n\n\n\nsaveRDS(ht, \"rds/interior_mangroves/DA_picrust.rds\")",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Metabolic Inference"
    ]
  },
  {
    "objectID": "03.7.Fig3.InteriorMangroves.html",
    "href": "03.7.Fig3.InteriorMangroves.html",
    "title": "Fig. 3 Interior Mangroves",
    "section": "",
    "text": "Load libraries\n\nlibrary(ggplot2)\nlibrary(cowplot)\n\nLoad figures\n\nalpha &lt;- readRDS(\"rds/interior_mangroves/alpha_diversity_interior_depth_plot.rds\")\n\nbeta_u &lt;- readRDS(\"rds/interior_mangroves/nmds_u.rds\")\nbeta_wu &lt;- readRDS(\"rds/interior_mangroves/nmds_wu.rds\")\ndbrda &lt;- readRDS(\"rds/interior_mangroves/dbRDA.rds\")\n\ncore &lt;- readRDS(\"rds/interior_mangroves/upset_plot.rds\")\n\nda_tax &lt;- readRDS(\"rds/interior_mangroves/da_ra_depth_plot.rds\")\n\nda_ko &lt;- readRDS(\"rds/interior_mangroves/DA_picrust.rds\")\n\nCombine plots\n\nbetas &lt;- plot_grid(beta_wu, beta_u, dbrda, labels = c(\"B\",\" \",\" \"),\n                        label_fontface = \"bold\",\n                        ncol = 3, rel_widths = c(1,1.2,1))\n\n\nalpha_betas &lt;- plot_grid(alpha, betas, ncol = 2, rel_widths = c(0.2,1))\n\n\ndataxcoreko &lt;- plot_grid(da_tax, core, da_ko, labels = c(\"C\",\"D\",\"E\"),\n                        label_fontface = \"bold\",\n                        ncol = 3, rel_widths = c(0.35,0.35,0.3))\n\n\nall &lt;- plot_grid(alpha_betas, dataxcoreko, ncol = 1, \n                 rel_heights = c(0.3,0.7))\n\n\nggsave(\"Figures/interior_mangroves/Fig3.InteriorMangroves.pdf\",\n       all, width = 19, height = 13)\n\n\nall\n\n\n\n\n\n\n\nCore and KO differential abundance are not shown because they are not a direct format of ggplot, so we will insert them in Inkscape\n\n\n\n\n\n\nEdit figure in Inkscape\n\n\n\nThe UpSet and ko abundance plots insertion and other details were done in Inkscape. The final figure is shown below:",
    "crumbs": [
      "Interior mangroves explore",
      "What makes inland mangroves different and unique?",
      "Fig. 3 Interior Mangroves"
    ]
  }
]